/**
 * heliosRX v0.2.1
 * (c) 2020 Thomas Weustenfeld
 * @license MIT
 */
import e from"vue";import t from"vuex";const r={database:{ServerValue:{TIMESTAMP:{".sv":"timestamp"}}},firestore:{FieldValue:{serverTimestamp(){throw new Error("Not Implemented")}}}},i=require("moment-timezone/builds/moment-timezone-with-data-2012-2022.min.js");var n;n=process.browser?window.localStorage:{getItem:()=>"Europe/Berlin",setItem(){}};const s=(e,t)=>{let r=e.clone().utc().format(),n=r.substring(0,r.length-1);return i.tz(n,t)};!function(){n.getItem("timezone"),n.getItem("timezone")||n.setItem("timezone",i.tz.guess());let e=n.getItem("timezone");i.tz.setDefault(e),i.user_timezone=e,function(e){e.isEnhanced=!0,e.prototype.isEnhanced=!0,e.fromFirestore=(t=>t&&"object"==typeof t&&"Timestamp"===t.constructor.name?e(t.toDate()):e(t)),e.fromRealtimeDB=(t=>e.unix(t)),e.fromRealtimeServerTime=(t=>e(t)),e.fromStore=(t=>e(t)),e.prototype.toFirestore=function(){return r.firestore.Timestamp.fromDate(this.toDate())},e.prototype.toRealtimeDB=function(){return this.unix()},e.prototype.toRealtimeServerTime=function(){return this.valueOf()},e.prototype.toBackend=function(e){return"REALTIMEDB"===e?this.toRealtimeDB():this.toFirestore()},e.prototype.toStore=function(){return this.format()},e.prototype.formatDateLong=function(){return this.format(this.user_dateformat)},e.prototype.isTimezoneNeutral=!1,e.fromDateAndTime=((t,r)=>{if(!r)throw new Error("Not implemented");let i=e.tz(t+"T"+r,e.user_timezone);return i.isTimezoneNeutral=!0,i}),e.fromTimezoneNeutral=(t=>{if(!e.isValidDate(t))return console.warn("[fromTimezoneNeutral] Invalid date",t),null;if(!t.isTimezoneNeutral)throw new Error("Input is not timezone neutral");return s(t,e.user_timezone)}),e.prototype.changeTimezoneButKeepTime=function(e){return s(this,e)},e.isValidDate=function(t){return t&&e.isMoment(t)&&!!t.isEnhanced&&t.isValid()},e.currentTime=(()=>{if(!e.user_timezone)throw new Error("User timezone is not set");return e().tz(e.user_timezone)}),e.currentTimeUTC=(()=>e().utc()),e.currentDate=(()=>e().tz(e.user_timezone).startOf("day")),e.currentDateISO=(()=>{e().tz(e.user_timezone).format("YYYY-MM-DD")}),e.currentDateSleepCorrected=(()=>e().tz(e.user_timezone).subtract(3,"hours").startOf("day")),e.currentCalendarweek=(()=>e().tz(e.user_timezone).format("W")),e.currentTimeServer=(e=>"REALTIMEDB"===e?r.database.ServerValue.TIMESTAMP:r.firestore.FieldValue.serverTimestamp()),e.convertHHmmToFractional=(t=>(e(t,"HH:mm")-e().startOf("day"))/3600/1e3),e.convertFractionalToHHmm=(t=>e.utc(3600*t*1e3).format("HH:mm")),e.parseTimeNatural=((t,r=null)=>{if(!(t=(t||"").trim()))return null;if("+"===t[0]||"-"===t[0]){let i="-"===t[0]?-1:1,n=t.slice(1);/[mhs]/i.test(n)||(n+="m");let s=null;if(!s.match)return null;let o=i*s.duration;return e(r,"HH:mm").add(o,"seconds")}return"now"===t?e():e(t,["HH:mm","HH:mm A","HH A","HH"])}),process.browser&&(window.moment=e)}(i)}();const o={CUSTOM:1,SLUGID:2,PUSHID:3,TIMESTAMP:4,LOCAL_TIMESTAMP:5,DATE:6,OTHER_USER_ID:7,MY_USER_ID:8,ARRAY:9,EMAIL:10},a={SOFT:0,HARD:1};function l(e,t,r){return e.replace(/\{.+?}/g,e=>{return function(e,t,r=`{${e}}`){return e.split(".").reduce((e,t)=>e[t]||r,t)}(e.substr(1,e.length-2).trim(),t,r)})}function c(e){return(e.match(/\{.+?}/g)||[]).map(e=>e.slice(1,-1))}let u,h,d=e,f=t,_={},m={};function p(e){e.Vue&&(d=e.Vue),e.Vuex&&(f=e.Vuex),e.Firebase&&(u=e.Firebase),e.registry&&(h=e.registry),e.models&&(_=e.models),e.db&&(m=e.db)}function y(){return h}var g={configure({GenericList:e,GenericModel:t}){this.GenericList=e,this.GenericModel=t},make_reactive_list(e,t,r,i=!1){let n=r.store.name,s=new this.GenericList(n);if(t){for(let i in t){let n=this.make_reactive_model(e,t[i],r);n.$id=i,n._update_data(t[i],e.schema.fields),s._add_child(i,n)}s.$readyAll=!0,s.$numReady=Object.keys(t).length}return e.listActions&&s.decorate_actions(e.listActions,r),!e.listGetters||i||e.no_reactive_getters||s.decorate_getters(e.listGetters,r.registry),d.observable(s),s},make_reactive_model(e,t,r,i=!1,n=!1){let s=r.store.name,o=new this.GenericModel(null,null,s);return o._set_generic_store(r.store),e.schema&&e.schema.fields?o.autogenerate_props(e.schema.fields,t,i):console.warn("Making a reactive model without schema. This means props are not autogenerated and only accessible through model.$state. Please provide a schema for "+s+"."),t&&(o._update_data(t,e.schema.fields),o.$ready=!0),e.modelActions&&o.decorate_actions(e.modelActions,r),!e.modelGetters||n||e.no_reactive_getters||o.decorate_getters(e.modelGetters,r.registry),d.observable(o),o}},v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(e,t){return e(t={exports:{}},t.exports),t.exports}var w=b(function(e,t){var r=200,i="__lodash_hash_undefined__",n=9007199254740991,s="[object Arguments]",o="[object Boolean]",a="[object Date]",l="[object Function]",c="[object GeneratorFunction]",u="[object Map]",h="[object Number]",d="[object Object]",f="[object RegExp]",_="[object Set]",m="[object String]",p="[object Symbol]",y="[object ArrayBuffer]",g="[object DataView]",b="[object Float32Array]",w="[object Float64Array]",E="[object Int8Array]",A="[object Int16Array]",j="[object Int32Array]",$="[object Uint8Array]",S="[object Uint8ClampedArray]",O="[object Uint16Array]",D="[object Uint32Array]",R=/\w*$/,x=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,I={};I[s]=I["[object Array]"]=I[y]=I[g]=I[o]=I[a]=I[b]=I[w]=I[E]=I[A]=I[j]=I[u]=I[h]=I[d]=I[f]=I[_]=I[m]=I[p]=I[$]=I[S]=I[O]=I[D]=!0,I["[object Error]"]=I[l]=I["[object WeakMap]"]=!1;var k="object"==typeof v&&v&&v.Object===Object&&v,M="object"==typeof self&&self&&self.Object===Object&&self,P=k||M||Function("return this")(),N=t&&!t.nodeType&&t,G=N&&e&&!e.nodeType&&e,U=G&&G.exports===N;function z(e,t){return e.set(t[0],t[1]),e}function L(e,t){return e.add(t),e}function V(e,t,r,i){var n=-1,s=e?e.length:0;for(i&&s&&(r=e[++n]);++n<s;)r=t(r,e[n],n,e);return r}function B(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function C(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function F(e,t){return function(r){return e(t(r))}}function Y(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var q,H=Array.prototype,W=Function.prototype,K=Object.prototype,X=P["__core-js_shared__"],Q=(q=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"",J=W.toString,Z=K.hasOwnProperty,ee=K.toString,te=RegExp("^"+J.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),re=U?P.Buffer:void 0,ie=P.Symbol,ne=P.Uint8Array,se=F(Object.getPrototypeOf,Object),oe=Object.create,ae=K.propertyIsEnumerable,le=H.splice,ce=Object.getOwnPropertySymbols,ue=re?re.isBuffer:void 0,he=F(Object.keys,Object),de=Ge(P,"DataView"),fe=Ge(P,"Map"),_e=Ge(P,"Promise"),me=Ge(P,"Set"),pe=Ge(P,"WeakMap"),ye=Ge(Object,"create"),ge=Be(de),ve=Be(fe),be=Be(_e),we=Be(me),Ee=Be(pe),Ae=ie?ie.prototype:void 0,je=Ae?Ae.valueOf:void 0;function $e(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function Se(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function Oe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function De(e){this.__data__=new Se(e)}function Re(e,t){var r=Fe(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ye(e)}(e)&&Z.call(e,"callee")&&(!ae.call(e,"callee")||ee.call(e)==s)}(e)?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],i=r.length,n=!!i;for(var o in e)!t&&!Z.call(e,o)||n&&("length"==o||Le(o,i))||r.push(o);return r}function xe(e,t,r){var i=e[t];Z.call(e,t)&&Ce(i,r)&&(void 0!==r||t in e)||(e[t]=r)}function Te(e,t){for(var r=e.length;r--;)if(Ce(e[r][0],t))return r;return-1}function Ie(e,t,r,i,n,v,x){var T;if(i&&(T=v?i(e,n,v,x):i(e)),void 0!==T)return T;if(!We(e))return e;var k=Fe(e);if(k){if(T=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&Z.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,i=e.length;t||(t=Array(i));for(;++r<i;)t[r]=e[r];return t}(e,T)}else{var M=ze(e),P=M==l||M==c;if(qe(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(M==d||M==s||P&&!v){if(B(e))return v?e:{};if(T=function(e){return"function"!=typeof e.constructor||Ve(e)?{}:(t=se(e),We(t)?oe(t):{});var t}(P?{}:e),!t)return function(e,t){return Pe(e,Ue(e),t)}(e,function(e,t){return e&&Pe(t,Ke(t),e)}(T,e))}else{if(!I[M])return v?e:{};T=function(e,t,r,i){var n=e.constructor;switch(t){case y:return Me(e);case o:case a:return new n(+e);case g:return function(e,t){var r=t?Me(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,i);case b:case w:case E:case A:case j:case $:case S:case O:case D:return function(e,t){var r=t?Me(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,i);case u:return function(e,t,r){return V(t?r(C(e),!0):C(e),z,new e.constructor)}(e,i,r);case h:case m:return new n(e);case f:return(c=new(l=e).constructor(l.source,R.exec(l))).lastIndex=l.lastIndex,c;case _:return function(e,t,r){return V(t?r(Y(e),!0):Y(e),L,new e.constructor)}(e,i,r);case p:return s=e,je?Object(je.call(s)):{}}var s;var l,c}(e,M,Ie,t)}}x||(x=new De);var N=x.get(e);if(N)return N;if(x.set(e,T),!k)var G=r?function(e){return function(e,t,r){var i=t(e);return Fe(e)?i:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(i,r(e))}(e,Ke,Ue)}(e):Ke(e);return function(e,t){for(var r=-1,i=e?e.length:0;++r<i&&!1!==t(e[r],r,e););}(G||e,function(n,s){G&&(n=e[s=n]),xe(T,s,Ie(n,t,r,i,s,e,x))}),T}function ke(e){return!(!We(e)||(t=e,Q&&Q in t))&&(He(e)||B(e)?te:x).test(Be(e));var t}function Me(e){var t=new e.constructor(e.byteLength);return new ne(t).set(new ne(e)),t}function Pe(e,t,r,i){r||(r={});for(var n=-1,s=t.length;++n<s;){var o=t[n],a=i?i(r[o],e[o],o,r,e):void 0;xe(r,o,void 0===a?e[o]:a)}return r}function Ne(e,t){var r,i,n=e.__data__;return("string"==(i=typeof(r=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function Ge(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return ke(r)?r:void 0}$e.prototype.clear=function(){this.__data__=ye?ye(null):{}},$e.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},$e.prototype.get=function(e){var t=this.__data__;if(ye){var r=t[e];return r===i?void 0:r}return Z.call(t,e)?t[e]:void 0},$e.prototype.has=function(e){var t=this.__data__;return ye?void 0!==t[e]:Z.call(t,e)},$e.prototype.set=function(e,t){return this.__data__[e]=ye&&void 0===t?i:t,this},Se.prototype.clear=function(){this.__data__=[]},Se.prototype.delete=function(e){var t=this.__data__,r=Te(t,e);return!(r<0||(r==t.length-1?t.pop():le.call(t,r,1),0))},Se.prototype.get=function(e){var t=this.__data__,r=Te(t,e);return r<0?void 0:t[r][1]},Se.prototype.has=function(e){return Te(this.__data__,e)>-1},Se.prototype.set=function(e,t){var r=this.__data__,i=Te(r,e);return i<0?r.push([e,t]):r[i][1]=t,this},Oe.prototype.clear=function(){this.__data__={hash:new $e,map:new(fe||Se),string:new $e}},Oe.prototype.delete=function(e){return Ne(this,e).delete(e)},Oe.prototype.get=function(e){return Ne(this,e).get(e)},Oe.prototype.has=function(e){return Ne(this,e).has(e)},Oe.prototype.set=function(e,t){return Ne(this,e).set(e,t),this},De.prototype.clear=function(){this.__data__=new Se},De.prototype.delete=function(e){return this.__data__.delete(e)},De.prototype.get=function(e){return this.__data__.get(e)},De.prototype.has=function(e){return this.__data__.has(e)},De.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Se){var n=i.__data__;if(!fe||n.length<r-1)return n.push([e,t]),this;i=this.__data__=new Oe(n)}return i.set(e,t),this};var Ue=ce?F(ce,Object):function(){return[]},ze=function(e){return ee.call(e)};function Le(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||T.test(e))&&e>-1&&e%1==0&&e<t}function Ve(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||K)}function Be(e){if(null!=e){try{return J.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ce(e,t){return e===t||e!=e&&t!=t}(de&&ze(new de(new ArrayBuffer(1)))!=g||fe&&ze(new fe)!=u||_e&&"[object Promise]"!=ze(_e.resolve())||me&&ze(new me)!=_||pe&&"[object WeakMap]"!=ze(new pe))&&(ze=function(e){var t=ee.call(e),r=t==d?e.constructor:void 0,i=r?Be(r):void 0;if(i)switch(i){case ge:return g;case ve:return u;case be:return"[object Promise]";case we:return _;case Ee:return"[object WeakMap]"}return t});var Fe=Array.isArray;function Ye(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}(e.length)&&!He(e)}var qe=ue||function(){return!1};function He(e){var t=We(e)?ee.call(e):"";return t==l||t==c}function We(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ke(e){return Ye(e)?Re(e):function(e){if(!Ve(e))return he(e);var t=[];for(var r in Object(e))Z.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return Ie(e,!0,!0)}});function E(e,t,r){t.getters?console.warn("Name conflict: property getters already exists"):t.getters={};const i={};for(let s in r){let o=r[s];i[s]=(()=>o.apply(t,e)),Object.defineProperty(t.getters,s,{get:()=>n[s],enumerable:!0})}const n=new d({computed:i});return n}function A(e){return e&&"object"==typeof e&&!Array.isArray(e)}function j(e,t){return t.split(".").reduce((e,t)=>e[t]||{},e)}function $(e,t){const r=(""+t).split("."),i=r.pop();return r.reduce((e,t)=>e[t]||{},e)[i]}function S(e,t,r=!0){let i=r?Object.assign({},e):{};for(let n in t){let s=null,o=null;e&&(s=A(e[n])),t&&(o=A(t[n])),s&&o?S(e[n],t[n],r):d.set(e,n,t[n]),delete i[n]}for(let t in i)d.delete(e,t);return i}function O(e,t,r){const i=(""+t).split("."),n=i.pop(),s=i.reduce((e,t)=>(t in e||d.set(e,t,{}),e[t]),e);if(n in s){if(".value"in r&&null===r[".value"])return void d.delete(s,n);S(s[n],r,!0)}else d.set(s,n,r);return s[n]}const D=new WeakMap,R=new WeakMap,x=["ServerTimestamp","CurrentTimestamp","InitialTimestamp"];class T{constructor(e,t,r){this.$ready=!1,this.$promise=Promise.resolve(),this.$state={},this.$dirty={},this.$invalid={},this.$id=null,this.$idx=null,this.$noaccess=null,this._store_name=r,d.observable(this.$state)}_update_data(e,t,r=!1){if(this.$state=e,r)for(var i in e)this.$dirty[i]=!0}clone(){const e=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return e.$state=w(e.$state),e.$dirty=w(e.$dirty),e.$invalid=w(e.$invalid),e.autogenerate_props(this.$model.modelDefinition.schema.fields,e.$state,!1),e._set_generic_store(this.$model),D.set(e,this.$vm),e}setValidationBehaviour(e){["ERROR","WARNING","ELEMENT_VALIDATION","NONE"].includes(e)&&(this._validation_behaviour=e)}_update_field(e,t,r){let n=this._validation_behaviour||"WARNING";const s=r.is_nested?()=>(function(e,t,r){const i=(""+t).split("."),n=i.pop(),s=i.reduce((e,t)=>(t in e||d.set(e,t,{}),e[t]),e);return d.set(s,n,r),s[n]})(this.$state,e,t):()=>d.set(this.$state,e,t);if(i.isMoment(t))return i.isValidDate(t)||console.warn("Got invalid e-moment object",t,"for prop",e),t=t.toRealtimeDB(),delete this.$invalid[e],this.$dirty[e]=!0,void s();if(!r.validate)return s(),void(this.$dirty[e]=!0);if(r.validate(t))delete this.$invalid[e],this.$dirty[e]=!0,s();else{if(this.$invalid[e]=!0,this.$dirty[e]=!0,s(),"ERROR"===n)throw new Error(`Validation failed for field '${e}' with value ${t}.`);"WARNING"===n&&console.warn(`Validation failed for field '${e}' with value ${t}.`)}}_onRemove(){this.$deleted=!0}$isValid(){return 0===Object.keys(this.$invalid).length}get $key(){return"KEY-"+this._store_name+"-"+this.$id}get $vm(){return D.get(this)}get $model(){return R.get(this)}autogenerate_props(e,t,r=!1){Array.isArray(e)||(e=Object.keys(e).map(t=>({model:t,...e[t]}))),e.forEach(e=>{let n=e.model;if(t&&n in t&&(this.$state[n]=t[n]),r&&(this.$dirty[n]=!0),Object.prototype.hasOwnProperty.call(this,n))return void console.warn(`Name conflict: property "${n}" has same name as global action/global getter "${n}" in ${this._store_name}`);let s=()=>{},o="";if(n.includes("/")||n.includes(".")){o=n.replace(/\//g,".");let t=n.split("/"),r=t.pop();t=t.join("."),s=(()=>{return j(this.$state,t)[r]}),e.is_nested=!0}else o=n,s=(()=>this.$state[n]),e.is_nested=!1;if(e.validate_bolt_type){const t=(e,t,r,s)=>0===e||null===e?e:i.isMoment(e)?void console.error("Do not assign moment objects directly."):isFinite(e)&&e>r&&e<s?t(e):void 0===e?t():(console.warn("Schema defined",n,"as Timestamp, but got invalid data:",e),e);let r=s;"Timestamp"===e.validate_bolt_type?s=(()=>{return t(r(),i.fromRealtimeDB,2e8,3e10)}):x.includes(e.validate_bolt_type)?s=(()=>{return t(r(),i.fromRealtimeServerTime,2e11,3e13)}):e.validate_bolt_type.includes("Timestamp")&&console.warn("Found validation type that contains 'Timestamp' but is not recognized:",e.validate_bolt_type)}Object.defineProperty(this,o,{set:t=>this._update_field(o,t,e),get:s})})}decorate_actions(e,t){if(e){t.model=this;for(let r in e){let i=e[r];Object.prototype.hasOwnProperty.call(this,r)?console.warn(`Name conflict: action "${r}" has same name as property/global action/global getter "${r}" in ${this._store_name}`):Object.defineProperty(this,r,{value:()=>i(t)})}}}decorate_getters(e,t){if(!e)return;for(let t in e)Object.prototype.hasOwnProperty.call(this,t)&&(console.warn(`Name conflict: getter "${t}" has same name as property/custom action/global action/global getter "${t}" in ${this._store_name}`),delete e[t]);t.model=this;let r=E(t,this,e);D.set(this,r)}_set_generic_store(e){R.set(this,e)}write(){console.log("Writing $dirty fields",JSON.stringify(this.$dirty));let e={};for(let t in this.$dirty){let r,i;t.includes(".")?(i=t.replace(/\./g,"/"),r=$(this.$state,t)):(i=t,r=this.$state[t]),void 0!==r?e[i]=r:console.warn("Trying to write undefined for prop",t)}let t=this.$model;if(!t)throw new Error("Model reference not set with _set_generic_store");let r=!0,i=this.$id;return i||(i=t._get_uid(),r=!1),t.modelDefinition&&t.modelDefinition.schema?t._validate_schema(e,r):console.warn("No schema found to validate input"),t.update(i,e).then(()=>(this.$id=i,this.$dirty={},i))}_get_modal_for_write(){if(!this.$id)throw new Error("Write operations are not allowed for new models.");let e=this.$model;if(!e)throw new Error("Model reference not set with _set_generic_store");return e}update(e){return this._get_modal_for_write().update(this.$id,e).then(()=>{for(var t in e)delete this.$dirty[t];return this.$id})}remove(e=!0){return this._get_modal_for_write().remove(this.$id,e).then(()=>{e&&delete this.$dirty.deleted})}restore(){return this._get_modal_for_write().restore(this.$id).then(()=>{delete this.$dirty.deleted})}reset(){}}function I(e,t){return e.sortidx<t.sortidx?-1:e.sortidx>t.sortidx?1:0}function k(e){let t=null;return"-"===e[0]?(e=e.slice(1),t=((t,r)=>t[e]<r[e]?1:t[e]>r[e]?-1:0)):t=((t,r)=>t[e]<r[e]?-1:t[e]>r[e]?1:0),t}const M=new WeakMap;class P{constructor(e){this.items={},this.$readyAll=!1,this.$readySome=!1,this.$promise=Promise.resolve(),this.$numReady=0,this.$noaccess=null,this.$numChildren=0,this._store_name=e,this._unwatch=null}_clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}_add_child(e,t){this.$readySome=!0,this.$lastUpdate=Date.now(),d.set(this.items,e,t),this.$numChildren+=1,this.items[e].$idx=this.$numChildren}_rem_child(e){e in this.items&&this.items[e]._onRemove(),d.delete(this.items,e),this.$numChildren-=1}get $vm(){return M.get(this)}decorate_actions(e,t){if(e){t.model=this;for(let r in e){let i=e[r];Object.prototype.hasOwnProperty.call(this,r)?console.warn(`Name conflict: list action "${r}" has same name as existing method "${r}" in ${this._store_name}`):Object.defineProperty(this,r,{value:()=>i(t)})}}}decorate_getters(e,t){if(!e)return;for(let t in e)Object.prototype.hasOwnProperty.call(this,t)&&(console.warn(`Name conflict: list getter "${t}" has same name as existing property getter "${t}" in ${this._store_name}`),delete e[t]);t.model=this;let r=E(t,this,e);M.set(this,r)}getItemByIdx(e){for(let t in this.items)if(this.items[t].$idx===e)return this.items[t];return null}asArraySorted(){let e=this._clone();return e.items=this.itemsAsArray(),e.items.sort(I),e}asArraySortedBy(e){let t=this._clone();return t.items=this.itemsAsArray(),t.items.sort(k(e)),t}asArrayFilteredBy(e,t){let r=this._clone();return r.items=this.itemsAsArray(),r.items=r.items.filter(r=>r[e]===t),r}itemsAsArray(){return Array.isArray(this.items)?this.items:Object.keys(this.items).map(e=>this.items[e])}get itemsSorted(){return this.itemsAsArray().sort(I)}itemsAsArrayWithoutDeleted(e){return this.itemsAsArray().filter(e=>!1===e.deleted||void 0===e.deleted).sort(e?k(e):I)}itemsAsArrayOnlyDeleted(e){return this.itemsAsArray().filter(e=>!0===e.deleted).sort(e?k(e):I)}get $id_list(){return Object.keys(this.items)}reset(){this._unwatch&&(console.log("Found local unwatcher in",this._store_name),this._unwatch())}}function N(e){var t=e[e.length-1];return e.pop(),e=e.length>1?N(e):e[0],function(...r){var i=e(...r),n=t(...r);return Object.assign(i||{},n)}}function G(){var e,t,r=new Promise((r,i)=>{e=r,t=i});return r.resolve=e,r.reject=t,r}let U=Array.prototype;function z(e,t){return e.filter(e=>t.indexOf(e)<0)}Object.defineProperty(U,"clone",{value:function(){return this.slice(0)},enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(U,"move",{value:function(e,t){this.splice(t,0,this.splice(e,1)[0])},enumerable:!1,configurable:!0,writable:!0});const L=()=>{},V=L,B=L,C=L,F=L,Y=L,q=new Map,H=new Map;"false"===String(process.env.VUE_APP_PRODUCTION)&&(window.helioRxDev=window.helioRxDev||{},window.helioRxDev._resultInstanceCache=q,window.helioRxDev._resultListCache=H);var W={read_mixin_init(){if(C(this.name),this.modelDefinition&&this.modelDefinition.staticGetters){const e=[_,h,this];this._vm=E(e,this,this.modelDefinition.staticGetters)}},_infer_local_path_from_ref:e=>e.path.toString().split("/").filter(e=>e).join("."),unsync(e=null,{clean_up:t=!1}={}){C(this.name);let r=null!==e?this.global_store_path_array[e]:this.global_store_path;if(r&&this._unbind_rtdb({key:r}),null!==e&&!(e in this.global_store_path_array)){if(this.isSuffixed)throw new Error("Unsync with id for data retrieved via subscribeList() is not supported.");r=this.global_store_path+"."+e}if(t){if(Y(this.name),null!==e&&H.has(this.path)){H.get(this.path)._rem_child(e)}h.commit("heliosrx/UNSET_VALUE",{path:r},{root:!0})}},unsync_all({clean_up:e=!1}={}){C(this.name);const t=this.subscriptions;if(t){if(e&&H.has(this.path)){let e=H.get(this.path);e.$id_list.forEach(t=>e._rem_child(t)),e.reset()}Object.keys(t).forEach(t=>{this._unbind_rtdb({key:t}),e&&h.commit("heliosrx/UNSET_VALUE",{path:t},{root:!0})})}},fetch_individual(e,{overwriteKey:t=!1,customOps:r={}}={}){return this.sync_individual(e,{overwriteKey:t,customOps:r,fetchOnce:!0})},fetch_list({overwriteKey:e=!1,customOps:t={},customRef:r=null}={}){return this.sync_list({overwriteKey:e,customOps:t,customRef:r,fetchOnce:!0})},sync_individual(e,{overwriteKey:t=!1,fetchOnce:r=!1,customOps:i={}}={}){this.isSuffixed;const n=this.childRef(e),s="res."+this._infer_local_path_from_ref(n);this.global_store_path_array[e]=s,B(this.name,"sync_individual:",this.name),C(this.name,"[GENS] - sync ref",n.path.toString()),C(this.name),C(this.name,"[GENS] - sync target",this.global_store_path_array[e]);let o={init:()=>{let t={};return C(this.name),h.commit("heliosrx/INIT_VALUE",{path:this.global_store_path_array[e],data:t},{root:!0}),{target:t}},set:(e,t)=>{C(this.name),h.commit("heliosrx/SET",{target:e,data:t},{root:!0})}};return r&&(o={init:()=>{F(this.name);return{target:{}}},set:(e,t)=>{F(this.name)}}),Object.keys(i).forEach(e=>{o[e]=N([o[e],i[e]])}),r?this._fetch_rtdb({key:s,ref:n,ops:o,bindAsArray:!1}):this._bind_rtdb({key:s,ref:n,ops:o,bindAsArray:!1})},sync_list({overwriteKey:e=!1,fetchOnce:t=!1,customOps:r={},customRef:i=null}={}){if(this.isSuffixed)throw new Error("Suffixed store does not support bind to array");const n=i||this.parentRef,s="res."+(e||this._infer_local_path_from_ref(n));B(this.name,"sync:",this.name),C(this.name,"[GENS] - ref",this.parentRef),C(this.name),this.global_store_path=s;const o={root:!0};let a={init:()=>{C(this.name,"[OPS:INIT]",this.global_store_path,h.state);let e={},t=j(h.state,this.global_store_path);return Object.keys(t).length>0&&(C(this.name),e=t),C(this.name),h.commit("heliosrx/INIT_VALUE",{path:this.global_store_path,data:e},o),{target:e}},add:(e,t,r)=>{C(this.name),h.commit("heliosrx/ARRAY_ADD",{target:e,newId:t,data:r},o)},remove:(e,t)=>{let r=e[t],i=this._match_all_existing_synced_queries(this.path);Y(this.name),Y(this.name,"entry_name",this.path),Y(this.name),Y(this.name);for(let e in i){let t=i[e].query;if(this._itemMatchesQuery(t,r))return void Y(this.name)}h.commit("heliosrx/ARRAY_REMOVE",{target:e,oldId:t},o)},set:(e,t,r)=>{C(this.name),h.commit("heliosrx/ARRAY_SET",{target:e,currentId:t,data:r},o)},once:(e,t,r)=>{}};return t&&(a={init:()=>{F(this.name);return{target:{}}},once:(e,t,r)=>{F(this.name)}}),Object.keys(r).forEach(e=>{a[e]=N([a[e],r[e]])}),C(this.name),C(this.name),t?this._fetch_rtdb({key:s,ref:n,ops:a,bindAsArray:!0}):this._bind_rtdb({key:s,ref:n,ops:a,bindAsArray:!0})},_itemMatchesQuery:(e,t)=>(console.log("[itemMatchesQuery]",e,t),!0),_create_context(){return{registry:h,store:this}},_match_all_existing_synced_queries(e,t=!0){e.includes("#")&&(e=e.split("#").shift());let r=[];for(var i in h.state.sync){let n=i.split("#").shift();if(e.startsWith(n)){let e=h.state.sync[i];if(!t||"Ready"!==e.status&&"Loading"!==e.status)continue;r.push({path:i,path_without_query:n,...e})}}return r},_match_existing_synced_nodes(e,t=!1){for(var r in e.includes("#")&&(e=e.split("#").shift()),h.state.sync){let i=r;if(r.includes("#")){let t=r.split("#").shift();e.startsWith(t)&&console.warn("You're trying to sync a path that has already been synced by a query. This is not supported.","requested_path",e,"existing_path",r)}if(t&&r.includes("{id}")&&(r=r.replace("{id}","")),e.startsWith(r)&&("Ready"===h.state.sync[i].status||"Loading"===h.state.sync[i].status))return B(this.name),i}return!1},_get_sync_state:e=>(h.state.sync[e]||{}).status||null,getList(e,{noReactiveGetter:t=!1}={}){return B(this.name),this.subscribeList(e,{noSync:!0,createModelFromExistingCache:!0,noReactiveGetter:t})},getNode(e,{noReactiveGetter:t=!1}={}){if(B(this.name),!e)throw new Error("getNode: got invalid id: "+e);return this.subscribeNode(e,{noSync:!0,createModelFromExistingCache:!0,noReactiveGetter:t})},subscribeList(e=[],{noSync:t=!1,noReactiveGetter:r=!1,createModelFromExistingCache:i=!1,queryParams:n=null}={}){let s=null,o="",a=this.path;if(n&&(s=this.buildQueryRef(n),o=this.queryHash(n),a=a+"#"+o,V(this.name)),B(this.name),H.get(a))return B(this.name),H.get(a);let l=h.getters.get_registry_entry(a);l&&B(this.name);const c=this._match_existing_synced_nodes(a,!0);if(c){if(i){let e=this.getData();B(this.name);let t=g.make_reactive_list(this.modelDefinition,e,this._create_context(),r);t.$promise=G();let i=this._get_sync_state(c);B(this.name),"Ready"===i&&t.$promise.resolve(!0),Y(this.name);let n=h.watch(e=>(Y(this.name),this.getData(null,!0)),(e,i)=>{if(Y(this.name),null==e)return t.$id_list.forEach(e=>{Y(this.name),t._rem_child(e)}),t.$numReady=!1,t.$readyAll=!1,t.$readySome=!1,void t.$promise.resolve(!0);let n=Object.keys(e),s=i?Object.keys(i):[],o=t.$id_list;n.toString()===s.toString()&&Y(this.name);let l=function(e,t){return{removed:z(t,e),added:z(e,t)}}(n,o);Y(this.name),l.removed.forEach(e=>{Y(this.name),t._rem_child(e),t.$numReady--}),l.added.forEach(e=>{Y(this.name);let i=a.split("#").shift().replace(/\{id\}/g,e);q.has(i)&&console.warn("A new item was added, but there already exists a model instance in the cache for this item. This means the subscription management failed.");let n=this.getData(e),s=g.make_reactive_model(this.modelDefinition,n,this._create_context(),!1,r);s.$id=e,t._add_child(e,s),t.$numReady++,q.set(i,s)}),t.$promise.resolve(!0)});return t._unwatch=n,H.set(a,t),t}console.warn("You're trying to sync data, that is already synced by a node higher up in the hierarchy. This will result in undefined behaviour. Try using getList() instead! Sync path:",a)}if(this._match_existing_synced_nodes(a)===a)throw console.log(">>>",a,H,q),new Error("Exact path found, but no cache hit. This should never happen");if(t)return B(this.name),console.warn("You're trying to fetch data at "+a+" that has not been synced yet."),null;V(this.name),l={query:n,status:"Loading"},h.commit("ADD_ENTRY",{name:a,data:l});let u=g.make_reactive_list(this.modelDefinition,null,this._create_context());H.set(a,u),u.$promise=G(),B(this.name);const d={add:(e,t,i)=>{h.commit("SET_ENTRY_STATUS",{name:a,value:"Ready"}),B(this.name,"subscribeList:add - Child ready",this.name);let n=a.split("#").shift().replace(/\{id\}/g,t);q.has(n)&&B(this.name),t in u.items&&console.warn("An existing item was added twice. This means the subscription management failed.");let s=q.has(n)?q.get(n):g.make_reactive_model(this.modelDefinition,i,this._create_context(),!1,r);s.$id=t,u._add_child(t,s),q.has(n)?s._update_data(i):q.set(n,s)},init:e=>(B(this.name),{}),remove:(e,t)=>{Y(this.name),u._rem_child(t)},set:(e,t,r)=>{if(B(this.name),H.get(a)&&t in H.get(a).items){let e=H.get(a).items[t],r=this.getData(t);e._update_data(r,this.modelDefinition.schema.fields),B(this.name)}else B(this.name,"subscribeList:set - WARNING - not found in cache!",t,H.get(a))}};return this.sync_list({customOps:d,customRef:s}).then(()=>{u.$readyAll=!0,u.$promise.resolve(!0)}).catch(e=>{if("PERMISSION_DENIED"!==e.code)throw e;console.warn(e.message),console.log("======================================"),console.log(`PERMISSION_DENIED [${this.name}.subscribeList()]`),console.log("queryParams:",n),console.log("======================================"),u.$readyAll=!0,u.$readySome=!0,u.$noaccess=!0,u.$promise.reject(e)}),u},subscribeNode(e,{noSync:t=!1,noReactiveGetter:r=!1,createModelFromExistingCache:i=!1}={}){if(!e)throw new Error("subscribeNode: got invalid id: ");let n=this._previewPath(e),s=this.path;if(B(this.name),H.get(s)&&e in H.get(s).items)return B(this.name),H.get(s).items[e];if(q.has(n))return B(this.name),q.get(n);if(this._match_existing_synced_nodes(s)&&V(this.name,"======================================= (FIXME)",{entry_name_child:n},{entry_name_list:s},{"has:node":q.has(n)},{"get:list":q.get(s)}),this._match_existing_synced_nodes(n)){if(i){let t=this.getData(e);B(this.name);let i=g.make_reactive_model(this.modelDefinition,t,this._create_context(),!1,r);return i.$id=e,i.$ready=!0,q.set(n,i),B(this.name),i}console.warn("You're trying to sync data, that is already synced by a node higher up in the hierarchy. This will result in undefined behaviour. Try using getNode() instead! Sync path:",n)}if(this._match_existing_synced_nodes(n)===n)throw console.log(">>>",n,H,q),new Error("Exact path found, but no cache hit. This should never happen");if(t)return null;V(this.name);let o=g.make_reactive_model(this.modelDefinition,null,this._create_context(),!1,r);o.$id=e,o.$promise=G(),q.set(n,o);let a={id:e,status:"Loading"};h.commit("ADD_ENTRY",{name:n,data:a}),B(this.name);const l={init:e=>(B(this.name),{}),set:(e,t)=>{B(this.name)}};return this.sync_individual(e,{customOps:l}).then(t=>{let r=this.getData(e);B(this.name),void 0!==r?(o._update_data(r,this.modelDefinition.schema.fields),o.$ready=!0,o.$noaccess=!1,h.commit("SET_ENTRY_STATUS",{name:n,value:"Ready"}),B(this.name),o.$promise.resolve(!0)):console.warn(this.name,"subscribeNode - subscribeList took over, while waiting for sync_individual. subscribeList will handle instance now.")}).catch(t=>{if("PERMISSION_DENIED"!==t.code)throw t;{console.warn(t.message),console.log("======================================"),console.log(`PERMISSION_DENIED [${this.name}.subscribeNode( ${e} )]`),console.log("======================================"),h.commit("SET_ENTRY_STATUS",{name:n,value:"NoAccess"});let r=this.getData(e);r[".noaccess"]=!0,o._update_data(r,this.modelDefinition.schema.fields),o.$ready=!0,o.$noaccess=!0,o.$promise.reject(t)}}),o},buildQueryRef({key:e,value:t,limit:r,startAt:i,endAt:n}){let s=this.parentRef;return s="*"===e?s.orderByValue():void 0===e?s.orderByKey():s.orderByChild(e),void 0!==t&&(s=s.equalTo(t)),void 0!==i&&(s=s.startAt(i)),void 0!==n&&(s=s.endAt(n)),void 0!==r&&(s=r>0?s.limitToFirst(r):s.limitToLast(-r)),s},queryHash:e=>[e.key,e.value,e.limit,e.startAt,e.endAt].join("_"),subscribeQuery(e,t={}){return this.subscribeList(null,{...t,queryParams:e})},fetchNode(e,{noReactiveGetter:t=!1}={}){let r=g.make_reactive_model(this.modelDefinition,null,this._create_context(),!1,t);r.$id=e,r.$promise=G();const i={init:e=>(F(this.name),{}),set:(e,t)=>{F(this.name)}};return this.fetch_individual(e,{customOps:i}).then(e=>{F(this.name),r._update_data(e,this.modelDefinition.schema.fields),r.$ready=!0,r.$promise.resolve(!0)}),r},fetchList({noReactiveGetter:e=!1,queryParams:t=null}={}){let r=t?this.buildQueryRef(t):null,i=g.make_reactive_list(this.modelDefinition,null,this._create_context(),e);i.$promise=G();const n={init:()=>(F(this.name),{}),once:(e,t,r)=>{F(this.name)}};return this.fetch_list({customOps:n,customRef:r}).then(t=>{F(this.name),Object.keys(t||[]).forEach(r=>{let n=t[r],s=g.make_reactive_model(this.modelDefinition,n,this._create_context(),!1,e);s.$id=r,i._add_child(r,s),i.$numReady++}),i.$readyAll=!0,i.$promise.resolve(!0)}),i},fetchQuery(e,t){return this.fetchList({...t,queryParams:e})},getRegistryState:()=>h.state,getAllSyncedPaths(){let e={};return Object.keys(h.state.sync).forEach(t=>{e[t]=h.state.sync[t].status}),e},getData(e=null,t=!1){let r="";if(this.isSuffixed||e){if(!e)throw new Error("getData: id required for suffixed stores");r=this.path.replace(/\{id\}/g,e)}else r=this.path.split("{id}").shift();let i="res."+r.split("/").filter(e=>e).join(".");return h.state.initialized?t?j(h.state,i):(n=h.state,i.split(".").reduce((e,t)=>e[t],n)):null;var n},reset_global_instance_cache(){try{q.forEach(e=>{e.reset()}),H.forEach(e=>{e.reset()})}catch(e){console.warn("Reseting instances failed",e)}q.clear(),H.clear()}},K=b(function(e,t){var r=200,i="__lodash_hash_undefined__",n=1,s=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",h="[object Date]",d="[object Error]",f="[object Function]",_="[object GeneratorFunction]",m="[object Map]",p="[object Number]",y="[object Null]",g="[object Object]",b="[object Proxy]",w="[object RegExp]",E="[object Set]",A="[object String]",j="[object Symbol]",$="[object Undefined]",S="[object ArrayBuffer]",O="[object DataView]",D=/^\[object .+?Constructor\]$/,R=/^(?:0|[1-9]\d*)$/,x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x[a]=x[l]=x[S]=x[u]=x[O]=x[h]=x[d]=x[f]=x[m]=x[p]=x[g]=x[w]=x[E]=x[A]=x["[object WeakMap]"]=!1;var T="object"==typeof v&&v&&v.Object===Object&&v,I="object"==typeof self&&self&&self.Object===Object&&self,k=T||I||Function("return this")(),M=t&&!t.nodeType&&t,P=M&&e&&!e.nodeType&&e,N=P&&P.exports===M,G=N&&T.process,U=function(){try{return G&&G.binding&&G.binding("util")}catch(e){}}(),z=U&&U.isTypedArray;function L(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}function V(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function B(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var C,F,Y,q=Array.prototype,H=Function.prototype,W=Object.prototype,K=k["__core-js_shared__"],X=H.toString,Q=W.hasOwnProperty,J=(C=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"",Z=W.toString,ee=RegExp("^"+X.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=N?k.Buffer:void 0,re=k.Symbol,ie=k.Uint8Array,ne=W.propertyIsEnumerable,se=q.splice,oe=re?re.toStringTag:void 0,ae=Object.getOwnPropertySymbols,le=te?te.isBuffer:void 0,ce=(F=Object.keys,Y=Object,function(e){return F(Y(e))}),ue=Ue(k,"DataView"),he=Ue(k,"Map"),de=Ue(k,"Promise"),fe=Ue(k,"Set"),_e=Ue(k,"WeakMap"),me=Ue(Object,"create"),pe=Be(ue),ye=Be(he),ge=Be(de),ve=Be(fe),be=Be(_e),we=re?re.prototype:void 0,Ee=we?we.valueOf:void 0;function Ae(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function je(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function $e(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function Se(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new $e;++t<r;)this.add(e[t])}function Oe(e){var t=this.__data__=new je(e);this.size=t.size}function De(e,t){var r=Ye(e),i=!r&&Fe(e),n=!r&&!i&&qe(e),s=!r&&!i&&!n&&Qe(e),o=r||i||n||s,a=o?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],l=a.length;for(var c in e)!t&&!Q.call(e,c)||o&&("length"==c||n&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ve(c,l))||a.push(c);return a}function Re(e,t){for(var r=e.length;r--;)if(Ce(e[r][0],t))return r;return-1}function xe(e){return null==e?void 0===e?$:y:oe&&oe in Object(e)?function(e){var t=Q.call(e,oe),r=e[oe];try{e[oe]=void 0;var i=!0}catch(e){}var n=Z.call(e);i&&(t?e[oe]=r:delete e[oe]);return n}(e):function(e){return Z.call(e)}(e)}function Te(e){return Xe(e)&&xe(e)==a}function Ie(e,t,r,i,o){return e===t||(null==e||null==t||!Xe(e)&&!Xe(t)?e!=e&&t!=t:function(e,t,r,i,o,c){var f=Ye(e),_=Ye(t),y=f?l:Le(e),v=_?l:Le(t),b=(y=y==a?g:y)==g,$=(v=v==a?g:v)==g,D=y==v;if(D&&qe(e)){if(!qe(t))return!1;f=!0,b=!1}if(D&&!b)return c||(c=new Oe),f||Qe(e)?Pe(e,t,r,i,o,c):function(e,t,r,i,o,a,l){switch(r){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!a(new ie(e),new ie(t)));case u:case h:case p:return Ce(+e,+t);case d:return e.name==t.name&&e.message==t.message;case w:case A:return e==t+"";case m:var c=V;case E:var f=i&n;if(c||(c=B),e.size!=t.size&&!f)return!1;var _=l.get(e);if(_)return _==t;i|=s,l.set(e,t);var y=Pe(c(e),c(t),i,o,a,l);return l.delete(e),y;case j:if(Ee)return Ee.call(e)==Ee.call(t)}return!1}(e,t,y,r,i,o,c);if(!(r&n)){var R=b&&Q.call(e,"__wrapped__"),x=$&&Q.call(t,"__wrapped__");if(R||x){var T=R?e.value():e,I=x?t.value():t;return c||(c=new Oe),o(T,I,r,i,c)}}if(!D)return!1;return c||(c=new Oe),function(e,t,r,i,s,o){var a=r&n,l=Ne(e),c=l.length,u=Ne(t).length;if(c!=u&&!a)return!1;for(var h=c;h--;){var d=l[h];if(!(a?d in t:Q.call(t,d)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var _=!0;o.set(e,t),o.set(t,e);for(var m=a;++h<c;){d=l[h];var p=e[d],y=t[d];if(i)var g=a?i(y,p,d,t,e,o):i(p,y,d,e,t,o);if(!(void 0===g?p===y||s(p,y,r,i,o):g)){_=!1;break}m||(m="constructor"==d)}if(_&&!m){var v=e.constructor,b=t.constructor;v!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b)&&(_=!1)}return o.delete(e),o.delete(t),_}(e,t,r,i,o,c)}(e,t,r,i,Ie,o))}function ke(e){return!(!Ke(e)||(t=e,J&&J in t))&&(He(e)?ee:D).test(Be(e));var t}function Me(e){if(r=(t=e)&&t.constructor,i="function"==typeof r&&r.prototype||W,t!==i)return ce(e);var t,r,i,n=[];for(var s in Object(e))Q.call(e,s)&&"constructor"!=s&&n.push(s);return n}function Pe(e,t,r,i,o,a){var l=r&n,c=e.length,u=t.length;if(c!=u&&!(l&&u>c))return!1;var h=a.get(e);if(h&&a.get(t))return h==t;var d=-1,f=!0,_=r&s?new Se:void 0;for(a.set(e,t),a.set(t,e);++d<c;){var m=e[d],p=t[d];if(i)var y=l?i(p,m,d,t,e,a):i(m,p,d,e,t,a);if(void 0!==y){if(y)continue;f=!1;break}if(_){if(!L(t,function(e,t){if(n=t,!_.has(n)&&(m===e||o(m,e,r,i,a)))return _.push(t);var n})){f=!1;break}}else if(m!==p&&!o(m,p,r,i,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function Ne(e){return function(e,t,r){var i=t(e);return Ye(e)?i:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(i,r(e))}(e,Je,ze)}function Ge(e,t){var r,i,n=e.__data__;return("string"==(i=typeof(r=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function Ue(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return ke(r)?r:void 0}Ae.prototype.clear=function(){this.__data__=me?me(null):{},this.size=0},Ae.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ae.prototype.get=function(e){var t=this.__data__;if(me){var r=t[e];return r===i?void 0:r}return Q.call(t,e)?t[e]:void 0},Ae.prototype.has=function(e){var t=this.__data__;return me?void 0!==t[e]:Q.call(t,e)},Ae.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=me&&void 0===t?i:t,this},je.prototype.clear=function(){this.__data__=[],this.size=0},je.prototype.delete=function(e){var t=this.__data__,r=Re(t,e);return!(r<0||(r==t.length-1?t.pop():se.call(t,r,1),--this.size,0))},je.prototype.get=function(e){var t=this.__data__,r=Re(t,e);return r<0?void 0:t[r][1]},je.prototype.has=function(e){return Re(this.__data__,e)>-1},je.prototype.set=function(e,t){var r=this.__data__,i=Re(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},$e.prototype.clear=function(){this.size=0,this.__data__={hash:new Ae,map:new(he||je),string:new Ae}},$e.prototype.delete=function(e){var t=Ge(this,e).delete(e);return this.size-=t?1:0,t},$e.prototype.get=function(e){return Ge(this,e).get(e)},$e.prototype.has=function(e){return Ge(this,e).has(e)},$e.prototype.set=function(e,t){var r=Ge(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},Se.prototype.add=Se.prototype.push=function(e){return this.__data__.set(e,i),this},Se.prototype.has=function(e){return this.__data__.has(e)},Oe.prototype.clear=function(){this.__data__=new je,this.size=0},Oe.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Oe.prototype.get=function(e){return this.__data__.get(e)},Oe.prototype.has=function(e){return this.__data__.has(e)},Oe.prototype.set=function(e,t){var i=this.__data__;if(i instanceof je){var n=i.__data__;if(!he||n.length<r-1)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new $e(n)}return i.set(e,t),this.size=i.size,this};var ze=ae?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,s=[];++r<i;){var o=e[r];t(o,r,e)&&(s[n++]=o)}return s}(ae(e),function(t){return ne.call(e,t)}))}:function(){return[]},Le=xe;function Ve(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||R.test(e))&&e>-1&&e%1==0&&e<t}function Be(e){if(null!=e){try{return X.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ce(e,t){return e===t||e!=e&&t!=t}(ue&&Le(new ue(new ArrayBuffer(1)))!=O||he&&Le(new he)!=m||de&&"[object Promise]"!=Le(de.resolve())||fe&&Le(new fe)!=E||_e&&"[object WeakMap]"!=Le(new _e))&&(Le=function(e){var t=xe(e),r=t==g?e.constructor:void 0,i=r?Be(r):"";if(i)switch(i){case pe:return O;case ye:return m;case ge:return"[object Promise]";case ve:return E;case be:return"[object WeakMap]"}return t});var Fe=Te(function(){return arguments}())?Te:function(e){return Xe(e)&&Q.call(e,"callee")&&!ne.call(e,"callee")},Ye=Array.isArray;var qe=le||function(){return!1};function He(e){if(!Ke(e))return!1;var t=xe(e);return t==f||t==_||t==c||t==b}function We(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function Ke(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Xe(e){return null!=e&&"object"==typeof e}var Qe=z?function(e){return function(t){return e(t)}}(z):function(e){return Xe(e)&&We(e.length)&&!!x[xe(e)]};function Je(e){return null!=(t=e)&&We(t.length)&&!He(t)?De(e):Me(e);var t}e.exports=function(e,t){return Ie(e,t)}});const X=(...e)=>{console.log(...e)};var Q={write_mixin_init(e=!1){if(this.modelDefinition&&this.modelDefinition.staticActions){!function(e,t,r,i){for(let n in r){let s=r[n];if(i&&delete t[n],Object.prototype.hasOwnProperty.call(t,n)){let t=e.$store.name;console.warn(`Name conflict: action "${n}" has same name as another property "${n}" in ${t}`)}else Object.defineProperty(t,n,{value:(...r)=>s.apply(t,[e,...r]),enumerable:!0})}}({$store:this,$models:_,$registry:h},this,this.modelDefinition.staticActions,e)}},add(e,t,r){let i=null;if(t||(t=this._get_uid()),!t[".sv"]&&!this._validateId(t))throw new Error("Got invalid id:"+t);let n=!0;return r&&r.directWrite&&(n=!1),this.modelDefinition?(n?this.modelDefinition.schema&&this.modelDefinition.schema.create?(this._check_required_create_arg(e),i=this.modelDefinition.schema.create(e,e,"REALTIMEDB")):(console.warn("No create function found in type definition, using overwrite data as payload."),i=e):i=e,this.modelDefinition.schema?this._validate_schema(i,!1):console.warn("No schema found to validate input")):(console.warn("No type definition found, using UNVALIDATED overwrite data as payload."),i=e),this._convert_moment_objects(i),X("[GENS] Creating at",this._previewPath(t),"with payload",i),this.isSuffixed?this.childRef(t).update(i).then(()=>t):this.parentRef.update({[t]:i}).then(()=>t)},update(e,t){if(!e||!t)throw new Error("Either id or data is missing.");if(!this._validateId(e)){if(!(this.modelDefinition.schema||{}).unsafe_disable_validation)throw new Error("Got invalid id in update");console.warn("Got invalid id <"+e+">, but validation is disabled.")}this.modelDefinition.schema?this._validate_schema(t,!0):console.warn("No schema found to validate input");let r=t;return this._convert_moment_objects(r),X("[GENS] Updating at",this._previewPath(e),"with payload",r),this.childRef(e).update(r)},reorder(e,t={}){if(this.isSuffixed)throw new Error("Suffixed store does not support reorder");let r=t.overwriteSortIdxKey||"sortidx";if(e.length>0&&"object"!=typeof e[0]){let t=0;e=e.map(e=>({id:e,sortidx:t+=100}))}let i={};e.forEach(e=>{let t=e.sortidx;if(e.id=e.id||e.$id,"number"!=typeof t&&(t=parseFloat(t)),isNaN(t))throw new Error("Got invalid sortidx",t);if(!this._validateId(e.id))throw new Error("Got invalid id",e.id);i[e.id]={[r]:t}});let n={};return Object.keys(i).forEach(e=>{let t=i[e];Object.keys(t).forEach(r=>{n[this._previewPath(e)+"/"+r]=t[r]})}),X("[GENS] update at",this._previewPath(),"with payload",n),this.rootRef.update(n)},remove(e,t){if(t=void 0===t?this.defaultDeleteMode===a.SOFT:t,Array.isArray(e)){const r={};return e.forEach(e=>{if(!this._validateId(e))throw new Error("Got invalid id in remove");t?r[e+"/deleted"]=!0:r[e]=null}),X("[GENS] batch deleting at",this.path,"with payload",r),this.parentRef.update(r)}if(!this._validateId(e))throw new Error("Got invalid id in remove");return t?(X("[GENS] soft deleting at",this.path,"with",{deleted:!0}),this.update(e,{deleted:!0})):(X("[GENS] hard deleting at",this.path),this.childRef(e).remove())},restore(e){return this.update(e,{deleted:!1})},copy(e,t,r){return this.move(e,t,r,{keepOriginal:!0,keepId:!1})},move(e,t,r,{keepOriginal:i=!1,keepId:n=!0}={}){if(this.isSuffixed)throw new Error("Suffixed store does not support move");if(!this._validateId(e))throw new Error("Got invalid id in remove");let s=Object.keys(t).sort(),o=Object.keys(r).sort();if(!K(s,o))throw new Error("Context A and context B do not have equal keys");let a=Object.assign({},this.definedProps,t,{id:e}),u=Object.assign({},this.definedProps,r,{id:e});n||(u.id=this._get_uid());let h=this.templatePath.replace(/\*/,"{id}"),d=l(h,a),f=l(h,u),_=c(d);if(_.length>0)throw new Error("Not all template id's are defined. Required fields are "+_.join(", "));return this._db.ref(d).once("value").then(e=>{return e.val()}).then(e=>{let t={[d]:null,[f]:e};return i&&(t={[f]:e}),X("[GENS] moving data from ",d,"to",f,"with payload",t),this.rootRef.update(t).then(()=>u.id)})},transaction(e,t,r,i=1){if(!this._validateId(e))throw new Error("Got invalid id in remove");let n=this.childRef(e);if(t&&(this._validate_schema({[t]:1}),n=n.ref.child(t)),"string"==typeof r)switch(r){case"inc":r=(e=>(e||0)+i);break;case"dec":r=(e=>(e||0)-i)}if("function"!=typeof r)throw new Error("Transacton must be a function");return X("[GENS] tranaction on ",n.path.toString()),n.transaction(r).then(e=>e.committed?(console.log("[GENS] Transacton successfully committed"),!0):(console.log("[GENS] Transacton aborted"),!1))},new(){return g.make_reactive_model(this.modelDefinition,null,this._create_context(),!1)},new_from_template(e={},t=null){let r=this.empty(e,t),i=g.make_reactive_model(this.modelDefinition,e,this._create_context(),!1);return i._update_data(r,null,!0),i},new_from_data(e={},t=!1){return g.make_reactive_model(this.modelDefinition,e,this._create_context(),!1)},empty(e={},t=null){if(!this.modelDefinition)return null;if(!this.modelDefinition.schema||!this.modelDefinition.schema.create)return null;this._check_required_create_arg(e);let r=this.modelDefinition.schema.create(e,t||e,"REALTIMEDB");return this.modelDefinition.schema?this._validate_schema(r,!1):console.warn("No schema found to validate input"),r},_convert_moment_objects(e){if("object"!=typeof e)throw console.log("Got payload",e,typeof e),new Error("Expected object, got "+e);for(let t in e)if(i.isMoment(e[t])){if(!e[t].toRealtimeDB)throw new Error("Moment object passed to add/update must be enhanced moment objects.");e[t]=e[t].toRealtimeDB()}else Array.isArray(e[t])?this._convert_moment_objects(e[t]):"object"==typeof e[t]&&this._convert_moment_objects(e[t])}};const J=require("slugid"),Z=(...e)=>{console.log(...e)},ee=(...e)=>{},te=new WeakMap;let re,ie=null,ne=null,se={userId:null};class oe{constructor(e,t,r={}){if(t&&(t.abstract_store||r.isAbstract))this.isAbstract=!0,this.templatePath=e,this.modelDefinition=t,this.definedProps={},this.name="unnamed abstract";else{if(this.isAbstract=!1,this.name="unnamed",!e||e.length<2)throw new Error("Invalid template path:"+e);if("/"!==e[0])throw new Error("Template path has to start with /, got: "+e);if(1!==(e.match(/\*/g)||[]).length)throw new Error("Template path must contain exactly one *, got:"+e);this.isSuffixed=e.indexOf("*")!==e.length-1,"function"==typeof r.uidMethod?(this.uidMethod=o.CUSTOM,this.uidMethodCallback=r.uidMethod):this.uidMethod=r.uidMethod||o.PUSHID,this.additionalProps=r.additionalProps||[],this.defaultDeleteMode=r.defaultDeleteMode||a.HARD}this.isReadonly=r.isReadonly,this.templatePath=e,this.modelDefinition=t,this.definedProps={},this._localDB=null,this._clones=[],this.global_store_path_array=[],this.isSuffixed||(this.global_store_path=""),this.isAbstract?(Object.assign(this,{read_mixin_init:W.read_mixin_init,write_mixin_init:Q.write_mixin_init}),this.read_mixin_init(),this.write_mixin_init()):(Object.assign(this,W),this.read_mixin_init(),this.isReadonly||(Object.assign(this,Q),this.write_mixin_init()))}_clone(){const e=Object.getPrototypeOf(this),t=Object.create(e),r=Object.assign(t,this);return delete r.getters,delete r._vm,r.read_mixin_init(),this.isReadonly||r.write_mixin_init(!0),r._clones=[],this._clones.push(r),r}setName(e){this.name=e}generateId(){return this._get_uid()}_get_uid(){switch(this.uidMethod){case o.SLUGID:return J.nice();case o.PUSHID:return this.rootRef.push().key;case o.TIMESTAMP:return ne.database.ServerValue.TIMESTAMP;case o.LOCAL_TIMESTAMP:return i.currentTime().unix();case o.DATE:return i.currentDate().format("DD-MM-YYYY");case o.OTHER_USER_ID:throw new Error("Please provide id through id override");case o.MY_USER_ID:if(!oe.defaultUserId)throw new Error("User ID is not set, but a store uses USER_ID as key");return oe.defaultUserId;case o.ARRAY:return 0;case o.EMAIL:throw new Error("Only email addresses allowed as key");case o.CUSTOM:let e=this.uidMethodCallback(this.definedProps);if(!e)throw new Error("An ID was not defined. Check custom UID Callback.");return e;default:throw new Error("Unknown UID Method: "+this.uidMethod)}}static setDefaultDB(e){ie=e}get _db(){return this._localDB||ie}_validateId(e){return!(this.uidMethod===o.SLUGID&&!function(e){return this.isString(e)&&e.length&&e.length>=20}(e))&&!(-1===e||!e)}_defineUser(){oe.defaultUserId&&(this.definedProps.uid=oe.defaultUserId)}static get defaultUserId(){return se.userId}get defaultUserId(){return se.userId}static set defaultUserId(e){Z("[GENS] settings default user id to: uid =",e),re.set(se,"userId",e)}static resetState(){Z("[GENS] reset state"),re.set(se,"userId",null)}get path(){"uid"in this.definedProps||this._defineUser();let e=l(this.templatePath,this.definedProps),t=c(e);if(t.length>0)throw new Error("Not all template id's are defined. Required fields are "+t.join(", "));return e.replace(/\*/g,"{id}")}_previewPath(e){"uid"in this.definedProps||this._defineUser();let t=l(this.templatePath,this.definedProps);return t=e?t.replace(/\*/g,e):t.replace(/\*/,"{id}")}childRef(e){return this._db.ref(this.path.replace(/\{id\}/g,e))}get parentRef(){return this._db.ref(this.path.split("{id}").shift())}get rootRef(){return this._db.ref()}_define(e,t){e.definedProps=Object.assign({},this.definedProps,t);let r=[].concat(this._template_path_field_names,this.additionalProps);for(var i in t)r.includes(i)||console.warn("Prop",i,"not found in template path. Known fields are",r);return e}define(e){return this._define(this,e)}with(e){let t=this._clone();return this._define(t,e)}get _template_path_field_names(){return c(this.templatePath)}reset(e=1){1===e&&ee("[GENS] resetting",this.name,"with",this._clones.length,"clones"),this.definedProps={},e>3?console.warn("[GENS] RESET - Stop at recursion level 3",this._clones):this._clones.forEach(t=>{t.reset(e+1)})}get _schema_fields(){let e=((this.modelDefinition||{}).schema||{}).fields;return void 0===e?[]:(Array.isArray(e)||(e=Object.keys(e).map(t=>({model:t,...e[t]}))),e)}get schema_required_fields(){return this._schema_fields.filter(e=>e.required).map(e=>e.model)}get schema_optional_fields(){return this._schema_fields.filter(e=>!e.required).map(e=>e.model)}get schema_all_fields(){return this._schema_fields.map(e=>e.model)}_check_required_fields(e){this.schema_required_fields.forEach(t=>{if(!(t in e))throw new Error("Required field <"+t+"> not present.")})}_check_required_create_arg(e){(((this.modelDefinition||{}).schema||{}).create_required||[]).forEach(t=>{if(!(t in e))throw new Error("Required create argument <"+t+"> not present.")})}_validate_schema(e,t){if(this.modelDefinition&&this.modelDefinition.schema&&this.modelDefinition.schema.unsafe_disable_validation)return;let r=this._schema_fields;if(!(r&&r.length>=0))throw new Error('No schema found for "'+this.name+'", please provide one.');{t||this._check_required_fields(e);let i=this.schema_all_fields,n=[],s={};0===r.length?console.warn('Schema for "'+this.name+'" is empty.'):s=Object.assign(...i.map((e,t)=>(e.startsWith("/")&&e.endsWith("/")&&n.push(e),{[e]:this._schema_fields[t]}))),Object.keys(e).forEach(t=>{let r=n.find(e=>{return new RegExp(e.substring(1,e.length-1),"u").test(t)});if(!r&&!i.includes(t))throw new Error("Field <"+t+"> is not allowed by schema.");let o=s[r||t];if(o.validator){let r=o.validator(e[t],o,null);if(!r||r.length&&0===r.length)throw new Error("Schema validation failed for key <"+t+"> with error: "+r)}})}}get subscriptions(){return te.get(this)}_bind_rtdb({key:e,ref:t,ops:r,bindAsArray:i}){let n=te.get(this);return n||(n=Object.create(null),te.set(this,n)),e in n&&this._unbind_rtdb(e),new Promise((s,o)=>{n[e]=i?function({collection:e,ops:t,resolve:r,reject:i}){const{target:n}=t.init();e.once("value",e=>{t.once(n,e.val(),e.exists()),r()},e=>{e&&i(e)});const s=e.on("child_added",(e,r)=>{t.add(n,e.key,e.val())},i),o=e.on("child_removed",e=>{t.remove(n,e.key)},i),a=e.on("child_changed",e=>{t.set(n,e.key,e.val())},i),l=e.on("child_moved",(e,t)=>{},i);return()=>{e.off("child_added",s),e.off("child_changed",a),e.off("child_removed",o),e.off("child_moved",l)}}({key:e,collection:t,ops:r,resolve:s,reject:o}):function({document:e,ops:t,resolve:r,reject:i}){const{target:n}=t.init(),s=e.on("value",e=>{let i=e.val();e.exists()||(i={".exists":!1}),t.set(n,i),r(i)},e=>{e&&i(e)});return()=>{e.off("value",s)}}({key:e,document:t,ops:r,resolve:s,reject:o})})}_fetch_rtdb({key:e,ref:t,ops:r,bindAsArray:i}){return new Promise((n,s)=>{i?function({collection:e,ops:t,resolve:r,reject:i}){const{target:n}=t.init();e.once("value",e=>{let i=e.val();t.once(n,i,e.exists()),r(i)},e=>{e&&i(e)})}({key:e,collection:t,ops:r,resolve:n,reject:s}):function({document:e,ops:t,resolve:r,reject:i}){const{target:n}=t.init();e.once("value",e=>{let i=e.val();e.exists()||(i={".exists":!1}),t.set(n,i),r(i)},e=>{e&&i(e)})}({key:e,document:t,ops:r,resolve:n,reject:s})})}_unbind_rtdb({key:e}){const t=te.get(this);t&&t[e]&&(t[e](),delete t[e])}get rules(){let e=this.modelDefinition.schema.fields;Array.isArray(e)||(e=Object.keys(e).map(t=>({model:t,...e[t]})));let t={};return e.forEach(e=>{t[e.model]=[{validator:(t,r,i)=>{e.validate(r)?i():i(new Error("Invalid input"))},trigger:"blur"}]}),t}}var ae={strict:!0,state:{initialized:!1,res:{},sync:{},ready:{}},getters:{get_registry_entry:e=>t=>e.sync[t],is_ready:e=>t=>e.ready[t]||!1},mutations:{...{"heliosrx/INIT_VALUE":(e,{path:t,data:r})=>O(e,t,r),"heliosrx/UNSET_VALUE":(e,{path:t})=>O(e,t,{".value":null}),"heliosrx/ARRAY_ADD"(e,{target:t,newId:r,data:i}){d.set(t,r,i)},"heliosrx/ARRAY_REMOVE"(e,{target:t,oldId:r}){d.delete(t,r)},"heliosrx/ARRAY_SET"(e,{target:t,currentId:r,data:i,performMerge:n=!1}){t[r]?S(t[r],i,!n):t[r]=i},"heliosrx/SET"(e,{target:t,data:r,performMerge:i=!1}){S(t,r,!i)}},INIT_REGISTRY(e){e.initialized=!0},RESET_REGISTRY(e){d.set(e,"sync",{}),d.set(e,"res",{}),d.set(e,"ready",{}),e.initialized=!1},ADD_ENTRY(e,{name:t,data:r}){e.sync[t]&&e.sync[t]===r||d.set(e.sync,t,r)},SET_ENTRY_STATUS(e,{name:t,value:r}){e.sync[t][status]&&e.sync[t][status]===r||d.set(e.sync[t],"status",r)},SET_GLOBAL_READY_STATE(e,{name:t,value:r}){e.ready[t]&&e.ready[t]===!!r||d.set(e.ready,t,!!r)},REM_GLOBAL_READY_STATE(e,{name:t}){d.delete(e.ready,t)}}};function le(e){return ae.name=e,ae.namespaced=!0,ae}let ce;var ue={registerStore(){},removeStore(){},getAllStores(){},resetAllStores(){}};function he(e){oe.setDefaultDB(e)}function de(e){if(null!==oe.defaultUserId)throw new Error("Call resetGenericStores before setting the default user id");oe.defaultUserId=e}function fe(e=!0){oe.resetState();const t=ue.getAllStores();for(var r in t){let i=t[r],n=i.subscriptions;i.reset(),e&&n&&Object.keys(n).forEach(e=>{let t=n[e];console.log("Calling unsubscribe for",r,":",e),t()})}}const _e="0.2.1";class me{static install(){}}me.install=function e(t,r){if(e.installed&&ce===t)return;if(e.installed=!0,console.log("[GENS] Installing Generic API plugin"),!r)throw new Error('heliosRX: Missing configuration. Did you supply config with Vue.use("heliosRx", {...})?');if(!r.db)throw new Error('heliosRX: Missing configuration "db".');if(!r.models)throw new Error('heliosRX: Missing configuration "models".');ce=t,p({Vue:t,models:r.models,db:r.db});let i,n=r.db;if(function({Vue:e,firebase:t}){se=(re=e).observable(se),g.configure({GenericModel:T,GenericList:P}),ne=t}({Vue:t,firebase:r.firebase||r.db.app.firebase_}),!n.app||!n.app.database)throw"object"==typeof n?new Error("heliosRX: Multi-DB configuration not implemented yet."):new Error("heliosRX: Invalid configuration for db.");if(oe.setDefaultDB(r.db),r.useExistingStore){const e=r.useExistingStore;throw e.registerModule("heliosrx",le("heliosRX")),p({Vuex:f,registry:e}),new Error("heliosRX: Custom state management not fully implemented.")}(t._installedPlugins||[]).forEach(e=>{e.Store&&e.mapActions&&console.warn("Existing Vuex detected. Consider using 'useExistingStore'. See heliosRX documentation.")}),t.use(f),i=new f.Store(le("heliosRX")),p({Vuex:f,registry:i}),i.commit("INIT_REGISTRY"),Object.defineProperty(t.prototype,"$models",{get:()=>r.models});let s={};r.userApi&&(s=r.userApi),Object.defineProperty(t.prototype,"$api",{get:()=>s});let o="false"===process.env.VUE_APP_PRODUCTION&&process.browser;(!0===r.devMode||void 0===r.devMode&&o)&&(window.$models=r.models,window.$db=r.db,window.$api=s,window.$registry=i)},me.getRegistry=y,me.GenericStore=oe,me.version="0.2.1";export default me;export{a as DeleteMode,oe as GenericStore,o as UIDMethod,y as getRegistry,i as moment,le as registryModule,fe as resetGenericStores,he as setDefaultDB,de as setDefaultUser,_e as version};