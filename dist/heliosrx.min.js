/**
 * heliosRX v0.2.2
 * (c) 2020 Thomas Weustenfeld
 * @license MIT
 */
/**
 * heliosRX v0.2.2
 * (c) 2020 Thomas Weustenfeld
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","vuex"],t):(e=e||self).heliosRX=t(e.Vue,e.Vuex)}(this,(function(e,t){"use strict";function r(e){return"[object String]"===Object.prototype.toString.call(e)}function n(e){return null!=e}function i(e){return"object"==typeof e&&null!==e}function o(e){return Array.isArray(e)}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var a,s={database:{ServerValue:{TIMESTAMP:{".sv":"timestamp"}}},firestore:{FieldValue:{serverTimestamp:function(){throw new Error("Not Implemented")}}}},c=require("moment-timezone/builds/moment-timezone-with-data-2012-2022.min.js"),u=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]};a=process.browser?window.localStorage:{getItem:function(){return"Europe/Berlin"},setItem:function(){}};var l=function(e,t){var r=e.clone().utc().format(),n=r.substring(0,r.length-1);return c.tz(n,t)};!function(){u("[EMO] set up"),u("[EMO] localStorage.getItem('timezone')",a.getItem("timezone")),a.getItem("timezone")||a.setItem("timezone",c.tz.guess());var e=a.getItem("timezone");u("[EMO] Setting user timezone to",e),c.tz.setDefault(e),c.user_timezone=e,function(e){u("[EMO] enhanceMomentJS"),e.isEnhanced=!0,e.prototype.isEnhanced=!0,e.fromFirestore=function(t){return t&&"object"==typeof t&&"Timestamp"===t.constructor.name?e(t.toDate()):e(t)},e.fromRealtimeDB=function(t){return e.unix(t)},e.fromRealtimeServerTime=function(t){return e(t)},e.fromStore=function(t){return e(t)},e.prototype.toFirestore=function(){return s.firestore.Timestamp.fromDate(this.toDate())},e.prototype.toRealtimeDB=function(){return this.unix()},e.prototype.toRealtimeServerTime=function(){return this.valueOf()},e.prototype.toBackend=function(e){return"REALTIMEDB"===e?this.toRealtimeDB():this.toFirestore()},e.prototype.toStore=function(){return this.format()},e.prototype.formatDateLong=function(){return this.format(this.user_dateformat)},e.prototype.isTimezoneNeutral=!1,e.fromDateAndTime=function(t,r){if(!r)throw new Error("Not implemented");var n=e.tz(t+"T"+r,e.user_timezone);return n.isTimezoneNeutral=!0,n},e.fromTimezoneNeutral=function(t){if(!e.isValidDate(t))return console.warn("[fromTimezoneNeutral] Invalid date",t),null;if(!t.isTimezoneNeutral)throw new Error("Input is not timezone neutral");return l(t,e.user_timezone)},e.prototype.changeTimezoneButKeepTime=function(e){return l(this,e)},e.isValidDate=function(t){return t&&e.isMoment(t)&&!!t.isEnhanced&&t.isValid()},e.currentTime=function(){if(!e.user_timezone)throw new Error("User timezone is not set");return e().tz(e.user_timezone)},e.currentTimeUTC=function(){return e().utc()},e.currentDate=function(){return e().tz(e.user_timezone).startOf("day")},e.currentDateISO=function(){e().tz(e.user_timezone).format("YYYY-MM-DD")},e.currentDateSleepCorrected=function(){return e().tz(e.user_timezone).subtract(3,"hours").startOf("day")},e.currentCalendarweek=function(){return e().tz(e.user_timezone).format("W")},e.currentTimeServer=function(e){return"REALTIMEDB"===e?s.database.ServerValue.TIMESTAMP:s.firestore.FieldValue.serverTimestamp()},e.convertHHmmToFractional=function(t){return(e(t,"HH:mm")-e().startOf("day"))/3600/1e3},e.convertFractionalToHHmm=function(t){return e.utc(3600*t*1e3).format("HH:mm")},e.parseTimeNatural=function(t,r){void 0===r&&(r=null);if(!(t=(t||"").trim()))return null;if("+"===t[0]||"-"===t[0]){var n="-"===t[0]?-1:1,i=t.slice(1);/[mhs]/i.test(i)||(i+="m");if(!null.match)return null;var o=n*null.duration;return e(r,"HH:mm").add(o,"seconds")}return"now"===t?e():e(t,["HH:mm","HH:mm A","HH A","HH"])},process.browser&&(window.moment=e)}(c)}();var d={CUSTOM:1,SLUGID:2,PUSHID:3,TIMESTAMP:4,LOCAL_TIMESTAMP:5,DATE:6,OTHER_USER_ID:7,MY_USER_ID:8,ARRAY:9,EMAIL:10},f={SOFT:0,HARD:1};function h(e,t,r){return e.replace(/\{.+?}/g,(function(e){return function(e,t,r){return void 0===r&&(r="{"+e+"}"),e.split(".").reduce((function(e,t){return e[t]||r}),t)}(e.substr(1,e.length-2).trim(),t,r)}))}function _(e){return(e.match(/\{.+?}/g)||[]).map((function(e){return e.slice(1,-1)}))}var p,v=e,m=t,y={};function g(e){e.Vue&&(v=e.Vue),e.Vuex&&(m=e.Vuex),e.Firebase&&e.Firebase,e.registry&&(p=e.registry),e.models&&(y=e.models),e.db&&e.db}var b={configure:function(e){var GenericList=e.GenericList,GenericModel=e.GenericModel;this.GenericList=GenericList,this.GenericModel=GenericModel},make_reactive_list:function(e,t,r,n){void 0===n&&(n=!1);var i=r.store.name,o=new this.GenericList(i);if(t){for(var a in t){var s=this.make_reactive_model(e,t[a],r);s.$id=a,s._update_data(t[a],e.schema.fields),o._add_child(a,s)}o.$readyAll=!0,o.$numReady=Object.keys(t).length}return e.listActions&&o.decorate_actions(e.listActions,r),!e.listGetters||n||e.no_reactive_getters||o.decorate_getters(e.listGetters,r.registry),v.observable(o),o},make_reactive_model:function(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var o=r.store.name,a=new this.GenericModel(null,null,o);return a._set_generic_store(r.store),e.schema&&e.schema.fields?a.autogenerate_props(e.schema.fields,t,n):console.warn("Making a reactive model without schema. This means props are not autogenerated and only accessible through model.$state. Please provide a schema for "+o+"."),t&&(a._update_data(t,e.schema.fields),a.$ready=!0),e.modelActions&&a.decorate_actions(e.modelActions,r),!e.modelGetters||i||e.no_reactive_getters||a.decorate_getters(e.modelGetters,r.registry),v.observable(a),a}},w="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function j(e,t){return e(t={exports:{}},t.exports),t.exports}var E=j((function(e,t){var r="[object Arguments]",n="[object Function]",i="[object GeneratorFunction]",o="[object Map]",a="[object Set]",s=/\w*$/,c=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,l={};l[r]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object DataView]"]=l["[object Boolean]"]=l["[object Date]"]=l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l[o]=l["[object Number]"]=l["[object Object]"]=l["[object RegExp]"]=l[a]=l["[object String]"]=l["[object Symbol]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Error]"]=l[n]=l["[object WeakMap]"]=!1;var d="object"==typeof w&&w&&w.Object===Object&&w,f="object"==typeof self&&self&&self.Object===Object&&self,h=d||f||Function("return this")(),_=t&&!t.nodeType&&t,p=_&&e&&!e.nodeType&&e,v=p&&p.exports===_;function m(e,t){return e.set(t[0],t[1]),e}function y(e,t){return e.add(t),e}function g(e,t,r,n){var i=-1,o=e?e.length:0;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function b(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function j(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function E(e,t){return function(r){return e(t(r))}}function A(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var O,S=Array.prototype,D=Function.prototype,R=Object.prototype,$=h["__core-js_shared__"],x=(O=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"",I=D.toString,T=R.hasOwnProperty,M=R.toString,N=RegExp("^"+I.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=v?h.Buffer:void 0,k=h.Symbol,U=h.Uint8Array,G=E(Object.getPrototypeOf,Object),z=Object.create,L=R.propertyIsEnumerable,V=S.splice,B=Object.getOwnPropertySymbols,F=P?P.isBuffer:void 0,C=E(Object.keys,Object),Y=ve(h,"DataView"),q=ve(h,"Map"),H=ve(h,"Promise"),W=ve(h,"Set"),X=ve(h,"WeakMap"),K=ve(Object,"create"),Q=we(Y),J=we(q),Z=we(H),ee=we(W),te=we(X),re=k?k.prototype:void 0,ne=re?re.valueOf:void 0;function ie(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ae(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function se(e){this.__data__=new oe(e)}function ce(e,t){var n=Ee(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Ae(e)}(e)&&T.call(e,"callee")&&(!L.call(e,"callee")||M.call(e)==r)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],i=n.length,o=!!i;for(var a in e)!t&&!T.call(e,a)||o&&("length"==a||ge(a,i))||n.push(a);return n}function ue(e,t,r){var n=e[t];T.call(e,t)&&je(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function le(e,t){for(var r=e.length;r--;)if(je(e[r][0],t))return r;return-1}function de(e,t,c,u,d,f,h){var _;if(u&&(_=f?u(e,d,f,h):u(e)),void 0!==_)return _;if(!De(e))return e;var p=Ee(e);if(p){if(_=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&T.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(e,_)}else{var v=ye(e),w=v==n||v==i;if(Oe(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if("[object Object]"==v||v==r||w&&!f){if(b(e))return f?e:{};if(_=function(e){return"function"!=typeof e.constructor||be(e)?{}:function(e){return De(e)?z(e):{}}(G(e))}(w?{}:e),!t)return function(e,t){return _e(e,me(e),t)}(e,function(e,t){return e&&_e(t,Re(t),e)}(_,e))}else{if(!l[v])return f?e:{};_=function(e,t,r,n){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return he(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var r=t?he(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var r=t?he(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case o:return function(e,t,r){return g(t?r(j(e),!0):j(e),m,new e.constructor)}(e,n,r);case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,s.exec(e));return t.lastIndex=e.lastIndex,t}(e);case a:return function(e,t,r){return g(t?r(A(e),!0):A(e),y,new e.constructor)}(e,n,r);case"[object Symbol]":return c=e,ne?Object(ne.call(c)):{}}var c}(e,v,de,t)}}h||(h=new se);var E=h.get(e);if(E)return E;if(h.set(e,_),!p)var O=c?function(e){return function(e,t,r){var n=t(e);return Ee(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Re,me)}(e):Re(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(O||e,(function(r,n){O&&(r=e[n=r]),ue(_,n,de(r,t,c,u,n,e,h))})),_}function fe(e){return!(!De(e)||(t=e,x&&x in t))&&(Se(e)||b(e)?N:c).test(we(e));var t}function he(e){var t=new e.constructor(e.byteLength);return new U(t).set(new U(e)),t}function _e(e,t,r,n){r||(r={});for(var i=-1,o=t.length;++i<o;){var a=t[i],s=n?n(r[a],e[a],a,r,e):void 0;ue(r,a,void 0===s?e[a]:s)}return r}function pe(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return fe(r)?r:void 0}ie.prototype.clear=function(){this.__data__=K?K(null):{}},ie.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},ie.prototype.get=function(e){var t=this.__data__;if(K){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return T.call(t,e)?t[e]:void 0},ie.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:T.call(t,e)},ie.prototype.set=function(e,t){return this.__data__[e]=K&&void 0===t?"__lodash_hash_undefined__":t,this},oe.prototype.clear=function(){this.__data__=[]},oe.prototype.delete=function(e){var t=this.__data__,r=le(t,e);return!(r<0)&&(r==t.length-1?t.pop():V.call(t,r,1),!0)},oe.prototype.get=function(e){var t=this.__data__,r=le(t,e);return r<0?void 0:t[r][1]},oe.prototype.has=function(e){return le(this.__data__,e)>-1},oe.prototype.set=function(e,t){var r=this.__data__,n=le(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},ae.prototype.clear=function(){this.__data__={hash:new ie,map:new(q||oe),string:new ie}},ae.prototype.delete=function(e){return pe(this,e).delete(e)},ae.prototype.get=function(e){return pe(this,e).get(e)},ae.prototype.has=function(e){return pe(this,e).has(e)},ae.prototype.set=function(e,t){return pe(this,e).set(e,t),this},se.prototype.clear=function(){this.__data__=new oe},se.prototype.delete=function(e){return this.__data__.delete(e)},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var r=this.__data__;if(r instanceof oe){var n=r.__data__;if(!q||n.length<199)return n.push([e,t]),this;r=this.__data__=new ae(n)}return r.set(e,t),this};var me=B?E(B,Object):function(){return[]},ye=function(e){return M.call(e)};function ge(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||u.test(e))&&e>-1&&e%1==0&&e<t}function be(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||R)}function we(e){if(null!=e){try{return I.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function je(e,t){return e===t||e!=e&&t!=t}(Y&&"[object DataView]"!=ye(new Y(new ArrayBuffer(1)))||q&&ye(new q)!=o||H&&"[object Promise]"!=ye(H.resolve())||W&&ye(new W)!=a||X&&"[object WeakMap]"!=ye(new X))&&(ye=function(e){var t=M.call(e),r="[object Object]"==t?e.constructor:void 0,n=r?we(r):void 0;if(n)switch(n){case Q:return"[object DataView]";case J:return o;case Z:return"[object Promise]";case ee:return a;case te:return"[object WeakMap]"}return t});var Ee=Array.isArray;function Ae(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!Se(e)}var Oe=F||function(){return!1};function Se(e){var t=De(e)?M.call(e):"";return t==n||t==i}function De(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Re(e){return Ae(e)?ce(e):function(e){if(!be(e))return C(e);var t=[];for(var r in Object(e))T.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return de(e,!0,!0)}}));function A(e,t,r){t.getters?console.warn("Name conflict: property getters already exists"):t.getters={};var n={},i=function(i){var o=r[i];n[i]=function(){return o.apply(t,e)},Object.defineProperty(t.getters,i,{get:function(){return a[i]},enumerable:!0})};for(var o in r)i(o);var a=new v({computed:n});return a}var O=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]};function S(e){return e&&"object"==typeof e&&!Array.isArray(e)}function D(e,t){return t.split(".").reduce((function(e,t){return e[t]||{}}),e)}function R(e,t){var r=(""+t).split("."),n=r.pop();return r.reduce((function(e,t){return e[t]||{}}),e)[n]}function $(e,t,r){void 0===r&&(r=!0);var n=r?Object.assign({},e):{};for(var i in t){var o=null,a=null;e&&(o=S(e[i])),t&&(a=S(t[i])),o&&a?$(e[i],t[i],r):v.set(e,i,t[i]),delete n[i]}for(var s in n)O("[GENS:DEEPMERGE] Deleting <",s,">"),v.delete(e,s);return n}function x(e,t,r){var n=(""+t).split("."),i=n.pop(),o=n.reduce((function(e,t){return t in e||v.set(e,t,{}),e[t]}),e);if(i in o){if(O("[GENS:INIT] Existing data found -> Performing deep merge at '",i,"' of target",o,"with source",r),".value"in r&&null===r[".value"])return O("[GENS:INIT] New data is null, deleting node at <",i,">"),void v.delete(o,i);$(o[i],r,!0)}else v.set(o,i,r);return o[i]}var I=new WeakMap,T=new WeakMap,M=["ServerTimestamp","CurrentTimestamp","InitialTimestamp"],GenericModel=function(e,t,r){this.$ready=!1,this.$promise=Promise.resolve(),this.$state={},this.$dirty={},this.$invalid={},this.$id=null,this.$idx=null,this.$noaccess=null,this._store_name=r,v.observable(this.$state)},N={$key:{configurable:!0},$vm:{configurable:!0},$model:{configurable:!0},$exists:{configurable:!0}};function P(e,t){return e.sortidx<t.sortidx?-1:e.sortidx>t.sortidx?1:0}function k(e){var t=null;return"-"===e[0]?(e=e.slice(1),t=function(t,r){return t[e]<r[e]?1:t[e]>r[e]?-1:0}):t=function(t,r){return t[e]<r[e]?-1:t[e]>r[e]?1:0},t}GenericModel.prototype._update_data=function(e,t,r){if(void 0===r&&(r=!1),this.$state=e,r)for(var n in e)this.$dirty[n]=!0},GenericModel.prototype.clone=function(){var e=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return e.$state=E(e.$state),e.$dirty=E(e.$dirty),e.$invalid=E(e.$invalid),e.autogenerate_props(this.$model.modelDefinition.schema.fields,e.$state,!1),e._set_generic_store(this.$model),I.set(e,this.$vm),e},GenericModel.prototype.setValidationBehaviour=function(e){["ERROR","WARNING","ELEMENT_VALIDATION","NONE"].includes(e)&&(this._validation_behaviour=e)},GenericModel.prototype._update_field=function(e,t,r){var n=this,i=this._validation_behaviour||"WARNING",o=r.is_nested?function(){return function(e,t,r){var n=(""+t).split("."),i=n.pop(),o=n.reduce((function(e,t){return t in e||v.set(e,t,{}),e[t]}),e);return v.set(o,i,r),o[i]}(n.$state,e,t)}:function(){return v.set(n.$state,e,t)};if(c.isMoment(t))return c.isValidDate(t)||console.warn("Got invalid e-moment object",t,"for prop",e),t=t.toRealtimeDB(),delete this.$invalid[e],this.$dirty[e]=!0,void o();if(!r.validator)return o(),void(this.$dirty[e]=!0);if(r.validator(t))delete this.$invalid[e],this.$dirty[e]=!0,o();else{if(this.$invalid[e]=!0,this.$dirty[e]=!0,o(),"ERROR"===i)throw new Error("Validation failed for field '"+e+"' with value "+t+".");"WARNING"===i&&console.warn("Validation failed for field '"+e+"' with value "+t+".")}},GenericModel.prototype._onRemove=function(){this.$deleted=!0},GenericModel.prototype.$isValid=function(){return 0===Object.keys(this.$invalid).length},N.$key.get=function(){return"KEY-"+this._store_name+"-"+this.$id},N.$vm.get=function(){return I.get(this)},N.$model.get=function(){return T.get(this)},N.$exists.get=function(){return!1!==this.$state[".exists"]},GenericModel.prototype.autogenerate_props=function(e,t,r){var n=this;void 0===r&&(r=!1),Array.isArray(e)||(e=Object.keys(e).map((function(t){return Object.assign({},{model:t},e[t])}))),e.forEach((function(e){var i=e.model;if(t&&i in t&&(n.$state[i]=t[i]),r&&(n.$dirty[i]=!0),Object.prototype.hasOwnProperty.call(n,i))console.warn('Name conflict: property "'+i+'" has same name as global action/global getter "'+i+'" in '+n._store_name);else{var o=function(){},a="";if(i.includes("/")||i.includes(".")){var s=(a=i.replace(/\//g,".")).split("."),u=s.pop();s=s.join("."),o=function(){return D(n.$state,s)[u]},e.is_nested=!0}else a=i,o=function(){return n.$state[i]},e.is_nested=!1;if(e.validate_bolt_type){var l=function(e,t,r,n){return 0===e||null===e?e:c.isMoment(e)?void console.error("Do not assign moment objects directly."):isFinite(e)&&e>r&&e<n?t(e):void 0===e?t():(console.warn("Schema defined",i,"as Timestamp, but got invalid data:",e),e)},d=o;"Timestamp"===e.validate_bolt_type?o=function(){return l(d(),c.fromRealtimeDB,2e8,3e10)}:M.includes(e.validate_bolt_type)?o=function(){return l(d(),c.fromRealtimeServerTime,2e11,3e13)}:e.validate_bolt_type.includes("Timestamp")&&console.warn("Found validation type that contains 'Timestamp' but is not recognized:",e.validate_bolt_type)}Object.defineProperty(n,a,{set:function(t){return n._update_field(a,t,e)},get:o})}}))},GenericModel.prototype.decorate_actions=function(e,t){var r=this;if(e){t.model=this;var n=function(n){var i=e[n];Object.prototype.hasOwnProperty.call(r,n)?console.warn('Name conflict: action "'+n+'" has same name as property/global action/global getter "'+n+'" in '+r._store_name):Object.defineProperty(r,n,{value:function(){return i(t)}})};for(var i in e)n(i)}},GenericModel.prototype.decorate_getters=function(e,t){if(e){for(var r in e)Object.prototype.hasOwnProperty.call(this,r)&&(console.warn('Name conflict: getter "'+r+'" has same name as property/custom action/global action/global getter "'+r+'" in '+this._store_name),delete e[r]);t.model=this;var n=A(t,this,e);I.set(this,n)}},GenericModel.prototype._set_generic_store=function(e){T.set(this,e)},GenericModel.prototype.write=function(){var e=this;console.log("Writing $dirty fields",JSON.stringify(this.$dirty));var t={};for(var r in this.$dirty){var n=void 0,i=void 0;r.includes(".")?(i=r.replace(/\./g,"/"),n=R(this.$state,r)):(i=r,n=this.$state[r]),void 0!==n?t[i]=n:console.warn("Trying to write undefined for prop",r)}var o=this.$model;if(!o)throw new Error("Model reference not set with _set_generic_store");var a=!0,s=this.$id;return s||(s=o._get_uid(),a=!1),o.modelDefinition&&o.modelDefinition.schema?o._validate_schema(t,a):console.warn("No schema found to validate input"),o.update(s,t).then((function(){return e.$id=s,e.$dirty={},s}))},GenericModel.prototype._get_model_for_write=function(){if(!this.$id)throw new Error("Write operations are not allowed for new models.");var e=this.$model;if(!e)throw new Error("Model reference not set with _set_generic_store");return e},GenericModel.prototype.update=function(e){var t=this;return this._get_model_for_write().update(this.$id,e).then((function(){for(var r in e)delete t.$dirty[r];return t.$id}))},GenericModel.prototype.remove=function(e){var t=this;return void 0===e&&(e=!0),this._get_model_for_write().remove(this.$id,e).then((function(){e&&delete t.$dirty.deleted}))},GenericModel.prototype.restore=function(){var e=this;return this._get_model_for_write().restore(this.$id).then((function(){delete e.$dirty.deleted}))},GenericModel.prototype.reset=function(){},Object.defineProperties(GenericModel.prototype,N);var U=new WeakMap,GenericList=function(e){this.items={},this.$readyAll=!1,this.$readySome=!1,this.$promise=Promise.resolve(),this.$numReady=0,this.$noaccess=null,this.$numChildren=0,this._store_name=e,this._unwatch=null},G={$vm:{configurable:!0},itemsSorted:{configurable:!0},$id_list:{configurable:!0}};function z(e){var t=e[e.length-1];return e.pop(),e=e.length>1?z(e):e[0],function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];var i=e.apply(void 0,r),o=t.apply(void 0,r);return Object.assign(i||{},o)}}GenericList.prototype._clone=function(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)},GenericList.prototype._add_child=function(e,t){this.$readySome=!0,this.$lastUpdate=Date.now(),v.set(this.items,e,t),this.$numChildren+=1,this.items[e].$idx=this.$numChildren},GenericList.prototype._rem_child=function(e){e in this.items&&this.items[e]._onRemove(),v.delete(this.items,e),this.$numChildren-=1},G.$vm.get=function(){return U.get(this)},GenericList.prototype.decorate_actions=function(e,t){var r=this;if(e){t.model=this;var n=function(n){var i=e[n];Object.prototype.hasOwnProperty.call(r,n)?console.warn('Name conflict: list action "'+n+'" has same name as existing method "'+n+'" in '+r._store_name):Object.defineProperty(r,n,{value:function(){return i(t)}})};for(var i in e)n(i)}},GenericList.prototype.decorate_getters=function(e,t){if(e){for(var r in e)Object.prototype.hasOwnProperty.call(this,r)&&(console.warn('Name conflict: list getter "'+r+'" has same name as existing property getter "'+r+'" in '+this._store_name),delete e[r]);t.model=this;var n=A(t,this,e);U.set(this,n)}},GenericList.prototype.getItemByIdx=function(e){for(var t in this.items)if(this.items[t].$idx===e)return this.items[t];return null},GenericList.prototype.asArraySorted=function(){var e=this._clone();return e.items=this.itemsAsArray(),e.items.sort(P),e},GenericList.prototype.asArraySortedBy=function(e){var t=this._clone();return t.items=this.itemsAsArray(),t.items.sort(k(e)),t},GenericList.prototype.asArrayFilteredBy=function(e,t){var r=this._clone();return r.items=this.itemsAsArray(),r.items=r.items.filter((function(r){return r[e]===t})),r},GenericList.prototype.itemsAsArray=function(){var e=this;return Array.isArray(this.items)?this.items:Object.keys(this.items).map((function(t){return e.items[t]}))},G.itemsSorted.get=function(){return this.itemsAsArray().sort(P)},GenericList.prototype.itemsAsArrayWithoutDeleted=function(e){return this.itemsAsArray().filter((function(e){return!1===e.deleted||void 0===e.deleted})).sort(e?k(e):P)},GenericList.prototype.itemsAsArrayOnlyDeleted=function(e){return this.itemsAsArray().filter((function(e){return!0===e.deleted})).sort(e?k(e):P)},G.$id_list.get=function(){return Object.keys(this.items)},GenericList.prototype.reset=function(){this._unwatch&&(console.log("Found local unwatcher in",this._store_name),this._unwatch())},Object.defineProperties(GenericList.prototype,G);function L(){var e,t,r=new Promise((function(r,n){e=r,t=n}));return r.resolve=e,r.reject=t,r}var V=Array.prototype;function B(e,t){return e.filter((function(e){return t.indexOf(e)<0}))}Object.defineProperty(V,"clone",{value:function(){return this.slice(0)},enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(V,"move",{value:function(e,t){this.splice(t,0,this.splice(e,1)[0])},enumerable:!1,configurable:!0,writable:!0});var F=function(){},C=F,Y=F,q=F,H=F,W=F,X=new Map,K=new Map;"false"===String(process.env.VUE_APP_PRODUCTION)&&(window.helioRxDev=window.helioRxDev||{},window.helioRxDev._resultInstanceCache=X,window.helioRxDev._resultListCache=K);var Q,J={read_mixin_init:function(){if(q(this.name),this.modelDefinition&&this.modelDefinition.staticGetters){var e=[y,p,this];this._vm=A(e,this,this.modelDefinition.staticGetters)}},_infer_local_path_from_ref:function(e){return e.path.toString().split("/").filter((function(e){return e})).join(".")},unsync:function(e,t){void 0===e&&(e=null),void 0===t&&(t={});var r=t.clean_up;void 0===r&&(r=!1),q(this.name);var n=null!==e?this.global_store_path_array[e]:this.global_store_path;if(n&&this._unbind_rtdb({key:n}),null!==e&&!(e in this.global_store_path_array)){if(this.isSuffixed)throw new Error("Unsync with id for data retrieved via subscribeList() is not supported.");n=this.global_store_path+"."+e}if(r){if(W(this.name),null!==e&&K.has(this.path))K.get(this.path)._rem_child(e);p.commit("heliosrx/UNSET_VALUE",{path:n},{root:!0})}},unsync_all:function(e){var t=this;void 0===e&&(e={});var r=e.clean_up;void 0===r&&(r=!1),q(this.name);var n=this.subscriptions;if(n){if(r&&K.has(this.path)){var i=K.get(this.path);i.$id_list.forEach((function(e){return i._rem_child(e)})),i.reset()}Object.keys(n).forEach((function(e){t._unbind_rtdb({key:e}),r&&p.commit("heliosrx/UNSET_VALUE",{path:e},{root:!0})}))}},fetch_individual:function(e,t){void 0===t&&(t={});var r=t.overwriteKey;void 0===r&&(r=!1);var n=t.customOps;return void 0===n&&(n={}),this.sync_individual(e,{overwriteKey:r,customOps:n,fetchOnce:!0})},fetch_list:function(e){void 0===e&&(e={});var t=e.overwriteKey;void 0===t&&(t=!1);var r=e.customOps;void 0===r&&(r={});var n=e.customRef;return void 0===n&&(n=null),this.sync_list({overwriteKey:t,customOps:r,customRef:n,fetchOnce:!0})},sync_individual:function(e,t){var r=this;void 0===t&&(t={});var n=t.overwriteKey;void 0===n&&(n=!1);var i=t.fetchOnce;void 0===i&&(i=!1);var o=t.customOps;void 0===o&&(o={}),this.isSuffixed;var a=this.childRef(e),s="res."+this._infer_local_path_from_ref(a);this.global_store_path_array[e]=s,Y(this.name,"sync_individual:",this.name),q(this.name,"[GENS] - sync ref",a.path.toString()),q(this.name),q(this.name,"[GENS] - sync target",this.global_store_path_array[e]);var c={init:function(){var t={};return q(r.name),p.commit("heliosrx/INIT_VALUE",{path:r.global_store_path_array[e],data:t},{root:!0}),{target:t}},set:function(e,t){q(r.name),p.commit("heliosrx/SET",{target:e,data:t},{root:!0})}};return i&&(c={init:function(){H(r.name);return{target:{}}},set:function(e,t){H(r.name)}}),Object.keys(o).forEach((function(e){c[e]=z([c[e],o[e]])})),i?this._fetch_rtdb({key:s,ref:a,ops:c,bindAsArray:!1}):this._bind_rtdb({key:s,ref:a,ops:c,bindAsArray:!1})},sync_list:function(e){var t=this;void 0===e&&(e={});var r=e.overwriteKey;void 0===r&&(r=!1);var n=e.fetchOnce;void 0===n&&(n=!1);var i=e.customOps;void 0===i&&(i={});var o=e.customRef;if(void 0===o&&(o=null),this.isSuffixed)throw new Error("Suffixed store does not support bind to array");var a=o||this.parentRef,s="res."+(r||this._infer_local_path_from_ref(a));Y(this.name,"sync:",this.name),q(this.name,"[GENS] - ref",this.parentRef),q(this.name),this.global_store_path=s;var c={root:!0},u={init:function(){q(t.name,"[OPS:INIT]",t.global_store_path,p.state);var e={},r=D(p.state,t.global_store_path);return Object.keys(r).length>0&&(q(t.name),e=r),q(t.name),p.commit("heliosrx/INIT_VALUE",{path:t.global_store_path,data:e},c),{target:e}},add:function(e,r,n){q(t.name),p.commit("heliosrx/ARRAY_ADD",{target:e,newId:r,data:n},c)},remove:function(e,r){var n=e[r],i=t._match_all_existing_synced_queries(t.path);for(var o in W(t.name),W(t.name,"entry_name",t.path),W(t.name),W(t.name),i){var a=i[o].query;if(t._itemMatchesQuery(a,n))return void W(t.name)}p.commit("heliosrx/ARRAY_REMOVE",{target:e,oldId:r},c)},set:function(e,r,n){q(t.name),p.commit("heliosrx/ARRAY_SET",{target:e,currentId:r,data:n},c)},once:function(e,t,r){}};return n&&(u={init:function(){H(t.name);return{target:{}}},once:function(e,r,n){H(t.name)}}),Object.keys(i).forEach((function(e){u[e]=z([u[e],i[e]])})),q(this.name),q(this.name),n?this._fetch_rtdb({key:s,ref:a,ops:u,bindAsArray:!0}):this._bind_rtdb({key:s,ref:a,ops:u,bindAsArray:!0})},_itemMatchesQuery:function(e,t){return console.log("[itemMatchesQuery]",e,t),!0},_create_context:function(){return{registry:p,store:this}},_match_all_existing_synced_queries:function(e,t){void 0===t&&(t=!0),e.includes("#")&&(e=e.split("#").shift());var r=[];for(var n in p.state.sync){var i=n.split("#").shift();if(e.startsWith(i)){var o=p.state.sync[n];if(!t||"Ready"!==o.status&&"Loading"!==o.status)continue;r.push(Object.assign({},{path:n,path_without_query:i},o))}}return r},_match_existing_synced_nodes:function(e,t){for(var r in void 0===t&&(t=!1),e.includes("#")&&(e=e.split("#").shift()),p.state.sync){var n=r;if(r.includes("#")){var i=r.split("#").shift();e.startsWith(i)&&console.warn("You're trying to sync a path that has already been synced by a query. This is not supported.","requested_path",e,"existing_path",r)}if(t&&r.includes("{id}")&&(r=r.replace("{id}","")),e.startsWith(r)&&("Ready"===p.state.sync[n].status||"Loading"===p.state.sync[n].status))return Y(this.name),n}return!1},_get_sync_state:function(e){return(p.state.sync[e]||{}).status||null},getList:function(e,t){void 0===t&&(t={});var r=t.noReactiveGetter;return void 0===r&&(r=!1),Y(this.name),this.subscribeList(e,{noSync:!0,createModelFromExistingCache:!0,noReactiveGetter:r})},getNode:function(e,t){void 0===t&&(t={});var r=t.noReactiveGetter;if(void 0===r&&(r=!1),Y(this.name),!e)throw new Error("getNode: got invalid id: "+e);return this.subscribeNode(e,{noSync:!0,createModelFromExistingCache:!0,noReactiveGetter:r})},subscribeList:function(e,t){var r=this;void 0===t&&(t={});var n=t.noSync;void 0===n&&(n=!1);var i=t.noReactiveGetter;void 0===i&&(i=!1);var o=t.createModelFromExistingCache;void 0===o&&(o=!1);var a=t.queryParams;void 0===a&&(a=null);var s=null,c="",u=this.path;if(a&&(s=this.buildQueryRef(a),c=this.queryHash(a),u=u+"#"+c,C(this.name)),Y(this.name),K.get(u))return Y(this.name),K.get(u);var l=p.getters.get_registry_entry(u);l&&Y(this.name);var d=this._match_existing_synced_nodes(u,!0);if(d){if(o){var f=this.getData();Y(this.name);var h=b.make_reactive_list(this.modelDefinition,f,this._create_context(),i);h.$promise=L();var _=this._get_sync_state(d);Y(this.name),"Ready"===_&&h.$promise.resolve(!0),W(this.name);var v=p.watch((function(e){return W(r.name),r.getData(null,!0)}),(function(e,t){if(W(r.name),null==e)return h.$id_list.forEach((function(e){W(r.name),h._rem_child(e)})),h.$numReady=!1,h.$readyAll=!1,h.$readySome=!1,void h.$promise.resolve(!0);var n=Object.keys(e),o=t?Object.keys(t):[],a=h.$id_list;n.toString()===o.toString()&&W(r.name);var s,c,l={removed:B(c=a,s=n),added:B(s,c)};W(r.name),l.removed.forEach((function(e){W(r.name),h._rem_child(e),h.$numReady--})),l.added.forEach((function(e){W(r.name);var t=u.split("#").shift().replace(/\{id\}/g,e);X.has(t)&&console.warn("A new item was added, but there already exists a model instance in the cache for this item. This means the subscription management failed.");var n=r.getData(e),o=b.make_reactive_model(r.modelDefinition,n,r._create_context(),!1,i);o.$id=e,h._add_child(e,o),h.$numReady++,X.set(t,o)})),h.$promise.resolve(!0)}));return h._unwatch=v,K.set(u,h),h}console.warn("You're trying to sync data, that is already synced by a node higher up in the hierarchy. This will result in undefined behaviour. Try using getList() or getNode() instead! Sync path:",u)}if(this._match_existing_synced_nodes(u)===u)throw console.log(">>>",u,K,X),new Error("Exact path found, but no cache hit. This should never happen");if(n)return Y(this.name),console.warn("You're trying to fetch data at "+u+" that has not been synced yet."),null;C(this.name),l={query:a,status:"Loading"},p.commit("ADD_ENTRY",{name:u,data:l});var m=b.make_reactive_list(this.modelDefinition,null,this._create_context());K.set(u,m),m.$promise=L(),Y(this.name);var y={add:function(e,t,n){p.commit("SET_ENTRY_STATUS",{name:u,value:"Ready"}),Y(r.name,"subscribeList:add - Child ready",r.name);var o=u.split("#").shift().replace(/\{id\}/g,t);X.has(o)&&Y(r.name),t in m.items&&console.warn("An existing item was added twice. This means the subscription management failed.");var a=X.has(o)?X.get(o):b.make_reactive_model(r.modelDefinition,n,r._create_context(),!1,i);a.$id=t,m._add_child(t,a),X.has(o)?a._update_data(n):X.set(o,a)},init:function(){return Y(r.name),{}},remove:function(e,t){W(r.name),m._rem_child(t)},set:function(e,t,n){if(Y(r.name),K.get(u)&&t in K.get(u).items){var i=K.get(u).items[t],o=r.getData(t);i._update_data(o,r.modelDefinition.schema.fields),Y(r.name)}else Y(r.name,"subscribeList:set - WARNING - not found in cache!",t,K.get(u))}};return this.sync_list({customOps:y,customRef:s}).then((function(){m.$readyAll=!0,m.$promise.resolve(!0)})).catch((function(e){if("PERMISSION_DENIED"!==e.code)throw e;console.warn(e.message),console.log("======================================"),console.log("PERMISSION_DENIED ["+r.name+".subscribeList()]"),console.log("queryParams:",a),console.log("======================================"),m.$readyAll=!0,m.$readySome=!0,m.$noaccess=!0,m.$promise.reject(e)})),m},subscribeNode:function(e,t){var r=this;void 0===t&&(t={});var n=t.noSync;void 0===n&&(n=!1);var i=t.noReactiveGetter;void 0===i&&(i=!1);var o=t.createModelFromExistingCache;if(void 0===o&&(o=!1),!e)throw new Error("subscribeNode: got invalid id: ");var a=this._previewPath(e),s=this.path;if(Y(this.name),K.get(s)&&e in K.get(s).items)return Y(this.name),K.get(s).items[e];if(X.has(a))return Y(this.name),X.get(a);if(this._match_existing_synced_nodes(s)&&C(this.name,"======================================= (FIXME)",{entry_name_child:a},{entry_name_list:s},{"has:node":X.has(a)},{"get:list":X.get(s)}),this._match_existing_synced_nodes(a)){if(o){var c=this.getData(e);Y(this.name);var u=b.make_reactive_model(this.modelDefinition,c,this._create_context(),!1,i);return u.$id=e,u.$ready=!0,X.set(a,u),Y(this.name),u}console.warn("You're trying to sync data, that is already synced by a node higher up in the hierarchy. This will result in undefined behaviour. Try using getNode() instead! Sync path:",a)}if(this._match_existing_synced_nodes(a)===a)throw console.log(">>>",a,K,X),new Error("Exact path found, but no cache hit. This should never happen");if(n)return null;C(this.name);var l=b.make_reactive_model(this.modelDefinition,null,this._create_context(),!1,i);l.$id=e,l.$promise=L(),X.set(a,l);var d={id:e,status:"Loading"};p.commit("ADD_ENTRY",{name:a,data:d}),Y(this.name);var f={init:function(e){return Y(r.name),{}},set:function(e,t){Y(r.name)}};return this.sync_individual(e,{customOps:f}).then((function(t){var n=r.getData(e);Y(r.name),void 0!==n?(l._update_data(n,r.modelDefinition.schema.fields),l.$ready=!0,l.$noaccess=!1,p.commit("SET_ENTRY_STATUS",{name:a,value:"Ready"}),Y(r.name),l.$promise.resolve(!0)):console.warn(r.name,"subscribeNode - subscribeList took over, while waiting for sync_individual. subscribeList will handle instance now.")})).catch((function(t){if("PERMISSION_DENIED"!==t.code)throw t;console.warn(t.message),console.log("======================================"),console.log("PERMISSION_DENIED ["+r.name+".subscribeNode( "+e+" )]"),console.log("======================================"),p.commit("SET_ENTRY_STATUS",{name:a,value:"NoAccess"});var n=r.getData(e);n[".noaccess"]=!0,l._update_data(n,r.modelDefinition.schema.fields),l.$ready=!0,l.$noaccess=!0,l.$promise.reject(t)})),l},buildQueryRef:function(e){var t=e.key;void 0===t&&(t=void 0);var r=e.value;void 0===r&&(r=void 0);var n=e.limit;void 0===n&&(n=void 0);var i=e.startAt;void 0===i&&(i=void 0);var o=e.endAt;void 0===o&&(o=void 0);var a=this.parentRef;return a="*"===t?a.orderByValue():void 0===t?a.orderByKey():a.orderByChild(t),void 0!==r&&(a=a.equalTo(r)),void 0!==i&&(a=a.startAt(i)),void 0!==o&&(a=a.endAt(o)),void 0!==n&&(a=n>0?a.limitToFirst(n):a.limitToLast(-n)),a},queryHash:function(e){var t=[e.key,e.value,e.limit,e.startAt,e.endAt].join("_");return t},subscribeQuery:function(e,t){return void 0===t&&(t={}),this.subscribeList(null,Object.assign({},t,{queryParams:e}))},fetchNode:function(e,t){var r=this;void 0===t&&(t={});var n=t.noReactiveGetter;void 0===n&&(n=!1);var i=b.make_reactive_model(this.modelDefinition,null,this._create_context(),!1,n);i.$id=e,i.$promise=L();var o={init:function(){return H(r.name),{}},set:function(e,t){H(r.name)}};return this.fetch_individual(e,{customOps:o}).then((function(e){H(r.name),i._update_data(e,r.modelDefinition.schema.fields),i.$ready=!0,i.$promise.resolve(!0)})),i},fetchList:function(e){var t=this;void 0===e&&(e={});var r=e.noReactiveGetter;void 0===r&&(r=!1);var n=e.queryParams;void 0===n&&(n=null);var i=n?this.buildQueryRef(n):null,o=b.make_reactive_list(this.modelDefinition,null,this._create_context(),r);o.$promise=L();var a={init:function(){return H(t.name),{}},once:function(e,r,n){H(t.name)}};return this.fetch_list({customOps:a,customRef:i}).then((function(e){H(t.name),Object.keys(e||[]).forEach((function(n){var i=e[n],a=b.make_reactive_model(t.modelDefinition,i,t._create_context(),!1,r);a.$id=n,o._add_child(n,a),o.$numReady++})),o.$readyAll=!0,o.$promise.resolve(!0)})),o},fetchQuery:function(e,t){return this.fetchList(Object.assign({},t,{queryParams:e}))},getRegistryState:function(){return p.state},getAllSyncedPaths:function(){var e={};return Object.keys(p.state.sync).forEach((function(t){e[t]=p.state.sync[t].status})),e},getData:function(e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var r="";if(this.isSuffixed||e){if(!e)throw new Error("getData: id required for suffixed stores");r=this.path.replace(/\{id\}/g,e)}else r=this.path.split("{id}").shift();var n="res."+r.split("/").filter((function(e){return e})).join(".");return p.state.initialized?t?D(p.state,n):function(e,t){return t.split(".").reduce((function(e,t){return e[t]}),e)}(p.state,n):null},reset_global_instance_cache:function(){try{X.forEach((function(e){e.reset()})),K.forEach((function(e){e.reset()}))}catch(e){console.warn("Reseting instances failed",e)}X.clear(),K.clear()}},Z=j((function(e,t){var r="[object Arguments]",n="[object Map]",i="[object Object]",o="[object Set]",a=/^\[object .+?Constructor\]$/,s=/^(?:0|[1-9]\d*)$/,c={};c["[object Float32Array]"]=c["[object Float64Array]"]=c["[object Int8Array]"]=c["[object Int16Array]"]=c["[object Int32Array]"]=c["[object Uint8Array]"]=c["[object Uint8ClampedArray]"]=c["[object Uint16Array]"]=c["[object Uint32Array]"]=!0,c[r]=c["[object Array]"]=c["[object ArrayBuffer]"]=c["[object Boolean]"]=c["[object DataView]"]=c["[object Date]"]=c["[object Error]"]=c["[object Function]"]=c[n]=c["[object Number]"]=c[i]=c["[object RegExp]"]=c[o]=c["[object String]"]=c["[object WeakMap]"]=!1;var u="object"==typeof w&&w&&w.Object===Object&&w,l="object"==typeof self&&self&&self.Object===Object&&self,d=u||l||Function("return this")(),f=t&&!t.nodeType&&t,h=f&&e&&!e.nodeType&&e,_=h&&h.exports===f,p=_&&u.process,v=function(){try{return p&&p.binding&&p.binding("util")}catch(e){}}(),m=v&&v.isTypedArray;function y(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function g(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function b(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var j,E,A,O=Array.prototype,S=Function.prototype,D=Object.prototype,R=d["__core-js_shared__"],$=S.toString,x=D.hasOwnProperty,I=(j=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"",T=D.toString,M=RegExp("^"+$.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=_?d.Buffer:void 0,P=d.Symbol,k=d.Uint8Array,U=D.propertyIsEnumerable,G=O.splice,z=P?P.toStringTag:void 0,L=Object.getOwnPropertySymbols,V=N?N.isBuffer:void 0,B=(E=Object.keys,A=Object,function(e){return E(A(e))}),F=me(d,"DataView"),C=me(d,"Map"),Y=me(d,"Promise"),q=me(d,"Set"),H=me(d,"WeakMap"),W=me(Object,"create"),X=we(F),K=we(C),Q=we(Y),J=we(q),Z=we(H),ee=P?P.prototype:void 0,te=ee?ee.valueOf:void 0;function re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ne(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oe(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ie;++t<r;)this.add(e[t])}function ae(e){var t=this.__data__=new ne(e);this.size=t.size}function se(e,t){var r=Ae(e),n=!r&&Ee(e),i=!r&&!n&&Oe(e),o=!r&&!n&&!i&&xe(e),a=r||n||i||o,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=s.length;for(var u in e)!t&&!x.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||be(u,c))||s.push(u);return s}function ce(e,t){for(var r=e.length;r--;)if(je(e[r][0],t))return r;return-1}function ue(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":z&&z in Object(e)?function(e){var t=x.call(e,z),r=e[z];try{e[z]=void 0;var n=!0}catch(e){}var i=T.call(e);n&&(t?e[z]=r:delete e[z]);return i}(e):function(e){return T.call(e)}(e)}function le(e){return $e(e)&&ue(e)==r}function de(e,t,a,s,c){return e===t||(null==e||null==t||!$e(e)&&!$e(t)?e!=e&&t!=t:function(e,t,a,s,c,u){var l=Ae(e),d=Ae(t),f=l?"[object Array]":ge(e),h=d?"[object Array]":ge(t),_=(f=f==r?i:f)==i,p=(h=h==r?i:h)==i,v=f==h;if(v&&Oe(e)){if(!Oe(t))return!1;l=!0,_=!1}if(v&&!_)return u||(u=new ae),l||xe(e)?_e(e,t,a,s,c,u):function(e,t,r,i,a,s,c){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new k(e),new k(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return je(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case n:var u=g;case o:var l=1&i;if(u||(u=b),e.size!=t.size&&!l)return!1;var d=c.get(e);if(d)return d==t;i|=2,c.set(e,t);var f=_e(u(e),u(t),i,a,s,c);return c.delete(e),f;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,f,a,s,c,u);if(!(1&a)){var m=_&&x.call(e,"__wrapped__"),y=p&&x.call(t,"__wrapped__");if(m||y){var w=m?e.value():e,j=y?t.value():t;return u||(u=new ae),c(w,j,a,s,u)}}if(!v)return!1;return u||(u=new ae),function(e,t,r,n,i,o){var a=1&r,s=pe(e),c=s.length,u=pe(t).length;if(c!=u&&!a)return!1;var l=c;for(;l--;){var d=s[l];if(!(a?d in t:x.call(t,d)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var h=!0;o.set(e,t),o.set(t,e);var _=a;for(;++l<c;){d=s[l];var p=e[d],v=t[d];if(n)var m=a?n(v,p,d,t,e,o):n(p,v,d,e,t,o);if(!(void 0===m?p===v||i(p,v,r,n,o):m)){h=!1;break}_||(_="constructor"==d)}if(h&&!_){var y=e.constructor,g=t.constructor;y!=g&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g)&&(h=!1)}return o.delete(e),o.delete(t),h}(e,t,a,s,c,u)}(e,t,a,s,de,c))}function fe(e){return!(!Re(e)||function(e){return!!I&&I in e}(e))&&(Se(e)?M:a).test(we(e))}function he(e){if(!function(e){var t=e&&e.constructor,r="function"==typeof t&&t.prototype||D;return e===r}(e))return B(e);var t=[];for(var r in Object(e))x.call(e,r)&&"constructor"!=r&&t.push(r);return t}function _e(e,t,r,n,i,o){var a=1&r,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,d=!0,f=2&r?new oe:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var h=e[l],_=t[l];if(n)var p=a?n(_,h,l,t,e,o):n(h,_,l,e,t,o);if(void 0!==p){if(p)continue;d=!1;break}if(f){if(!y(t,(function(e,t){if(a=t,!f.has(a)&&(h===e||i(h,e,r,n,o)))return f.push(t);var a}))){d=!1;break}}else if(h!==_&&!i(h,_,r,n,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function pe(e){return function(e,t,r){var n=t(e);return Ae(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Ie,ye)}function ve(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function me(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return fe(r)?r:void 0}re.prototype.clear=function(){this.__data__=W?W(null):{},this.size=0},re.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},re.prototype.get=function(e){var t=this.__data__;if(W){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return x.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return W?void 0!==t[e]:x.call(t,e)},re.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=W&&void 0===t?"__lodash_hash_undefined__":t,this},ne.prototype.clear=function(){this.__data__=[],this.size=0},ne.prototype.delete=function(e){var t=this.__data__,r=ce(t,e);return!(r<0)&&(r==t.length-1?t.pop():G.call(t,r,1),--this.size,!0)},ne.prototype.get=function(e){var t=this.__data__,r=ce(t,e);return r<0?void 0:t[r][1]},ne.prototype.has=function(e){return ce(this.__data__,e)>-1},ne.prototype.set=function(e,t){var r=this.__data__,n=ce(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},ie.prototype.clear=function(){this.size=0,this.__data__={hash:new re,map:new(C||ne),string:new re}},ie.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},ie.prototype.get=function(e){return ve(this,e).get(e)},ie.prototype.has=function(e){return ve(this,e).has(e)},ie.prototype.set=function(e,t){var r=ve(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},oe.prototype.add=oe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},oe.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.clear=function(){this.__data__=new ne,this.size=0},ae.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ae.prototype.get=function(e){return this.__data__.get(e)},ae.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ne){var n=r.__data__;if(!C||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ie(n)}return r.set(e,t),this.size=r.size,this};var ye=L?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}(L(e),(function(t){return U.call(e,t)})))}:function(){return[]},ge=ue;function be(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||s.test(e))&&e>-1&&e%1==0&&e<t}function we(e){if(null!=e){try{return $.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function je(e,t){return e===t||e!=e&&t!=t}(F&&"[object DataView]"!=ge(new F(new ArrayBuffer(1)))||C&&ge(new C)!=n||Y&&"[object Promise]"!=ge(Y.resolve())||q&&ge(new q)!=o||H&&"[object WeakMap]"!=ge(new H))&&(ge=function(e){var t=ue(e),r=t==i?e.constructor:void 0,a=r?we(r):"";if(a)switch(a){case X:return"[object DataView]";case K:return n;case Q:return"[object Promise]";case J:return o;case Z:return"[object WeakMap]"}return t});var Ee=le(function(){return arguments}())?le:function(e){return $e(e)&&x.call(e,"callee")&&!U.call(e,"callee")},Ae=Array.isArray;var Oe=V||function(){return!1};function Se(e){if(!Re(e))return!1;var t=ue(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function De(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Re(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function $e(e){return null!=e&&"object"==typeof e}var xe=m?function(e){return function(t){return e(t)}}(m):function(e){return $e(e)&&De(e.length)&&!!c[ue(e)]};function Ie(e){return null!=(t=e)&&De(t.length)&&!Se(t)?se(e):he(e);var t}e.exports=function(e,t){return de(e,t)}})),ee=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)},te={write_mixin_init:function(e){(void 0===e&&(e=!1),this.modelDefinition)&&(this.modelDefinition.staticActions&&function(e,t,r,n){var i=function(i){var o=r[i];if(n&&delete t[i],Object.prototype.hasOwnProperty.call(t,i)){var a=e.$store.name;console.warn('Name conflict: action "'+i+'" has same name as another property "'+i+'" in '+a)}else Object.defineProperty(t,i,{value:function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return o.apply(t,[e].concat(r))},enumerable:!0})};for(var o in r)i(o)}({$store:this,$models:y,$registry:p},this,this.modelDefinition.staticActions,e))},add:function(e,t,r){var n,i=null;if(t||(t=this._get_uid()),!t[".sv"]&&!this._validateId(t))throw new Error("Got invalid id:"+t);var o=!0;return r&&r.directWrite&&(o=!1),this.modelDefinition?(o?this.modelDefinition.schema&&this.modelDefinition.schema.create?(this._check_required_create_arg(e),i=this.modelDefinition.schema.create(e,e,"REALTIMEDB")):(console.warn("No create function found in type definition, using overwrite data as payload."),i=e):i=e,this.modelDefinition.schema?this._validate_schema(i,!1):console.warn("No schema found to validate input")):(console.warn("No type definition found, using UNVALIDATED overwrite data as payload."),i=e),this._convert_moment_objects(i),ee("[GENS] Creating at",this._previewPath(t),"with payload",i),this.isSuffixed?this.childRef(t).update(i).then((function(){return t})):this.parentRef.update((n={},n[t]=i,n)).then((function(){return t}))},update:function(e,t){if(!e||!t)throw new Error("Either id or data is missing.");if(!this._validateId(e)){if(!(this.modelDefinition.schema||{}).unsafe_disable_validation)throw new Error("Got invalid id in update");console.warn("Got invalid id <"+e+">, but validation is disabled.")}this.modelDefinition.schema?this._validate_schema(t,!0):console.warn("No schema found to validate input");var r=t;return this._convert_moment_objects(r),ee("[GENS] Updating at",this._previewPath(e),"with payload",r),this.childRef(e).update(r)},reorder:function(e,t){var r=this;if(void 0===t&&(t={}),this.isSuffixed)throw new Error("Suffixed store does not support reorder");var n=t.overwriteSortIdxKey||"sortidx";if(e.length>0&&"object"!=typeof e[0]){var i=0;e=e.map((function(e){return{id:e,sortidx:i+=100}}))}var o={};e.forEach((function(e){var t,i=e.sortidx;if(e.id=e.id||e.$id,"number"!=typeof i&&(i=parseFloat(i)),isNaN(i))throw new Error("Got invalid sortidx",i);if(!r._validateId(e.id))throw new Error("Got invalid id",e.id);o[e.id]=((t={})[n]=i,t)}));var a={};return Object.keys(o).forEach((function(e){var t=o[e];Object.keys(t).forEach((function(n){a[r._previewPath(e)+"/"+n]=t[n]}))})),ee("[GENS] update at",this._previewPath(),"with payload",a),this.rootRef.update(a)},remove:function(e,t){var r=this;if(t=void 0===t?this.defaultDeleteMode===f.SOFT:t,Array.isArray(e)){var n={};return e.forEach((function(e){if(!r._validateId(e))throw new Error("Got invalid id in remove");t?n[e+"/deleted"]=!0:n[e]=null})),ee("[GENS] batch deleting at",this.path,"with payload",n),this.parentRef.update(n)}if(!this._validateId(e))throw new Error("Got invalid id in remove");return t?(ee("[GENS] soft deleting at",this.path,"with",{deleted:!0}),this.update(e,{deleted:!0})):(ee("[GENS] hard deleting at",this.path),this.childRef(e).remove())},restore:function(e){return this.update(e,{deleted:!1})},copy:function(e,t,r){return this.move(e,t,r,{keepOriginal:!0,keepId:!1})},move:function(e,t,r,n){var i=this;void 0===n&&(n={});var o=n.keepOriginal;void 0===o&&(o=!1);var a=n.keepId;if(void 0===a&&(a=!0),this.isSuffixed)throw new Error("Suffixed store does not support move");if(!this._validateId(e))throw new Error("Got invalid id in remove");var s=Object.keys(t).sort(),c=Object.keys(r).sort();if(!Z(s,c))throw new Error("Context A and context B do not have equal keys");var u=Object.assign({},this.definedProps,t,{id:e}),l=Object.assign({},this.definedProps,r,{id:e});a||(l.id=this._get_uid());var d=this.templatePath.replace(/\*/,"{id}"),f=h(d,u),p=h(d,l),v=_(f);if(v.length>0)throw new Error("Not all template id's are defined. Required fields are "+v.join(", "));return this._db.ref(f).once("value").then((function(e){return e.val()})).then((function(e){var t={};return t[f]=null,t[p]=e,o&&((t={})[p]=e),ee("[GENS] moving data from ",f,"to",p,"with payload",t),i.rootRef.update(t).then((function(){return l.id}))}))},transaction:function(e,t,r,n){var i;if(void 0===n&&(n=1),!this._validateId(e))throw new Error("Got invalid id in remove");var o=this.childRef(e);if(t&&(this._validate_schema(((i={})[t]=1,i)),o=o.ref.child(t)),"string"==typeof r)switch(r){case"inc":r=function(e){return(e||0)+n};break;case"dec":r=function(e){return(e||0)-n}}if("function"!=typeof r)throw new Error("Transacton must be a function");return ee("[GENS] tranaction on ",o.path.toString()),o.transaction(r).then((function(e){return e.committed?(console.log("[GENS] Transacton successfully committed"),!0):(console.log("[GENS] Transacton aborted"),!1)}))},new:function(){return b.make_reactive_model(this.modelDefinition,null,this._create_context(),!1)},new_from_template:function(e,t){void 0===e&&(e={}),void 0===t&&(t=null);var r=this.empty(e,t),n=b.make_reactive_model(this.modelDefinition,e,this._create_context(),!1);return n._update_data(r,null,!0),n},new_from_data:function(e,t){return void 0===e&&(e={}),b.make_reactive_model(this.modelDefinition,e,this._create_context(),!1)},empty:function(e,t){if(void 0===e&&(e={}),void 0===t&&(t=null),!this.modelDefinition)return null;if(!this.modelDefinition.schema||!this.modelDefinition.schema.create)return null;this._check_required_create_arg(e);var r=this.modelDefinition.schema.create(e,t||e,"REALTIMEDB");return this.modelDefinition.schema?this._validate_schema(r,!1):console.warn("No schema found to validate input"),r},_convert_moment_objects:function(e){if("object"!=typeof e)throw console.log("Got payload",e,typeof e),new Error("Expected object, got "+e);for(var t in e)if(c.isMoment(e[t])){if(!e[t].toRealtimeDB)throw new Error("Moment object passed to add/update must be enhanced moment objects.");e[t]=e[t].toRealtimeDB()}else Array.isArray(e[t])?this._convert_moment_objects(e[t]):"object"==typeof e[t]&&this._convert_moment_objects(e[t])}},re=require("slugid"),ne=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)},ie=new WeakMap,oe=null,ae=null,se={userId:null};var ce,GenericStore=function(e,t,r){if(void 0===r&&(r={}),t&&(t.abstract_store||r.isAbstract))this.isAbstract=!0,this.templatePath=e,this.modelDefinition=t,this.definedProps={},this.name="unnamed abstract";else{if(this.isAbstract=!1,this.name="unnamed",!e||e.length<2)throw new Error("Invalid template path:"+e);if("/"!==e[0])throw new Error("Template path has to start with /, got: "+e);if(1!==(e.match(/\*/g)||[]).length)throw new Error("Template path must contain exactly one *, got:"+e);this.isSuffixed=e.indexOf("*")!==e.length-1,"function"==typeof r.uidMethod?(this.uidMethod=d.CUSTOM,this.uidMethodCallback=r.uidMethod):this.uidMethod=r.uidMethod||d.PUSHID,this.additionalProps=r.additionalProps||[],this.defaultDeleteMode="defaultDeleteMode"in r?r.defaultDeleteMode:f.HARD}this.enableTypeValidation=!("enableTypeValidation"in r)||r.enableTypeValidation,this.isReadonly=r.isReadonly,this.templatePath=e,this.modelDefinition=t,this.definedProps={},this._localDB=null,this._clones=[],this.global_store_path_array=[],this.isSuffixed||(this.global_store_path=""),this.isAbstract?(Object.assign(this,{read_mixin_init:J.read_mixin_init,write_mixin_init:te.write_mixin_init}),this.read_mixin_init(),this.write_mixin_init()):(Object.assign(this,J),this.read_mixin_init(),this.isReadonly||(Object.assign(this,te),this.write_mixin_init()))},ue={_db:{configurable:!0},defaultUserId:{configurable:!0},path:{configurable:!0},parentRef:{configurable:!0},rootRef:{configurable:!0},_template_path_field_names:{configurable:!0},_schema_fields:{configurable:!0},schema_required_fields:{configurable:!0},schema_optional_fields:{configurable:!0},schema_all_fields:{configurable:!0},subscriptions:{configurable:!0},rules:{configurable:!0}},le={defaultUserId:{configurable:!0}};GenericStore.prototype._clone=function(){var e=Object.getPrototypeOf(this),t=Object.create(e),r=Object.assign(t,this);return delete r.getters,delete r._vm,r.read_mixin_init(),this.isReadonly||r.write_mixin_init(!0),r._clones=[],this._clones.push(r),r},GenericStore.prototype.setName=function(e){this.name=e},GenericStore.prototype.generateId=function(){return this._get_uid()},GenericStore.prototype._get_uid=function(){switch(this.uidMethod){case d.SLUGID:return re.nice();case d.PUSHID:return this.rootRef.push().key;case d.TIMESTAMP:return ae.database.ServerValue.TIMESTAMP;case d.LOCAL_TIMESTAMP:return c.currentTime().unix();case d.DATE:return c.currentDate().format("DD-MM-YYYY");case d.OTHER_USER_ID:throw new Error("Please provide id through id override");case d.MY_USER_ID:if(!GenericStore.defaultUserId)throw new Error("User ID is not set, but a store uses USER_ID as key");return GenericStore.defaultUserId;case d.ARRAY:return 0;case d.EMAIL:throw new Error("Only email addresses allowed as key");case d.CUSTOM:var e=this.uidMethodCallback(this.definedProps);if(!e)throw new Error("An ID was not defined. Check custom UID Callback.");return e;default:throw new Error("Unknown UID Method: "+this.uidMethod)}},GenericStore.setDefaultDB=function(e){oe=e},ue._db.get=function(){return this._localDB||oe},GenericStore.prototype._validateId=function(e){return!(this.uidMethod===d.SLUGID&&!function(e){return r(e)&&e.length&&e.length>=20}(e))&&!(-1===e||!e)},GenericStore.prototype._defineUser=function(){GenericStore.defaultUserId&&(this.definedProps.uid=GenericStore.defaultUserId)},le.defaultUserId.get=function(){return se.userId},ue.defaultUserId.get=function(){return se.userId},le.defaultUserId.set=function(e){ne("[GENS] settings default user id to: uid =",e),Q.set(se,"userId",e)},GenericStore.resetState=function(){ne("[GENS] reset state"),Q.set(se,"userId",null)},ue.path.get=function(){"uid"in this.definedProps||this._defineUser();var e=h(this.templatePath,this.definedProps),t=_(e);if(t.length>0)throw new Error("Not all template id's are defined. Required fields are "+t.join(", "));return e.replace(/\*/g,"{id}")},GenericStore.prototype._previewPath=function(e){"uid"in this.definedProps||this._defineUser();var t=h(this.templatePath,this.definedProps);return t=e?t.replace(/\*/g,e):t.replace(/\*/,"{id}")},GenericStore.prototype.childRef=function(e){return this._db.ref(this.path.replace(/\{id\}/g,e))},ue.parentRef.get=function(){return this._db.ref(this.path.split("{id}").shift())},ue.rootRef.get=function(){return this._db.ref()},GenericStore.prototype._define=function(e,t){e.definedProps=Object.assign({},this.definedProps,t);var r=[].concat(this._template_path_field_names,this.additionalProps);for(var n in t)r.includes(n)||console.warn("Prop",n,"not found in template path. Known fields are",r);return e},GenericStore.prototype.define=function(e){return this._define(this,e)},GenericStore.prototype.with=function(e){var t=this._clone();return this._define(t,e)},ue._template_path_field_names.get=function(){return _(this.templatePath)},GenericStore.prototype.reset=function(e){void 0===e&&(e=1),1===e&&function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]}("[GENS] resetting",this.name,"with",this._clones.length,"clones"),this.definedProps={},e>3?console.warn("[GENS] RESET - Stop at recursion level 3",this._clones):this._clones.forEach((function(t){t.reset(e+1)}))},ue._schema_fields.get=function(){var e=((this.modelDefinition||{}).schema||{}).fields;return void 0===e?[]:(Array.isArray(e)||(e=Object.keys(e).map((function(t){return Object.assign({},{model:t},e[t])}))),e)},ue.schema_required_fields.get=function(){return this._schema_fields.filter((function(e){return e.required})).map((function(e){return e.model}))},ue.schema_optional_fields.get=function(){return this._schema_fields.filter((function(e){return!e.required})).map((function(e){return e.model}))},ue.schema_all_fields.get=function(){return this._schema_fields.map((function(e){return e.model}))},GenericStore.prototype._check_required_fields=function(e){this.schema_required_fields.forEach((function(t){if(!(t in e))throw new Error("Required field <"+t+"> not present.")}))},GenericStore.prototype._check_required_create_arg=function(e){(((this.modelDefinition||{}).schema||{}).create_required||[]).forEach((function(t){if(!(t in e))throw new Error("Required create argument <"+t+"> not present.")}))},GenericStore.prototype._validate_schema=function(e,t){var r=this;if(!(this.modelDefinition&&this.modelDefinition.schema&&this.modelDefinition.schema.unsafe_disable_validation)){var n=this._schema_fields;if(!(n&&n.length>=0))throw new Error('No schema found for "'+this.name+'", please provide one.');t||this._check_required_fields(e);var i=/Map\s*<(?<key>\w+),\s*(?<val>\w+)>/i,o=/(?<val>\w+)\s*\[\]/,a=this.schema_all_fields,s=[],c={};0===n.length?console.warn('Schema for "'+this.name+'" is empty.'):(c=Object.assign.apply(Object,a.map((function(e,t){var n;return e.startsWith("/")&&e.endsWith("/")&&s.push(e),(n={})[e]=r._schema_fields[t],n}))),Object.keys(c).forEach((function(e,t){var n=c[e].validate_bolt_type||"";if(i.test(n)){var o="/^"+e+"\\/((?![\\/\\[\\]\\.\\#\\$\\/\\u0000-\\u001F\\u007F]).)*$/";s.push(o),c[o]=r._schema_fields[t]}}))),Object.keys(e).forEach((function(t){var n=s.find((function(e){var r=e.includes("\\u00")?"":"u";return new RegExp(e.substring(1,e.length-1),r).test(t)}));if(!n&&!a.includes(t))throw new Error("Field <"+t+"> is not allowed by schema.");var u=c[n||t];if(u.validator){var l=u.validator(e[t],u,null);if(!l||l.length&&0===l.length)throw new Error('User-defined schema validation failed for key "'+t+'" with error: '+l)}if(r.enableTypeValidation&&!(u.validate_bolt_type||"").split("|").some((function(n){var a=n.trim(),s={};return o.test(a)&&(s=o.exec(a).groups,a="Array"),i.test(a)&&(s=i.exec(a).groups,a="Map"),r._validate_bolt_type(e[t],a,s)})))throw new Error('Type-based schema validation failed for key "'+t+'" with error.')}))}},GenericStore.prototype._validate_bolt_type=function(e,t,a){var s,c,u=this;switch(void 0===a&&(a={}),t.toLowerCase()){case"string":return r(e);case"number":return c=e,!isNaN(parseFloat(c))&&isFinite(c);case"boolean":return!0===(s=e)||!1===s;case"object":return n(e)&&i(e)&&!o(e);case"any":return n(e);case"null":return null===e;case"map":return i(e)&&!o(e)&&Object.entries(e).every((function(e){var t=e[0],n=e[1],i=r(t),o=u._validate_bolt_type(n,a.val);return i&&o}));case"array":var l=[];if(o(e))l=e;else{if(!i(e))return!1;l=Object.values(e)}return l.every((function(e){return u._validate_bolt_type(e,a.val)}));default:return console.warn("Can not validate type '"+t+"'"),!0}},ue.subscriptions.get=function(){return ie.get(this)},GenericStore.prototype._bind_rtdb=function(e){var t=e.key,r=e.ref,n=e.ops,i=e.bindAsArray,o=ie.get(this);return o||(o=Object.create(null),ie.set(this,o)),t in o&&this._unbind_rtdb(t),new Promise((function(e,a){o[t]=i?function(e){var t=e.collection,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target;t.once("value",(function(e){r.once(o,e.val(),e.exists()),n()}),(function(e){e&&i(e)}));var a=t.on("child_added",(function(e,t){r.add(o,e.key,e.val())}),i),s=t.on("child_removed",(function(e){r.remove(o,e.key)}),i),c=t.on("child_changed",(function(e){r.set(o,e.key,e.val())}),i),u=t.on("child_moved",(function(e,t){}),i);return function(){t.off("child_added",a),t.off("child_changed",c),t.off("child_removed",s),t.off("child_moved",u)}}({key:t,collection:r,ops:n,resolve:e,reject:a}):function(e){var t=e.document,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target,a=t.on("value",(function(e){var t=e.val();e.exists()||(t={".exists":!1}),r.set(o,t),n(t)}),(function(e){e&&i(e)}));return function(){t.off("value",a)}}({key:t,document:r,ops:n,resolve:e,reject:a})}))},GenericStore.prototype._fetch_rtdb=function(e){var t=e.key,r=e.ref,n=e.ops,i=e.bindAsArray;return new Promise((function(e,o){i?function(e){var t=e.collection,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target;t.once("value",(function(e){var t=e.val();r.once(o,t,e.exists()),n(t)}),(function(e){e&&i(e)}))}({key:t,collection:r,ops:n,resolve:e,reject:o}):function(e){var t=e.document,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target;t.once("value",(function(e){var t=e.val();e.exists()||(t={".exists":!1}),r.set(o,t),n(t)}),(function(e){e&&i(e)}))}({key:t,document:r,ops:n,resolve:e,reject:o})}))},GenericStore.prototype._unbind_rtdb=function(e){var t=e.key,r=ie.get(this);r&&r[t]&&(r[t](),delete r[t])},ue.rules.get=function(){var e=this.modelDefinition.schema.fields;Array.isArray(e)||(e=Object.keys(e).map((function(t){return Object.assign({},{model:t},e[t])})));var t={};return e.forEach((function(e){t[e.model]=[{validator:function(t,r,n){e.validator(r)?n():n(new Error("Invalid input"))},trigger:"blur"}]})),t},Object.defineProperties(GenericStore.prototype,ue),Object.defineProperties(GenericStore,le);var de,fe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]},he=((ce={})["heliosrx/INIT_VALUE"]=function(e,t){var r=t.path,n=t.data;return fe("[HELIOSRX_INIT_VALUE]",{path:r,data:n}),x(e,r,n)},ce["heliosrx/UNSET_VALUE"]=function(e,t){var r=t.path;return fe("[HELIOSRX_UNSET_VALUE]",{path:r}),x(e,r,{".value":null})},ce["heliosrx/ARRAY_ADD"]=function(e,t){var r=t.target,n=t.newId,i=t.data;fe("[HELIOSRX_ARRAY_ADD]",{target:r,newId:n,data:i}),v.set(r,n,i)},ce["heliosrx/ARRAY_REMOVE"]=function(e,t){var r=t.target,n=t.oldId;fe("[HELIOSRX_ARRAY_REMOVE]",{target:r,oldId:n}),v.delete(r,n)},ce["heliosrx/ARRAY_SET"]=function(e,t){var r=t.target,n=t.currentId,i=t.data,o=t.performMerge;void 0===o&&(o=!1),r[n]?$(r[n],i,!o):r[n]=i},ce["heliosrx/SET"]=function(e,t){var r=t.target,n=t.data,i=t.performMerge;void 0===i&&(i=!1),fe("[HELIOSRX_SET]",{target:r,data:n,performMerge:i}),$(r,n,!i)},ce),_e={strict:!0,state:{initialized:!1,res:{},sync:{},ready:{}},getters:{get_registry_entry:function(e){return function(t){return e.sync[t]}},is_ready:function(e){return function(t){return e.ready[t]||!1}}},mutations:Object.assign({},he,{INIT_REGISTRY:function(e){e.initialized=!0},RESET_REGISTRY:function(e){v.set(e,"sync",{}),v.set(e,"res",{}),v.set(e,"ready",{}),e.initialized=!1},ADD_ENTRY:function(e,t){var r=t.name,n=t.data;e.sync[r]&&e.sync[r]===n||v.set(e.sync,r,n)},SET_ENTRY_STATUS:function(e,t){var r=t.name,n=t.value;e.sync[r][status]&&e.sync[r][status]===n||v.set(e.sync[r],"status",n)},SET_GLOBAL_READY_STATE:function(e,t){var r=t.name,n=t.value;e.ready[r]&&e.ready[r]===!!n||v.set(e.ready,r,!!n)},REM_GLOBAL_READY_STATE:function(e,t){var r=t.name;v.delete(e.ready,r)}})};function pe(e){return _e.name=e,_e.namespaced=!0,_e}var ve=function(){};var heliosRX=function(){};return heliosRX.install=function(){},heliosRX.version="0.2.2",heliosRX.install=function e(t,r){if(!e.installed||de!==t){if(e.installed=!0,console.log("[GENS] Installing Generic API plugin"),!r)throw new Error('heliosRX: Missing configuration. Did you supply config with Vue.use("heliosRx", {...})?');if(!r.db)throw new Error('heliosRX: Missing configuration "db".');if(!r.models)throw new Error('heliosRX: Missing configuration "models".');de=t,g({Vue:t,models:r.models,db:r.db});var n,i=r.db;if(function(e){var t=e.Vue,r=e.firebase;se=(Q=t).observable(se),b.configure({GenericModel:GenericModel,GenericList:GenericList}),ae=r}({Vue:t,firebase:r.firebase||r.db.app.firebase_}),!i.app||!i.app.database)throw"object"==typeof i?new Error("heliosRX: Multi-DB configuration not implemented yet."):new Error("heliosRX: Invalid configuration for db.");if(GenericStore.setDefaultDB(r.db),r.useExistingStore){var o=r.useExistingStore;throw o.registerModule("heliosrx",pe("heliosRX")),g({Vuex:m,registry:o}),new Error("heliosRX: Custom state management not fully implemented.")}(t._installedPlugins||[]).forEach((function(e){e.Store&&e.mapActions&&console.warn("Existing Vuex detected. Consider using 'useExistingStore'. See heliosRX documentation.")})),t.use(m),n=new m.Store(pe("heliosRX")),g({Vuex:m,registry:n}),n.commit("INIT_REGISTRY"),Object.defineProperty(t.prototype,"$models",{get:function(){return r.models}});var a={};r.userApi&&(a=r.userApi),Object.defineProperty(t.prototype,"$api",{get:function(){return a}});var s="false"===process.env.VUE_APP_PRODUCTION&&process.browser;(!0===r.devMode||void 0===r.devMode&&s)&&(window.$models=r.models,window.$db=r.db,window.$api=a,window.$registry=n)}},heliosRX.getRegistry=function(){return p},heliosRX.registryModule=pe,heliosRX.moment=c,heliosRX.GenericStore=GenericStore,heliosRX.UIDMethod=d,heliosRX.DeleteMode=f,heliosRX.setDefaultDB=function(e){GenericStore.setDefaultDB(e)},heliosRX.setDefaultUser=function(e){if(null!==GenericStore.defaultUserId)throw new Error("Call resetGenericStores before setting the default user id");GenericStore.defaultUserId=e},heliosRX.resetGenericStores=function(e){void 0===e&&(e=!0),GenericStore.resetState();var t=ve(),r=function(r){var n=t[r],i=n.subscriptions;n.reset(),e&&i&&Object.keys(i).forEach((function(e){var t=i[e];console.log("Calling unsubscribe for",r,":",e),t()}))};for(var n in t)r(n)},heliosRX}));