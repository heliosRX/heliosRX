/**
 * heliosRX v0.2.1
 * (c) 2020 Thomas Weustenfeld
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue"),require("vuex")):"function"==typeof define&&define.amd?define(["vue","vuex"],t):(e=e||self).heliosRX=t(e.Vue,e.Vuex)}(this,function(e,t){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var r,n={database:{ServerValue:{TIMESTAMP:{".sv":"timestamp"}}},firestore:{FieldValue:{serverTimestamp:function(){throw new Error("Not Implemented")}}}},i=require("moment-timezone/builds/moment-timezone-with-data-2012-2022.min.js"),o=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]};r=process.browser?window.localStorage:{getItem:function(){return"Europe/Berlin"},setItem:function(){}};var a=function(e,t){var r=e.clone().utc().format(),n=r.substring(0,r.length-1);return i.tz(n,t)};!function(){o("[EMO] set up"),o("[EMO] localStorage.getItem('timezone')",r.getItem("timezone")),r.getItem("timezone")||r.setItem("timezone",i.tz.guess());var e=r.getItem("timezone");o("[EMO] Setting user timezone to",e),i.tz.setDefault(e),i.user_timezone=e,function(e){o("[EMO] enhanceMomentJS"),e.isEnhanced=!0,e.prototype.isEnhanced=!0,e.fromFirestore=function(t){return t&&"object"==typeof t&&"Timestamp"===t.constructor.name?e(t.toDate()):e(t)},e.fromRealtimeDB=function(t){return e.unix(t)},e.fromRealtimeServerTime=function(t){return e(t)},e.fromStore=function(t){return e(t)},e.prototype.toFirestore=function(){return n.firestore.Timestamp.fromDate(this.toDate())},e.prototype.toRealtimeDB=function(){return this.unix()},e.prototype.toRealtimeServerTime=function(){return this.valueOf()},e.prototype.toBackend=function(e){return"REALTIMEDB"===e?this.toRealtimeDB():this.toFirestore()},e.prototype.toStore=function(){return this.format()},e.prototype.formatDateLong=function(){return this.format(this.user_dateformat)},e.prototype.isTimezoneNeutral=!1,e.fromDateAndTime=function(t,r){if(!r)throw new Error("Not implemented");var n=e.tz(t+"T"+r,e.user_timezone);return n.isTimezoneNeutral=!0,n},e.fromTimezoneNeutral=function(t){if(!e.isValidDate(t))return console.warn("[fromTimezoneNeutral] Invalid date",t),null;if(!t.isTimezoneNeutral)throw new Error("Input is not timezone neutral");return a(t,e.user_timezone)},e.prototype.changeTimezoneButKeepTime=function(e){return a(this,e)},e.isValidDate=function(t){return t&&e.isMoment(t)&&!!t.isEnhanced&&t.isValid()},e.currentTime=function(){if(!e.user_timezone)throw new Error("User timezone is not set");return e().tz(e.user_timezone)},e.currentTimeUTC=function(){return e().utc()},e.currentDate=function(){return e().tz(e.user_timezone).startOf("day")},e.currentDateISO=function(){e().tz(e.user_timezone).format("YYYY-MM-DD")},e.currentDateSleepCorrected=function(){return e().tz(e.user_timezone).subtract(3,"hours").startOf("day")},e.currentCalendarweek=function(){return e().tz(e.user_timezone).format("W")},e.currentTimeServer=function(e){return"REALTIMEDB"===e?n.database.ServerValue.TIMESTAMP:n.firestore.FieldValue.serverTimestamp()},e.convertHHmmToFractional=function(t){return(e(t,"HH:mm")-e().startOf("day"))/3600/1e3},e.convertFractionalToHHmm=function(t){return e.utc(3600*t*1e3).format("HH:mm")},e.parseTimeNatural=function(t,r){if(void 0===r&&(r=null),!(t=(t||"").trim()))return null;if("+"===t[0]||"-"===t[0]){var n="-"===t[0]?-1:1,i=t.slice(1);if(/[mhs]/i.test(i)||(i+="m"),!null.match)return null;var o=n*null.duration;return e(r,"HH:mm").add(o,"seconds")}return"now"===t?e():e(t,["HH:mm","HH:mm A","HH A","HH"])},process.browser&&(window.moment=e)}(i)}();var s={CUSTOM:1,SLUGID:2,PUSHID:3,TIMESTAMP:4,LOCAL_TIMESTAMP:5,DATE:6,OTHER_USER_ID:7,MY_USER_ID:8,ARRAY:9,EMAIL:10},c={SOFT:0,HARD:1};function u(e,t,r){return e.replace(/\{.+?}/g,function(e){return function(e,t,r){return void 0===r&&(r="{"+e+"}"),e.split(".").reduce(function(e,t){return e[t]||r},t)}(e.substr(1,e.length-2).trim(),t,r)})}function l(e){return(e.match(/\{.+?}/g)||[]).map(function(e){return e.slice(1,-1)})}var d,f=e,h=t,_={};function m(e){e.Vue&&(f=e.Vue),e.Vuex&&(h=e.Vuex),e.Firebase&&e.Firebase,e.registry&&(d=e.registry),e.models&&(_=e.models),e.db&&e.db}var p={configure:function(e){var t=e.GenericList,r=e.GenericModel;this.GenericList=t,this.GenericModel=r},make_reactive_list:function(e,t,r,n){void 0===n&&(n=!1);var i=r.store.name,o=new this.GenericList(i);if(t){for(var a in t){var s=this.make_reactive_model(e,t[a],r);s.$id=a,s._update_data(t[a],e.schema.fields),o._add_child(a,s)}o.$readyAll=!0,o.$numReady=Object.keys(t).length}return e.listActions&&o.decorate_actions(e.listActions,r),!e.listGetters||n||e.no_reactive_getters||o.decorate_getters(e.listGetters,r.registry),f.observable(o),o},make_reactive_model:function(e,t,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var o=r.store.name,a=new this.GenericModel(null,null,o);return a._set_generic_store(r.store),e.schema&&e.schema.fields?a.autogenerate_props(e.schema.fields,t,n):console.warn("Making a reactive model without schema. This means props are not autogenerated and only accessible through model.$state. Please provide a schema for "+o+"."),t&&(a._update_data(t,e.schema.fields),a.$ready=!0),e.modelActions&&a.decorate_actions(e.modelActions,r),!e.modelGetters||i||e.no_reactive_getters||a.decorate_getters(e.modelGetters,r.registry),f.observable(a),a}},v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function y(e,t){return e(t={exports:{}},t.exports),t.exports}var g=y(function(e,t){var r=200,n="__lodash_hash_undefined__",i=9007199254740991,o="[object Arguments]",a="[object Boolean]",s="[object Date]",c="[object Function]",u="[object GeneratorFunction]",l="[object Map]",d="[object Number]",f="[object Object]",h="[object RegExp]",_="[object Set]",m="[object String]",p="[object Symbol]",y="[object ArrayBuffer]",g="[object DataView]",b="[object Float32Array]",w="[object Float64Array]",E="[object Int8Array]",j="[object Int16Array]",A="[object Int32Array]",O="[object Uint8Array]",S="[object Uint8ClampedArray]",R="[object Uint16Array]",D="[object Uint32Array]",$=/\w*$/,I=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,T={};T[o]=T["[object Array]"]=T[y]=T[g]=T[a]=T[s]=T[b]=T[w]=T[E]=T[j]=T[A]=T[l]=T[d]=T[f]=T[h]=T[_]=T[m]=T[p]=T[O]=T[S]=T[R]=T[D]=!0,T["[object Error]"]=T[c]=T["[object WeakMap]"]=!1;var M="object"==typeof v&&v&&v.Object===Object&&v,P="object"==typeof self&&self&&self.Object===Object&&self,N=M||P||Function("return this")(),k=t&&!t.nodeType&&t,G=k&&e&&!e.nodeType&&e,U=G&&G.exports===k;function z(e,t){return e.set(t[0],t[1]),e}function L(e,t){return e.add(t),e}function V(e,t,r,n){var i=-1,o=e?e.length:0;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function B(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function C(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function Y(e,t){return function(r){return e(t(r))}}function q(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var F,H=Array.prototype,W=Function.prototype,X=Object.prototype,K=N["__core-js_shared__"],Q=(F=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"",J=W.toString,Z=X.hasOwnProperty,ee=X.toString,te=RegExp("^"+J.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),re=U?N.Buffer:void 0,ne=N.Symbol,ie=N.Uint8Array,oe=Y(Object.getPrototypeOf,Object),ae=Object.create,se=X.propertyIsEnumerable,ce=H.splice,ue=Object.getOwnPropertySymbols,le=re?re.isBuffer:void 0,de=Y(Object.keys,Object),fe=Ge(N,"DataView"),he=Ge(N,"Map"),_e=Ge(N,"Promise"),me=Ge(N,"Set"),pe=Ge(N,"WeakMap"),ve=Ge(Object,"create"),ye=Be(fe),ge=Be(he),be=Be(_e),we=Be(me),Ee=Be(pe),je=ne?ne.prototype:void 0,Ae=je?je.valueOf:void 0;function Oe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Se(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Re(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function De(e){this.__data__=new Se(e)}function $e(e,t){var r=Ye(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&qe(e)}(e)&&Z.call(e,"callee")&&(!se.call(e,"callee")||ee.call(e)==o)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var a in e)!t&&!Z.call(e,a)||i&&("length"==a||Le(a,n))||r.push(a);return r}function Ie(e,t,r){var n=e[t];Z.call(e,t)&&Ce(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function xe(e,t){for(var r=e.length;r--;)if(Ce(e[r][0],t))return r;return-1}function Te(e,t,r,n,i,v,I){var x;if(n&&(x=v?n(e,i,v,I):n(e)),void 0!==x)return x;if(!We(e))return e;var M=Ye(e);if(M){if(x=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&Z.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(e,x)}else{var P=ze(e),N=P==c||P==u;if(Fe(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(P==f||P==o||N&&!v){if(B(e))return v?e:{};if(x=function(e){return"function"!=typeof e.constructor||Ve(e)?{}:(t=oe(e),We(t)?ae(t):{});var t}(N?{}:e),!t)return function(e,t){return Ne(e,Ue(e),t)}(e,function(e,t){return e&&Ne(t,Xe(t),e)}(x,e))}else{if(!T[P])return v?e:{};x=function(e,t,r,n){var i=e.constructor;switch(t){case y:return Pe(e);case a:case s:return new i(+e);case g:return function(e,t){var r=t?Pe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case b:case w:case E:case j:case A:case O:case S:case R:case D:return function(e,t){var r=t?Pe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case l:return function(e,t,r){return V(t?r(C(e),!0):C(e),z,new e.constructor)}(e,n,r);case d:case m:return new i(e);case h:return(u=new(c=e).constructor(c.source,$.exec(c))).lastIndex=c.lastIndex,u;case _:return function(e,t,r){return V(t?r(q(e),!0):q(e),L,new e.constructor)}(e,n,r);case p:return o=e,Ae?Object(Ae.call(o)):{}}var o;var c,u}(e,P,Te,t)}}I||(I=new De);var k=I.get(e);if(k)return k;if(I.set(e,x),!M)var G=r?function(e){return function(e,t,r){var n=t(e);return Ye(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Xe,Ue)}(e):Xe(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(G||e,function(i,o){G&&(i=e[o=i]),Ie(x,o,Te(i,t,r,n,o,e,I))}),x}function Me(e){return!(!We(e)||(t=e,Q&&Q in t))&&(He(e)||B(e)?te:I).test(Be(e));var t}function Pe(e){var t=new e.constructor(e.byteLength);return new ie(t).set(new ie(e)),t}function Ne(e,t,r,n){r||(r={});for(var i=-1,o=t.length;++i<o;){var a=t[i],s=n?n(r[a],e[a],a,r,e):void 0;Ie(r,a,void 0===s?e[a]:s)}return r}function ke(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Ge(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Me(r)?r:void 0}Oe.prototype.clear=function(){this.__data__=ve?ve(null):{}},Oe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Oe.prototype.get=function(e){var t=this.__data__;if(ve){var r=t[e];return r===n?void 0:r}return Z.call(t,e)?t[e]:void 0},Oe.prototype.has=function(e){var t=this.__data__;return ve?void 0!==t[e]:Z.call(t,e)},Oe.prototype.set=function(e,t){return this.__data__[e]=ve&&void 0===t?n:t,this},Se.prototype.clear=function(){this.__data__=[]},Se.prototype.delete=function(e){var t=this.__data__,r=xe(t,e);return!(r<0||(r==t.length-1?t.pop():ce.call(t,r,1),0))},Se.prototype.get=function(e){var t=this.__data__,r=xe(t,e);return r<0?void 0:t[r][1]},Se.prototype.has=function(e){return xe(this.__data__,e)>-1},Se.prototype.set=function(e,t){var r=this.__data__,n=xe(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Re.prototype.clear=function(){this.__data__={hash:new Oe,map:new(he||Se),string:new Oe}},Re.prototype.delete=function(e){return ke(this,e).delete(e)},Re.prototype.get=function(e){return ke(this,e).get(e)},Re.prototype.has=function(e){return ke(this,e).has(e)},Re.prototype.set=function(e,t){return ke(this,e).set(e,t),this},De.prototype.clear=function(){this.__data__=new Se},De.prototype.delete=function(e){return this.__data__.delete(e)},De.prototype.get=function(e){return this.__data__.get(e)},De.prototype.has=function(e){return this.__data__.has(e)},De.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Se){var i=n.__data__;if(!he||i.length<r-1)return i.push([e,t]),this;n=this.__data__=new Re(i)}return n.set(e,t),this};var Ue=ue?Y(ue,Object):function(){return[]},ze=function(e){return ee.call(e)};function Le(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||x.test(e))&&e>-1&&e%1==0&&e<t}function Ve(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||X)}function Be(e){if(null!=e){try{return J.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ce(e,t){return e===t||e!=e&&t!=t}(fe&&ze(new fe(new ArrayBuffer(1)))!=g||he&&ze(new he)!=l||_e&&"[object Promise]"!=ze(_e.resolve())||me&&ze(new me)!=_||pe&&"[object WeakMap]"!=ze(new pe))&&(ze=function(e){var t=ee.call(e),r=t==f?e.constructor:void 0,n=r?Be(r):void 0;if(n)switch(n){case ye:return g;case ge:return l;case be:return"[object Promise]";case we:return _;case Ee:return"[object WeakMap]"}return t});var Ye=Array.isArray;function qe(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(e.length)&&!He(e)}var Fe=le||function(){return!1};function He(e){var t=We(e)?ee.call(e):"";return t==c||t==u}function We(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Xe(e){return qe(e)?$e(e):function(e){if(!Ve(e))return de(e);var t=[];for(var r in Object(e))Z.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return Te(e,!0,!0)}});function b(e,t,r){t.getters?console.warn("Name conflict: property getters already exists"):t.getters={};var n={},i=function(i){var o=r[i];n[i]=function(){return o.apply(t,e)},Object.defineProperty(t.getters,i,{get:function(){return a[i]},enumerable:!0})};for(var o in r)i(o);var a=new f({computed:n});return a}var w=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]};function E(e){return e&&"object"==typeof e&&!Array.isArray(e)}function j(e,t){return t.split(".").reduce(function(e,t){return e[t]||{}},e)}function A(e,t,r){void 0===r&&(r=!0);var n=r?Object.assign({},e):{};for(var i in t){var o=null,a=null;e&&(o=E(e[i])),t&&(a=E(t[i])),o&&a?A(e[i],t[i],r):f.set(e,i,t[i]),delete n[i]}for(var s in n)w("[GENS:DEEPMERGE] Deleting <",s,">"),f.delete(e,s);return n}function O(e,t,r){var n=(""+t).split("."),i=n.pop(),o=n.reduce(function(e,t){return t in e||f.set(e,t,{}),e[t]},e);if(i in o){if(w("[GENS:INIT] Existing data found -> Performing deep merge at '",i,"' of target",o,"with source",r),".value"in r&&null===r[".value"])return w("[GENS:INIT] New data is null, deleting node at <",i,">"),void f.delete(o,i);A(o[i],r,!0)}else f.set(o,i,r);return o[i]}var S=new WeakMap,R=new WeakMap,D=["ServerTimestamp","CurrentTimestamp","InitialTimestamp"],$=function(e,t,r){this.$ready=!1,this.$promise=Promise.resolve(),this.$state={},this.$dirty={},this.$invalid={},this.$id=null,this.$idx=null,this.$noaccess=null,this._store_name=r,f.observable(this.$state)},I={$key:{configurable:!0},$vm:{configurable:!0},$model:{configurable:!0}};function x(e,t){return e.sortidx<t.sortidx?-1:e.sortidx>t.sortidx?1:0}function T(e){var t=null;return"-"===e[0]?(e=e.slice(1),t=function(t,r){return t[e]<r[e]?1:t[e]>r[e]?-1:0}):t=function(t,r){return t[e]<r[e]?-1:t[e]>r[e]?1:0},t}$.prototype._update_data=function(e,t,r){if(void 0===r&&(r=!1),this.$state=e,r)for(var n in e)this.$dirty[n]=!0},$.prototype.clone=function(){var e=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return e.$state=g(e.$state),e.$dirty=g(e.$dirty),e.$invalid=g(e.$invalid),e.autogenerate_props(this.$model.modelDefinition.schema.fields,e.$state,!1),e._set_generic_store(this.$model),S.set(e,this.$vm),e},$.prototype.setValidationBehaviour=function(e){["ERROR","WARNING","ELEMENT_VALIDATION","NONE"].includes(e)&&(this._validation_behaviour=e)},$.prototype._update_field=function(e,t,r){var n=this,o=this._validation_behaviour||"WARNING",a=r.is_nested?function(){return r=n.$state,i=t,o=(""+e).split("."),a=o.pop(),s=o.reduce(function(e,t){return t in e||f.set(e,t,{}),e[t]},r),f.set(s,a,i),s[a];var r,i,o,a,s}:function(){return f.set(n.$state,e,t)};if(i.isMoment(t))return i.isValidDate(t)||console.warn("Got invalid e-moment object",t,"for prop",e),t=t.toRealtimeDB(),delete this.$invalid[e],this.$dirty[e]=!0,void a();if(!r.validate)return a(),void(this.$dirty[e]=!0);if(r.validate(t))delete this.$invalid[e],this.$dirty[e]=!0,a();else{if(this.$invalid[e]=!0,this.$dirty[e]=!0,a(),"ERROR"===o)throw new Error("Validation failed for field '"+e+"' with value "+t+".");"WARNING"===o&&console.warn("Validation failed for field '"+e+"' with value "+t+".")}},$.prototype._onRemove=function(){this.$deleted=!0},$.prototype.$isValid=function(){return 0===Object.keys(this.$invalid).length},I.$key.get=function(){return"KEY-"+this._store_name+"-"+this.$id},I.$vm.get=function(){return S.get(this)},I.$model.get=function(){return R.get(this)},$.prototype.autogenerate_props=function(e,t,r){var n=this;void 0===r&&(r=!1),Array.isArray(e)||(e=Object.keys(e).map(function(t){return Object.assign({},{model:t},e[t])})),e.forEach(function(e){var o=e.model;if(t&&o in t&&(n.$state[o]=t[o]),r&&(n.$dirty[o]=!0),Object.prototype.hasOwnProperty.call(n,o))console.warn('Name conflict: property "'+o+'" has same name as global action/global getter "'+o+'" in '+n._store_name);else{var a=function(){},s="";if(o.includes("/")||o.includes(".")){s=o.replace(/\//g,".");var c=o.split("/"),u=c.pop();c=c.join("."),a=function(){return j(n.$state,c)[u]},e.is_nested=!0}else s=o,a=function(){return n.$state[o]},e.is_nested=!1;if(e.validate_bolt_type){var l=function(e,t,r,n){return 0===e||null===e?e:i.isMoment(e)?void console.error("Do not assign moment objects directly."):isFinite(e)&&e>r&&e<n?t(e):void 0===e?t():(console.warn("Schema defined",o,"as Timestamp, but got invalid data:",e),e)},d=a;"Timestamp"===e.validate_bolt_type?a=function(){return l(d(),i.fromRealtimeDB,2e8,3e10)}:D.includes(e.validate_bolt_type)?a=function(){return l(d(),i.fromRealtimeServerTime,2e11,3e13)}:e.validate_bolt_type.includes("Timestamp")&&console.warn("Found validation type that contains 'Timestamp' but is not recognized:",e.validate_bolt_type)}Object.defineProperty(n,s,{set:function(t){return n._update_field(s,t,e)},get:a})}})},$.prototype.decorate_actions=function(e,t){var r=this;if(e){t.model=this;var n=function(n){var i=e[n];Object.prototype.hasOwnProperty.call(r,n)?console.warn('Name conflict: action "'+n+'" has same name as property/global action/global getter "'+n+'" in '+r._store_name):Object.defineProperty(r,n,{value:function(){return i(t)}})};for(var i in e)n(i)}},$.prototype.decorate_getters=function(e,t){if(e){for(var r in e)Object.prototype.hasOwnProperty.call(this,r)&&(console.warn('Name conflict: getter "'+r+'" has same name as property/custom action/global action/global getter "'+r+'" in '+this._store_name),delete e[r]);t.model=this;var n=b(t,this,e);S.set(this,n)}},$.prototype._set_generic_store=function(e){R.set(this,e)},$.prototype.write=function(){var e=this;console.log("Writing $dirty fields",JSON.stringify(this.$dirty));var t,r,n,i={};for(var o in this.$dirty){var a=void 0,s=void 0;o.includes(".")?(s=o.replace(/\./g,"/"),t=this.$state,r=void 0,n=void 0,r=(""+o).split("."),n=r.pop(),a=r.reduce(function(e,t){return e[t]||{}},t)[n]):(s=o,a=this.$state[o]),void 0!==a?i[s]=a:console.warn("Trying to write undefined for prop",o)}var c=this.$model;if(!c)throw new Error("Model reference not set with _set_generic_store");var u=!0,l=this.$id;return l||(l=c._get_uid(),u=!1),c.modelDefinition&&c.modelDefinition.schema?c._validate_schema(i,u):console.warn("No schema found to validate input"),c.update(l,i).then(function(){return e.$id=l,e.$dirty={},l})},$.prototype._get_modal_for_write=function(){if(!this.$id)throw new Error("Write operations are not allowed for new models.");var e=this.$model;if(!e)throw new Error("Model reference not set with _set_generic_store");return e},$.prototype.update=function(e){var t=this;return this._get_modal_for_write().update(this.$id,e).then(function(){for(var r in e)delete t.$dirty[r];return t.$id})},$.prototype.remove=function(e){var t=this;return void 0===e&&(e=!0),this._get_modal_for_write().remove(this.$id,e).then(function(){e&&delete t.$dirty.deleted})},$.prototype.restore=function(){var e=this;return this._get_modal_for_write().restore(this.$id).then(function(){delete e.$dirty.deleted})},$.prototype.reset=function(){},Object.defineProperties($.prototype,I);var M=new WeakMap,P=function(e){this.items={},this.$readyAll=!1,this.$readySome=!1,this.$promise=Promise.resolve(),this.$numReady=0,this.$noaccess=null,this.$numChildren=0,this._store_name=e,this._unwatch=null},N={$vm:{configurable:!0},itemsSorted:{configurable:!0},$id_list:{configurable:!0}};function k(e){var t=e[e.length-1];return e.pop(),e=e.length>1?k(e):e[0],function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];var i=e.apply(void 0,r),o=t.apply(void 0,r);return Object.assign(i||{},o)}}P.prototype._clone=function(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)},P.prototype._add_child=function(e,t){this.$readySome=!0,this.$lastUpdate=Date.now(),f.set(this.items,e,t),this.$numChildren+=1,this.items[e].$idx=this.$numChildren},P.prototype._rem_child=function(e){e in this.items&&this.items[e]._onRemove(),f.delete(this.items,e),this.$numChildren-=1},N.$vm.get=function(){return M.get(this)},P.prototype.decorate_actions=function(e,t){var r=this;if(e){t.model=this;var n=function(n){var i=e[n];Object.prototype.hasOwnProperty.call(r,n)?console.warn('Name conflict: list action "'+n+'" has same name as existing method "'+n+'" in '+r._store_name):Object.defineProperty(r,n,{value:function(){return i(t)}})};for(var i in e)n(i)}},P.prototype.decorate_getters=function(e,t){if(e){for(var r in e)Object.prototype.hasOwnProperty.call(this,r)&&(console.warn('Name conflict: list getter "'+r+'" has same name as existing property getter "'+r+'" in '+this._store_name),delete e[r]);t.model=this;var n=b(t,this,e);M.set(this,n)}},P.prototype.getItemByIdx=function(e){for(var t in this.items)if(this.items[t].$idx===e)return this.items[t];return null},P.prototype.asArraySorted=function(){var e=this._clone();return e.items=this.itemsAsArray(),e.items.sort(x),e},P.prototype.asArraySortedBy=function(e){var t=this._clone();return t.items=this.itemsAsArray(),t.items.sort(T(e)),t},P.prototype.asArrayFilteredBy=function(e,t){var r=this._clone();return r.items=this.itemsAsArray(),r.items=r.items.filter(function(r){return r[e]===t}),r},P.prototype.itemsAsArray=function(){var e=this;return Array.isArray(this.items)?this.items:Object.keys(this.items).map(function(t){return e.items[t]})},N.itemsSorted.get=function(){return this.itemsAsArray().sort(x)},P.prototype.itemsAsArrayWithoutDeleted=function(e){return this.itemsAsArray().filter(function(e){return!1===e.deleted||void 0===e.deleted}).sort(e?T(e):x)},P.prototype.itemsAsArrayOnlyDeleted=function(e){return this.itemsAsArray().filter(function(e){return!0===e.deleted}).sort(e?T(e):x)},N.$id_list.get=function(){return Object.keys(this.items)},P.prototype.reset=function(){this._unwatch&&(console.log("Found local unwatcher in",this._store_name),this._unwatch())},Object.defineProperties(P.prototype,N);function G(){var e,t,r=new Promise(function(r,n){e=r,t=n});return r.resolve=e,r.reject=t,r}var U=Array.prototype;function z(e,t){return e.filter(function(e){return t.indexOf(e)<0})}Object.defineProperty(U,"clone",{value:function(){return this.slice(0)},enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(U,"move",{value:function(e,t){this.splice(t,0,this.splice(e,1)[0])},enumerable:!1,configurable:!0,writable:!0});var L=function(){},V=L,B=L,C=L,Y=L,q=L,F=new Map,H=new Map;"false"===String(process.env.VUE_APP_PRODUCTION)&&(window.helioRxDev=window.helioRxDev||{},window.helioRxDev._resultInstanceCache=F,window.helioRxDev._resultListCache=H);var W,X={read_mixin_init:function(){if(C(this.name),this.modelDefinition&&this.modelDefinition.staticGetters){var e=[_,d,this];this._vm=b(e,this,this.modelDefinition.staticGetters)}},_infer_local_path_from_ref:function(e){return e.path.toString().split("/").filter(function(e){return e}).join(".")},unsync:function(e,t){void 0===e&&(e=null),void 0===t&&(t={});var r=t.clean_up;void 0===r&&(r=!1),C(this.name);var n=null!==e?this.global_store_path_array[e]:this.global_store_path;if(n&&this._unbind_rtdb({key:n}),null!==e&&!(e in this.global_store_path_array)){if(this.isSuffixed)throw new Error("Unsync with id for data retrieved via subscribeList() is not supported.");n=this.global_store_path+"."+e}if(r){if(q(this.name),null!==e&&H.has(this.path))H.get(this.path)._rem_child(e);d.commit("heliosrx/UNSET_VALUE",{path:n},{root:!0})}},unsync_all:function(e){var t=this;void 0===e&&(e={});var r=e.clean_up;void 0===r&&(r=!1),C(this.name);var n=this.subscriptions;if(n){if(r&&H.has(this.path)){var i=H.get(this.path);i.$id_list.forEach(function(e){return i._rem_child(e)}),i.reset()}Object.keys(n).forEach(function(e){t._unbind_rtdb({key:e}),r&&d.commit("heliosrx/UNSET_VALUE",{path:e},{root:!0})})}},fetch_individual:function(e,t){void 0===t&&(t={});var r=t.overwriteKey;void 0===r&&(r=!1);var n=t.customOps;return void 0===n&&(n={}),this.sync_individual(e,{overwriteKey:r,customOps:n,fetchOnce:!0})},fetch_list:function(e){void 0===e&&(e={});var t=e.overwriteKey;void 0===t&&(t=!1);var r=e.customOps;void 0===r&&(r={});var n=e.customRef;return void 0===n&&(n=null),this.sync_list({overwriteKey:t,customOps:r,customRef:n,fetchOnce:!0})},sync_individual:function(e,t){var r=this;void 0===t&&(t={});var n=t.overwriteKey;void 0===n&&(n=!1);var i=t.fetchOnce;void 0===i&&(i=!1);var o=t.customOps;void 0===o&&(o={}),this.isSuffixed;var a=this.childRef(e),s="res."+this._infer_local_path_from_ref(a);this.global_store_path_array[e]=s,B(this.name,"sync_individual:",this.name),C(this.name,"[GENS] - sync ref",a.path.toString()),C(this.name),C(this.name,"[GENS] - sync target",this.global_store_path_array[e]);var c={init:function(){var t={};return C(r.name),d.commit("heliosrx/INIT_VALUE",{path:r.global_store_path_array[e],data:t},{root:!0}),{target:t}},set:function(e,t){C(r.name),d.commit("heliosrx/SET",{target:e,data:t},{root:!0})}};return i&&(c={init:function(){Y(r.name);return{target:{}}},set:function(e,t){Y(r.name)}}),Object.keys(o).forEach(function(e){c[e]=k([c[e],o[e]])}),i?this._fetch_rtdb({key:s,ref:a,ops:c,bindAsArray:!1}):this._bind_rtdb({key:s,ref:a,ops:c,bindAsArray:!1})},sync_list:function(e){var t=this;void 0===e&&(e={});var r=e.overwriteKey;void 0===r&&(r=!1);var n=e.fetchOnce;void 0===n&&(n=!1);var i=e.customOps;void 0===i&&(i={});var o=e.customRef;if(void 0===o&&(o=null),this.isSuffixed)throw new Error("Suffixed store does not support bind to array");var a=o||this.parentRef,s="res."+(r||this._infer_local_path_from_ref(a));B(this.name,"sync:",this.name),C(this.name,"[GENS] - ref",this.parentRef),C(this.name),this.global_store_path=s;var c={root:!0},u={init:function(){C(t.name,"[OPS:INIT]",t.global_store_path,d.state);var e={},r=j(d.state,t.global_store_path);return Object.keys(r).length>0&&(C(t.name),e=r),C(t.name),d.commit("heliosrx/INIT_VALUE",{path:t.global_store_path,data:e},c),{target:e}},add:function(e,r,n){C(t.name),d.commit("heliosrx/ARRAY_ADD",{target:e,newId:r,data:n},c)},remove:function(e,r){var n=e[r],i=t._match_all_existing_synced_queries(t.path);for(var o in q(t.name),q(t.name,"entry_name",t.path),q(t.name),q(t.name),i){var a=i[o].query;if(t._itemMatchesQuery(a,n))return void q(t.name)}d.commit("heliosrx/ARRAY_REMOVE",{target:e,oldId:r},c)},set:function(e,r,n){C(t.name),d.commit("heliosrx/ARRAY_SET",{target:e,currentId:r,data:n},c)},once:function(e,t,r){}};return n&&(u={init:function(){Y(t.name);return{target:{}}},once:function(e,r,n){Y(t.name)}}),Object.keys(i).forEach(function(e){u[e]=k([u[e],i[e]])}),C(this.name),C(this.name),n?this._fetch_rtdb({key:s,ref:a,ops:u,bindAsArray:!0}):this._bind_rtdb({key:s,ref:a,ops:u,bindAsArray:!0})},_itemMatchesQuery:function(e,t){return console.log("[itemMatchesQuery]",e,t),!0},_create_context:function(){return{registry:d,store:this}},_match_all_existing_synced_queries:function(e,t){void 0===t&&(t=!0),e.includes("#")&&(e=e.split("#").shift());var r=[];for(var n in d.state.sync){var i=n.split("#").shift();if(e.startsWith(i)){var o=d.state.sync[n];if(!t||"Ready"!==o.status&&"Loading"!==o.status)continue;r.push(Object.assign({},{path:n,path_without_query:i},o))}}return r},_match_existing_synced_nodes:function(e,t){for(var r in void 0===t&&(t=!1),e.includes("#")&&(e=e.split("#").shift()),d.state.sync){var n=r;if(r.includes("#")){var i=r.split("#").shift();e.startsWith(i)&&console.warn("You're trying to sync a path that has already been synced by a query. This is not supported.","requested_path",e,"existing_path",r)}if(t&&r.includes("{id}")&&(r=r.replace("{id}","")),e.startsWith(r)&&("Ready"===d.state.sync[n].status||"Loading"===d.state.sync[n].status))return B(this.name),n}return!1},_get_sync_state:function(e){return(d.state.sync[e]||{}).status||null},getList:function(e,t){void 0===t&&(t={});var r=t.noReactiveGetter;return void 0===r&&(r=!1),B(this.name),this.subscribeList(e,{noSync:!0,createModelFromExistingCache:!0,noReactiveGetter:r})},getNode:function(e,t){void 0===t&&(t={});var r=t.noReactiveGetter;if(void 0===r&&(r=!1),B(this.name),!e)throw new Error("getNode: got invalid id: "+e);return this.subscribeNode(e,{noSync:!0,createModelFromExistingCache:!0,noReactiveGetter:r})},subscribeList:function(e,t){var r=this;void 0===t&&(t={});var n=t.noSync;void 0===n&&(n=!1);var i=t.noReactiveGetter;void 0===i&&(i=!1);var o=t.createModelFromExistingCache;void 0===o&&(o=!1);var a=t.queryParams;void 0===a&&(a=null);var s=null,c="",u=this.path;if(a&&(s=this.buildQueryRef(a),c=this.queryHash(a),u=u+"#"+c,V(this.name)),B(this.name),H.get(u))return B(this.name),H.get(u);var l=d.getters.get_registry_entry(u);l&&B(this.name);var f=this._match_existing_synced_nodes(u,!0);if(f){if(o){var h=this.getData();B(this.name);var _=p.make_reactive_list(this.modelDefinition,h,this._create_context(),i);_.$promise=G();var m=this._get_sync_state(f);B(this.name),"Ready"===m&&_.$promise.resolve(!0),q(this.name);var v=d.watch(function(e){return q(r.name),r.getData(null,!0)},function(e,t){if(q(r.name),null==e)return _.$id_list.forEach(function(e){q(r.name),_._rem_child(e)}),_.$numReady=!1,_.$readyAll=!1,_.$readySome=!1,void _.$promise.resolve(!0);var n=Object.keys(e),o=t?Object.keys(t):[],a=_.$id_list;n.toString()===o.toString()&&q(r.name);var s,c,l={removed:z(c=a,s=n),added:z(s,c)};q(r.name),l.removed.forEach(function(e){q(r.name),_._rem_child(e),_.$numReady--}),l.added.forEach(function(e){q(r.name);var t=u.split("#").shift().replace(/\{id\}/g,e);F.has(t)&&console.warn("A new item was added, but there already exists a model instance in the cache for this item. This means the subscription management failed.");var n=r.getData(e),o=p.make_reactive_model(r.modelDefinition,n,r._create_context(),!1,i);o.$id=e,_._add_child(e,o),_.$numReady++,F.set(t,o)}),_.$promise.resolve(!0)});return _._unwatch=v,H.set(u,_),_}console.warn("You're trying to sync data, that is already synced by a node higher up in the hierarchy. This will result in undefined behaviour. Try using getList() instead! Sync path:",u)}if(this._match_existing_synced_nodes(u)===u)throw console.log(">>>",u,H,F),new Error("Exact path found, but no cache hit. This should never happen");if(n)return B(this.name),console.warn("You're trying to fetch data at "+u+" that has not been synced yet."),null;V(this.name),l={query:a,status:"Loading"},d.commit("ADD_ENTRY",{name:u,data:l});var y=p.make_reactive_list(this.modelDefinition,null,this._create_context());H.set(u,y),y.$promise=G(),B(this.name);var g={add:function(e,t,n){d.commit("SET_ENTRY_STATUS",{name:u,value:"Ready"}),B(r.name,"subscribeList:add - Child ready",r.name);var o=u.split("#").shift().replace(/\{id\}/g,t);F.has(o)&&B(r.name),t in y.items&&console.warn("An existing item was added twice. This means the subscription management failed.");var a=F.has(o)?F.get(o):p.make_reactive_model(r.modelDefinition,n,r._create_context(),!1,i);a.$id=t,y._add_child(t,a),F.has(o)?a._update_data(n):F.set(o,a)},init:function(e){return B(r.name),{}},remove:function(e,t){q(r.name),y._rem_child(t)},set:function(e,t,n){if(B(r.name),H.get(u)&&t in H.get(u).items){var i=H.get(u).items[t],o=r.getData(t);i._update_data(o,r.modelDefinition.schema.fields),B(r.name)}else B(r.name,"subscribeList:set - WARNING - not found in cache!",t,H.get(u))}};return this.sync_list({customOps:g,customRef:s}).then(function(){y.$readyAll=!0,y.$promise.resolve(!0)}).catch(function(e){if("PERMISSION_DENIED"!==e.code)throw e;console.warn(e.message),console.log("======================================"),console.log("PERMISSION_DENIED ["+r.name+".subscribeList()]"),console.log("queryParams:",a),console.log("======================================"),y.$readyAll=!0,y.$readySome=!0,y.$noaccess=!0,y.$promise.reject(e)}),y},subscribeNode:function(e,t){var r=this;void 0===t&&(t={});var n=t.noSync;void 0===n&&(n=!1);var i=t.noReactiveGetter;void 0===i&&(i=!1);var o=t.createModelFromExistingCache;if(void 0===o&&(o=!1),!e)throw new Error("subscribeNode: got invalid id: ");var a=this._previewPath(e),s=this.path;if(B(this.name),H.get(s)&&e in H.get(s).items)return B(this.name),H.get(s).items[e];if(F.has(a))return B(this.name),F.get(a);if(this._match_existing_synced_nodes(s)&&V(this.name,"======================================= (FIXME)",{entry_name_child:a},{entry_name_list:s},{"has:node":F.has(a)},{"get:list":F.get(s)}),this._match_existing_synced_nodes(a)){if(o){var c=this.getData(e);B(this.name);var u=p.make_reactive_model(this.modelDefinition,c,this._create_context(),!1,i);return u.$id=e,u.$ready=!0,F.set(a,u),B(this.name),u}console.warn("You're trying to sync data, that is already synced by a node higher up in the hierarchy. This will result in undefined behaviour. Try using getNode() instead! Sync path:",a)}if(this._match_existing_synced_nodes(a)===a)throw console.log(">>>",a,H,F),new Error("Exact path found, but no cache hit. This should never happen");if(n)return null;V(this.name);var l=p.make_reactive_model(this.modelDefinition,null,this._create_context(),!1,i);l.$id=e,l.$promise=G(),F.set(a,l);var f={id:e,status:"Loading"};d.commit("ADD_ENTRY",{name:a,data:f}),B(this.name);var h={init:function(e){return B(r.name),{}},set:function(e,t){B(r.name)}};return this.sync_individual(e,{customOps:h}).then(function(t){var n=r.getData(e);B(r.name),void 0!==n?(l._update_data(n,r.modelDefinition.schema.fields),l.$ready=!0,l.$noaccess=!1,d.commit("SET_ENTRY_STATUS",{name:a,value:"Ready"}),B(r.name),l.$promise.resolve(!0)):console.warn(r.name,"subscribeNode - subscribeList took over, while waiting for sync_individual. subscribeList will handle instance now.")}).catch(function(t){if("PERMISSION_DENIED"!==t.code)throw t;console.warn(t.message),console.log("======================================"),console.log("PERMISSION_DENIED ["+r.name+".subscribeNode( "+e+" )]"),console.log("======================================"),d.commit("SET_ENTRY_STATUS",{name:a,value:"NoAccess"});var n=r.getData(e);n[".noaccess"]=!0,l._update_data(n,r.modelDefinition.schema.fields),l.$ready=!0,l.$noaccess=!0,l.$promise.reject(t)}),l},buildQueryRef:function(e){var t=e.key;void 0===t&&(t=void 0);var r=e.value;void 0===r&&(r=void 0);var n=e.limit;void 0===n&&(n=void 0);var i=e.startAt;void 0===i&&(i=void 0);var o=e.endAt;void 0===o&&(o=void 0);var a=this.parentRef;return a="*"===t?a.orderByValue():void 0===t?a.orderByKey():a.orderByChild(t),void 0!==r&&(a=a.equalTo(r)),void 0!==i&&(a=a.startAt(i)),void 0!==o&&(a=a.endAt(o)),void 0!==n&&(a=n>0?a.limitToFirst(n):a.limitToLast(-n)),a},queryHash:function(e){var t=[e.key,e.value,e.limit,e.startAt,e.endAt].join("_");return t},subscribeQuery:function(e,t){return void 0===t&&(t={}),this.subscribeList(null,Object.assign({},t,{queryParams:e}))},fetchNode:function(e,t){var r=this;void 0===t&&(t={});var n=t.noReactiveGetter;void 0===n&&(n=!1);var i=p.make_reactive_model(this.modelDefinition,null,this._create_context(),!1,n);i.$id=e,i.$promise=G();var o={init:function(e){return Y(r.name),{}},set:function(e,t){Y(r.name)}};return this.fetch_individual(e,{customOps:o}).then(function(e){Y(r.name),i._update_data(e,r.modelDefinition.schema.fields),i.$ready=!0,i.$promise.resolve(!0)}),i},fetchList:function(e){var t=this;void 0===e&&(e={});var r=e.noReactiveGetter;void 0===r&&(r=!1);var n=e.queryParams;void 0===n&&(n=null);var i=n?this.buildQueryRef(n):null,o=p.make_reactive_list(this.modelDefinition,null,this._create_context(),r);o.$promise=G();var a={init:function(){return Y(t.name),{}},once:function(e,r,n){Y(t.name)}};return this.fetch_list({customOps:a,customRef:i}).then(function(e){Y(t.name),Object.keys(e||[]).forEach(function(n){var i=e[n],a=p.make_reactive_model(t.modelDefinition,i,t._create_context(),!1,r);a.$id=n,o._add_child(n,a),o.$numReady++}),o.$readyAll=!0,o.$promise.resolve(!0)}),o},fetchQuery:function(e,t){return this.fetchList(Object.assign({},t,{queryParams:e}))},getRegistryState:function(){return d.state},getAllSyncedPaths:function(){var e={};return Object.keys(d.state.sync).forEach(function(t){e[t]=d.state.sync[t].status}),e},getData:function(e,t){void 0===e&&(e=null),void 0===t&&(t=!1);var r="";if(this.isSuffixed||e){if(!e)throw new Error("getData: id required for suffixed stores");r=this.path.replace(/\{id\}/g,e)}else r=this.path.split("{id}").shift();var n,i="res."+r.split("/").filter(function(e){return e}).join(".");return d.state.initialized?t?j(d.state,i):(n=d.state,i.split(".").reduce(function(e,t){return e[t]},n)):null},reset_global_instance_cache:function(){try{F.forEach(function(e){e.reset()}),H.forEach(function(e){e.reset()})}catch(e){console.warn("Reseting instances failed",e)}F.clear(),H.clear()}},K=y(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,o=2,a=9007199254740991,s="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",l="[object Boolean]",d="[object Date]",f="[object Error]",h="[object Function]",_="[object GeneratorFunction]",m="[object Map]",p="[object Number]",y="[object Null]",g="[object Object]",b="[object Proxy]",w="[object RegExp]",E="[object Set]",j="[object String]",A="[object Symbol]",O="[object Undefined]",S="[object ArrayBuffer]",R="[object DataView]",D=/^\[object .+?Constructor\]$/,$=/^(?:0|[1-9]\d*)$/,I={};I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I[s]=I[c]=I[S]=I[l]=I[R]=I[d]=I[f]=I[h]=I[m]=I[p]=I[g]=I[w]=I[E]=I[j]=I["[object WeakMap]"]=!1;var x="object"==typeof v&&v&&v.Object===Object&&v,T="object"==typeof self&&self&&self.Object===Object&&self,M=x||T||Function("return this")(),P=t&&!t.nodeType&&t,N=P&&e&&!e.nodeType&&e,k=N&&N.exports===P,G=k&&x.process,U=function(){try{return G&&G.binding&&G.binding("util")}catch(e){}}(),z=U&&U.isTypedArray;function L(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function V(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function B(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var C,Y,q,F=Array.prototype,H=Function.prototype,W=Object.prototype,X=M["__core-js_shared__"],K=H.toString,Q=W.hasOwnProperty,J=(C=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"",Z=W.toString,ee=RegExp("^"+K.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=k?M.Buffer:void 0,re=M.Symbol,ne=M.Uint8Array,ie=W.propertyIsEnumerable,oe=F.splice,ae=re?re.toStringTag:void 0,se=Object.getOwnPropertySymbols,ce=te?te.isBuffer:void 0,ue=(Y=Object.keys,q=Object,function(e){return Y(q(e))}),le=Ue(M,"DataView"),de=Ue(M,"Map"),fe=Ue(M,"Promise"),he=Ue(M,"Set"),_e=Ue(M,"WeakMap"),me=Ue(Object,"create"),pe=Be(le),ve=Be(de),ye=Be(fe),ge=Be(he),be=Be(_e),we=re?re.prototype:void 0,Ee=we?we.valueOf:void 0;function je(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ae(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Oe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Se(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Oe;++t<r;)this.add(e[t])}function Re(e){var t=this.__data__=new Ae(e);this.size=t.size}function De(e,t){var r=qe(e),n=!r&&Ye(e),i=!r&&!n&&Fe(e),o=!r&&!n&&!i&&Qe(e),a=r||n||i||o,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=s.length;for(var u in e)!t&&!Q.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ve(u,c))||s.push(u);return s}function $e(e,t){for(var r=e.length;r--;)if(Ce(e[r][0],t))return r;return-1}function Ie(e){return null==e?void 0===e?O:y:ae&&ae in Object(e)?function(e){var t=Q.call(e,ae),r=e[ae];try{e[ae]=void 0;var n=!0}catch(e){}var i=Z.call(e);n&&(t?e[ae]=r:delete e[ae]);return i}(e):function(e){return Z.call(e)}(e)}function xe(e){return Ke(e)&&Ie(e)==s}function Te(e,t,r,n,a){return e===t||(null==e||null==t||!Ke(e)&&!Ke(t)?e!=e&&t!=t:function(e,t,r,n,a,u){var h=qe(e),_=qe(t),v=h?c:Le(e),y=_?c:Le(t),b=(v=v==s?g:v)==g,O=(y=y==s?g:y)==g,D=v==y;if(D&&Fe(e)){if(!Fe(t))return!1;h=!0,b=!1}if(D&&!b)return u||(u=new Re),h||Qe(e)?Ne(e,t,r,n,a,u):function(e,t,r,n,a,s,c){switch(r){case R:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!s(new ne(e),new ne(t)));case l:case d:case p:return Ce(+e,+t);case f:return e.name==t.name&&e.message==t.message;case w:case j:return e==t+"";case m:var u=V;case E:var h=n&i;if(u||(u=B),e.size!=t.size&&!h)return!1;var _=c.get(e);if(_)return _==t;n|=o,c.set(e,t);var v=Ne(u(e),u(t),n,a,s,c);return c.delete(e),v;case A:if(Ee)return Ee.call(e)==Ee.call(t)}return!1}(e,t,v,r,n,a,u);if(!(r&i)){var $=b&&Q.call(e,"__wrapped__"),I=O&&Q.call(t,"__wrapped__");if($||I){var x=$?e.value():e,T=I?t.value():t;return u||(u=new Re),a(x,T,r,n,u)}}if(!D)return!1;return u||(u=new Re),function(e,t,r,n,o,a){var s=r&i,c=ke(e),u=c.length,l=ke(t).length;if(u!=l&&!s)return!1;for(var d=u;d--;){var f=c[d];if(!(s?f in t:Q.call(t,f)))return!1}var h=a.get(e);if(h&&a.get(t))return h==t;var _=!0;a.set(e,t),a.set(t,e);for(var m=s;++d<u;){f=c[d];var p=e[f],v=t[f];if(n)var y=s?n(v,p,f,t,e,a):n(p,v,f,e,t,a);if(!(void 0===y?p===v||o(p,v,r,n,a):y)){_=!1;break}m||(m="constructor"==f)}if(_&&!m){var g=e.constructor,b=t.constructor;g!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b)&&(_=!1)}return a.delete(e),a.delete(t),_}(e,t,r,n,a,u)}(e,t,r,n,Te,a))}function Me(e){return!(!Xe(e)||(t=e,J&&J in t))&&(He(e)?ee:D).test(Be(e));var t}function Pe(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||W,t!==n)return ue(e);var t,r,n,i=[];for(var o in Object(e))Q.call(e,o)&&"constructor"!=o&&i.push(o);return i}function Ne(e,t,r,n,a,s){var c=r&i,u=e.length,l=t.length;if(u!=l&&!(c&&l>u))return!1;var d=s.get(e);if(d&&s.get(t))return d==t;var f=-1,h=!0,_=r&o?new Se:void 0;for(s.set(e,t),s.set(t,e);++f<u;){var m=e[f],p=t[f];if(n)var v=c?n(p,m,f,t,e,s):n(m,p,f,e,t,s);if(void 0!==v){if(v)continue;h=!1;break}if(_){if(!L(t,function(e,t){if(i=t,!_.has(i)&&(m===e||a(m,e,r,n,s)))return _.push(t);var i})){h=!1;break}}else if(m!==p&&!a(m,p,r,n,s)){h=!1;break}}return s.delete(e),s.delete(t),h}function ke(e){return function(e,t,r){var n=t(e);return qe(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Je,ze)}function Ge(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Ue(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Me(r)?r:void 0}je.prototype.clear=function(){this.__data__=me?me(null):{},this.size=0},je.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},je.prototype.get=function(e){var t=this.__data__;if(me){var r=t[e];return r===n?void 0:r}return Q.call(t,e)?t[e]:void 0},je.prototype.has=function(e){var t=this.__data__;return me?void 0!==t[e]:Q.call(t,e)},je.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=me&&void 0===t?n:t,this},Ae.prototype.clear=function(){this.__data__=[],this.size=0},Ae.prototype.delete=function(e){var t=this.__data__,r=$e(t,e);return!(r<0||(r==t.length-1?t.pop():oe.call(t,r,1),--this.size,0))},Ae.prototype.get=function(e){var t=this.__data__,r=$e(t,e);return r<0?void 0:t[r][1]},Ae.prototype.has=function(e){return $e(this.__data__,e)>-1},Ae.prototype.set=function(e,t){var r=this.__data__,n=$e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Oe.prototype.clear=function(){this.size=0,this.__data__={hash:new je,map:new(de||Ae),string:new je}},Oe.prototype.delete=function(e){var t=Ge(this,e).delete(e);return this.size-=t?1:0,t},Oe.prototype.get=function(e){return Ge(this,e).get(e)},Oe.prototype.has=function(e){return Ge(this,e).has(e)},Oe.prototype.set=function(e,t){var r=Ge(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Se.prototype.add=Se.prototype.push=function(e){return this.__data__.set(e,n),this},Se.prototype.has=function(e){return this.__data__.has(e)},Re.prototype.clear=function(){this.__data__=new Ae,this.size=0},Re.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},Re.prototype.get=function(e){return this.__data__.get(e)},Re.prototype.has=function(e){return this.__data__.has(e)},Re.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ae){var i=n.__data__;if(!de||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Oe(i)}return n.set(e,t),this.size=n.size,this};var ze=se?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o}(se(e),function(t){return ie.call(e,t)}))}:function(){return[]},Le=Ie;function Ve(e,t){return!!(t=null==t?a:t)&&("number"==typeof e||$.test(e))&&e>-1&&e%1==0&&e<t}function Be(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ce(e,t){return e===t||e!=e&&t!=t}(le&&Le(new le(new ArrayBuffer(1)))!=R||de&&Le(new de)!=m||fe&&"[object Promise]"!=Le(fe.resolve())||he&&Le(new he)!=E||_e&&"[object WeakMap]"!=Le(new _e))&&(Le=function(e){var t=Ie(e),r=t==g?e.constructor:void 0,n=r?Be(r):"";if(n)switch(n){case pe:return R;case ve:return m;case ye:return"[object Promise]";case ge:return E;case be:return"[object WeakMap]"}return t});var Ye=xe(function(){return arguments}())?xe:function(e){return Ke(e)&&Q.call(e,"callee")&&!ie.call(e,"callee")},qe=Array.isArray;var Fe=ce||function(){return!1};function He(e){if(!Xe(e))return!1;var t=Ie(e);return t==h||t==_||t==u||t==b}function We(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function Xe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ke(e){return null!=e&&"object"==typeof e}var Qe=z?function(e){return function(t){return e(t)}}(z):function(e){return Ke(e)&&We(e.length)&&!!I[Ie(e)]};function Je(e){return null!=(t=e)&&We(t.length)&&!He(t)?De(e):Pe(e);var t}e.exports=function(e,t){return Te(e,t)}}),Q=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)},J={write_mixin_init:function(e){(void 0===e&&(e=!1),this.modelDefinition)&&(this.modelDefinition.staticActions&&function(e,t,r,n){var i=function(i){var o=r[i];if(n&&delete t[i],Object.prototype.hasOwnProperty.call(t,i)){var a=e.$store.name;console.warn('Name conflict: action "'+i+'" has same name as another property "'+i+'" in '+a)}else Object.defineProperty(t,i,{value:function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return o.apply(t,[e].concat(r))},enumerable:!0})};for(var o in r)i(o)}({$store:this,$models:_,$registry:d},this,this.modelDefinition.staticActions,e))},add:function(e,t,r){var n,i=null;if(t||(t=this._get_uid()),!t[".sv"]&&!this._validateId(t))throw new Error("Got invalid id:"+t);var o=!0;return r&&r.directWrite&&(o=!1),this.modelDefinition?(o?this.modelDefinition.schema&&this.modelDefinition.schema.create?(this._check_required_create_arg(e),i=this.modelDefinition.schema.create(e,e,"REALTIMEDB")):(console.warn("No create function found in type definition, using overwrite data as payload."),i=e):i=e,this.modelDefinition.schema?this._validate_schema(i,!1):console.warn("No schema found to validate input")):(console.warn("No type definition found, using UNVALIDATED overwrite data as payload."),i=e),this._convert_moment_objects(i),Q("[GENS] Creating at",this._previewPath(t),"with payload",i),this.isSuffixed?this.childRef(t).update(i).then(function(){return t}):this.parentRef.update((n={},n[t]=i,n)).then(function(){return t})},update:function(e,t){if(!e||!t)throw new Error("Either id or data is missing.");if(!this._validateId(e)){if(!(this.modelDefinition.schema||{}).unsafe_disable_validation)throw new Error("Got invalid id in update");console.warn("Got invalid id <"+e+">, but validation is disabled.")}this.modelDefinition.schema?this._validate_schema(t,!0):console.warn("No schema found to validate input");var r=t;return this._convert_moment_objects(r),Q("[GENS] Updating at",this._previewPath(e),"with payload",r),this.childRef(e).update(r)},reorder:function(e,t){var r=this;if(void 0===t&&(t={}),this.isSuffixed)throw new Error("Suffixed store does not support reorder");var n=t.overwriteSortIdxKey||"sortidx";if(e.length>0&&"object"!=typeof e[0]){var i=0;e=e.map(function(e){return{id:e,sortidx:i+=100}})}var o={};e.forEach(function(e){var t,i=e.sortidx;if(e.id=e.id||e.$id,"number"!=typeof i&&(i=parseFloat(i)),isNaN(i))throw new Error("Got invalid sortidx",i);if(!r._validateId(e.id))throw new Error("Got invalid id",e.id);o[e.id]=((t={})[n]=i,t)});var a={};return Object.keys(o).forEach(function(e){var t=o[e];Object.keys(t).forEach(function(n){a[r._previewPath(e)+"/"+n]=t[n]})}),Q("[GENS] update at",this._previewPath(),"with payload",a),this.rootRef.update(a)},remove:function(e,t){var r=this;if(t=void 0===t?this.defaultDeleteMode===c.SOFT:t,Array.isArray(e)){var n={};return e.forEach(function(e){if(!r._validateId(e))throw new Error("Got invalid id in remove");t?n[e+"/deleted"]=!0:n[e]=null}),Q("[GENS] batch deleting at",this.path,"with payload",n),this.parentRef.update(n)}if(!this._validateId(e))throw new Error("Got invalid id in remove");return t?(Q("[GENS] soft deleting at",this.path,"with",{deleted:!0}),this.update(e,{deleted:!0})):(Q("[GENS] hard deleting at",this.path),this.childRef(e).remove())},restore:function(e){return this.update(e,{deleted:!1})},copy:function(e,t,r){return this.move(e,t,r,{keepOriginal:!0,keepId:!1})},move:function(e,t,r,n){var i=this;void 0===n&&(n={});var o=n.keepOriginal;void 0===o&&(o=!1);var a=n.keepId;if(void 0===a&&(a=!0),this.isSuffixed)throw new Error("Suffixed store does not support move");if(!this._validateId(e))throw new Error("Got invalid id in remove");var s=Object.keys(t).sort(),c=Object.keys(r).sort();if(!K(s,c))throw new Error("Context A and context B do not have equal keys");var d=Object.assign({},this.definedProps,t,{id:e}),f=Object.assign({},this.definedProps,r,{id:e});a||(f.id=this._get_uid());var h=this.templatePath.replace(/\*/,"{id}"),_=u(h,d),m=u(h,f),p=l(_);if(p.length>0)throw new Error("Not all template id's are defined. Required fields are "+p.join(", "));return this._db.ref(_).once("value").then(function(e){return e.val()}).then(function(e){var t={};return t[_]=null,t[m]=e,o&&((t={})[m]=e),Q("[GENS] moving data from ",_,"to",m,"with payload",t),i.rootRef.update(t).then(function(){return f.id})})},transaction:function(e,t,r,n){var i;if(void 0===n&&(n=1),!this._validateId(e))throw new Error("Got invalid id in remove");var o=this.childRef(e);if(t&&(this._validate_schema(((i={})[t]=1,i)),o=o.ref.child(t)),"string"==typeof r)switch(r){case"inc":r=function(e){return(e||0)+n};break;case"dec":r=function(e){return(e||0)-n}}if("function"!=typeof r)throw new Error("Transacton must be a function");return Q("[GENS] tranaction on ",o.path.toString()),o.transaction(r).then(function(e){return e.committed?(console.log("[GENS] Transacton successfully committed"),!0):(console.log("[GENS] Transacton aborted"),!1)})},new:function(){return p.make_reactive_model(this.modelDefinition,null,this._create_context(),!1)},new_from_template:function(e,t){void 0===e&&(e={}),void 0===t&&(t=null);var r=this.empty(e,t),n=p.make_reactive_model(this.modelDefinition,e,this._create_context(),!1);return n._update_data(r,null,!0),n},new_from_data:function(e,t){return void 0===e&&(e={}),p.make_reactive_model(this.modelDefinition,e,this._create_context(),!1)},empty:function(e,t){if(void 0===e&&(e={}),void 0===t&&(t=null),!this.modelDefinition)return null;if(!this.modelDefinition.schema||!this.modelDefinition.schema.create)return null;this._check_required_create_arg(e);var r=this.modelDefinition.schema.create(e,t||e,"REALTIMEDB");return this.modelDefinition.schema?this._validate_schema(r,!1):console.warn("No schema found to validate input"),r},_convert_moment_objects:function(e){if("object"!=typeof e)throw console.log("Got payload",e,typeof e),new Error("Expected object, got "+e);for(var t in e)if(i.isMoment(e[t])){if(!e[t].toRealtimeDB)throw new Error("Moment object passed to add/update must be enhanced moment objects.");e[t]=e[t].toRealtimeDB()}else Array.isArray(e[t])?this._convert_moment_objects(e[t]):"object"==typeof e[t]&&this._convert_moment_objects(e[t])}},Z=require("slugid"),ee=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];console.log.apply(console,e)},te=new WeakMap,re=null,ne=null,ie={userId:null};var oe,ae=function(e,t,r){if(void 0===r&&(r={}),t&&(t.abstract_store||r.isAbstract))this.isAbstract=!0,this.templatePath=e,this.modelDefinition=t,this.definedProps={},this.name="unnamed abstract";else{if(this.isAbstract=!1,this.name="unnamed",!e||e.length<2)throw new Error("Invalid template path:"+e);if("/"!==e[0])throw new Error("Template path has to start with /, got: "+e);if(1!==(e.match(/\*/g)||[]).length)throw new Error("Template path must contain exactly one *, got:"+e);this.isSuffixed=e.indexOf("*")!==e.length-1,"function"==typeof r.uidMethod?(this.uidMethod=s.CUSTOM,this.uidMethodCallback=r.uidMethod):this.uidMethod=r.uidMethod||s.PUSHID,this.additionalProps=r.additionalProps||[],this.defaultDeleteMode=r.defaultDeleteMode||c.HARD}this.isReadonly=r.isReadonly,this.templatePath=e,this.modelDefinition=t,this.definedProps={},this._localDB=null,this._clones=[],this.global_store_path_array=[],this.isSuffixed||(this.global_store_path=""),this.isAbstract?(Object.assign(this,{read_mixin_init:X.read_mixin_init,write_mixin_init:J.write_mixin_init}),this.read_mixin_init(),this.write_mixin_init()):(Object.assign(this,X),this.read_mixin_init(),this.isReadonly||(Object.assign(this,J),this.write_mixin_init()))},se={_db:{configurable:!0},defaultUserId:{configurable:!0},path:{configurable:!0},parentRef:{configurable:!0},rootRef:{configurable:!0},_template_path_field_names:{configurable:!0},_schema_fields:{configurable:!0},schema_required_fields:{configurable:!0},schema_optional_fields:{configurable:!0},schema_all_fields:{configurable:!0},subscriptions:{configurable:!0},rules:{configurable:!0}},ce={defaultUserId:{configurable:!0}};ae.prototype._clone=function(){var e=Object.getPrototypeOf(this),t=Object.create(e),r=Object.assign(t,this);return delete r.getters,delete r._vm,r.read_mixin_init(),this.isReadonly||r.write_mixin_init(!0),r._clones=[],this._clones.push(r),r},ae.prototype.setName=function(e){this.name=e},ae.prototype.generateId=function(){return this._get_uid()},ae.prototype._get_uid=function(){switch(this.uidMethod){case s.SLUGID:return Z.nice();case s.PUSHID:return this.rootRef.push().key;case s.TIMESTAMP:return ne.database.ServerValue.TIMESTAMP;case s.LOCAL_TIMESTAMP:return i.currentTime().unix();case s.DATE:return i.currentDate().format("DD-MM-YYYY");case s.OTHER_USER_ID:throw new Error("Please provide id through id override");case s.MY_USER_ID:if(!ae.defaultUserId)throw new Error("User ID is not set, but a store uses USER_ID as key");return ae.defaultUserId;case s.ARRAY:return 0;case s.EMAIL:throw new Error("Only email addresses allowed as key");case s.CUSTOM:var e=this.uidMethodCallback(this.definedProps);if(!e)throw new Error("An ID was not defined. Check custom UID Callback.");return e;default:throw new Error("Unknown UID Method: "+this.uidMethod)}},ae.setDefaultDB=function(e){re=e},se._db.get=function(){return this._localDB||re},ae.prototype._validateId=function(e){return!(this.uidMethod===s.SLUGID&&!function(e){return this.isString(e)&&e.length&&e.length>=20}(e))&&!(-1===e||!e)},ae.prototype._defineUser=function(){ae.defaultUserId&&(this.definedProps.uid=ae.defaultUserId)},ce.defaultUserId.get=function(){return ie.userId},se.defaultUserId.get=function(){return ie.userId},ce.defaultUserId.set=function(e){ee("[GENS] settings default user id to: uid =",e),W.set(ie,"userId",e)},ae.resetState=function(){ee("[GENS] reset state"),W.set(ie,"userId",null)},se.path.get=function(){"uid"in this.definedProps||this._defineUser();var e=u(this.templatePath,this.definedProps),t=l(e);if(t.length>0)throw new Error("Not all template id's are defined. Required fields are "+t.join(", "));return e.replace(/\*/g,"{id}")},ae.prototype._previewPath=function(e){"uid"in this.definedProps||this._defineUser();var t=u(this.templatePath,this.definedProps);return t=e?t.replace(/\*/g,e):t.replace(/\*/,"{id}")},ae.prototype.childRef=function(e){return this._db.ref(this.path.replace(/\{id\}/g,e))},se.parentRef.get=function(){return this._db.ref(this.path.split("{id}").shift())},se.rootRef.get=function(){return this._db.ref()},ae.prototype._define=function(e,t){e.definedProps=Object.assign({},this.definedProps,t);var r=[].concat(this._template_path_field_names,this.additionalProps);for(var n in t)r.includes(n)||console.warn("Prop",n,"not found in template path. Known fields are",r);return e},ae.prototype.define=function(e){return this._define(this,e)},ae.prototype.with=function(e){var t=this._clone();return this._define(t,e)},se._template_path_field_names.get=function(){return l(this.templatePath)},ae.prototype.reset=function(e){void 0===e&&(e=1),1===e&&function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]}("[GENS] resetting",this.name,"with",this._clones.length,"clones"),this.definedProps={},e>3?console.warn("[GENS] RESET - Stop at recursion level 3",this._clones):this._clones.forEach(function(t){t.reset(e+1)})},se._schema_fields.get=function(){var e=((this.modelDefinition||{}).schema||{}).fields;return void 0===e?[]:(Array.isArray(e)||(e=Object.keys(e).map(function(t){return Object.assign({},{model:t},e[t])})),e)},se.schema_required_fields.get=function(){return this._schema_fields.filter(function(e){return e.required}).map(function(e){return e.model})},se.schema_optional_fields.get=function(){return this._schema_fields.filter(function(e){return!e.required}).map(function(e){return e.model})},se.schema_all_fields.get=function(){return this._schema_fields.map(function(e){return e.model})},ae.prototype._check_required_fields=function(e){this.schema_required_fields.forEach(function(t){if(!(t in e))throw new Error("Required field <"+t+"> not present.")})},ae.prototype._check_required_create_arg=function(e){(((this.modelDefinition||{}).schema||{}).create_required||[]).forEach(function(t){if(!(t in e))throw new Error("Required create argument <"+t+"> not present.")})},ae.prototype._validate_schema=function(e,t){var r=this;if(!(this.modelDefinition&&this.modelDefinition.schema&&this.modelDefinition.schema.unsafe_disable_validation)){var n=this._schema_fields;if(!(n&&n.length>=0))throw new Error('No schema found for "'+this.name+'", please provide one.');t||this._check_required_fields(e);var i=this.schema_all_fields,o=[],a={};0===n.length?console.warn('Schema for "'+this.name+'" is empty.'):a=Object.assign.apply(Object,i.map(function(e,t){var n;return e.startsWith("/")&&e.endsWith("/")&&o.push(e),(n={})[e]=r._schema_fields[t],n})),Object.keys(e).forEach(function(t){var r=o.find(function(e){return new RegExp(e.substring(1,e.length-1),"u").test(t)});if(!r&&!i.includes(t))throw new Error("Field <"+t+"> is not allowed by schema.");var n=a[r||t];if(n.validator){var s=n.validator(e[t],n,null);if(!s||s.length&&0===s.length)throw new Error("Schema validation failed for key <"+t+"> with error: "+s)}})}},se.subscriptions.get=function(){return te.get(this)},ae.prototype._bind_rtdb=function(e){var t=e.key,r=e.ref,n=e.ops,i=e.bindAsArray,o=te.get(this);return o||(o=Object.create(null),te.set(this,o)),t in o&&this._unbind_rtdb(t),new Promise(function(e,a){o[t]=i?function(e){var t=e.collection,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target;t.once("value",function(e){r.once(o,e.val(),e.exists()),n()},function(e){e&&i(e)});var a=t.on("child_added",function(e,t){r.add(o,e.key,e.val())},i),s=t.on("child_removed",function(e){r.remove(o,e.key)},i),c=t.on("child_changed",function(e){r.set(o,e.key,e.val())},i),u=t.on("child_moved",function(e,t){},i);return function(){t.off("child_added",a),t.off("child_changed",c),t.off("child_removed",s),t.off("child_moved",u)}}({key:t,collection:r,ops:n,resolve:e,reject:a}):function(e){var t=e.document,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target,a=t.on("value",function(e){var t=e.val();e.exists()||(t={".exists":!1}),r.set(o,t),n(t)},function(e){e&&i(e)});return function(){t.off("value",a)}}({key:t,document:r,ops:n,resolve:e,reject:a})})},ae.prototype._fetch_rtdb=function(e){var t=e.key,r=e.ref,n=e.ops,i=e.bindAsArray;return new Promise(function(e,o){i?function(e){var t=e.collection,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target;t.once("value",function(e){var t=e.val();r.once(o,t,e.exists()),n(t)},function(e){e&&i(e)})}({key:t,collection:r,ops:n,resolve:e,reject:o}):function(e){var t=e.document,r=e.ops,n=e.resolve,i=e.reject,o=r.init().target;t.once("value",function(e){var t=e.val();e.exists()||(t={".exists":!1}),r.set(o,t),n(t)},function(e){e&&i(e)})}({key:t,document:r,ops:n,resolve:e,reject:o})})},ae.prototype._unbind_rtdb=function(e){var t=e.key,r=te.get(this);r&&r[t]&&(r[t](),delete r[t])},se.rules.get=function(){var e=this.modelDefinition.schema.fields;Array.isArray(e)||(e=Object.keys(e).map(function(t){return Object.assign({},{model:t},e[t])}));var t={};return e.forEach(function(e){t[e.model]=[{validator:function(t,r,n){e.validate(r)?n():n(new Error("Invalid input"))},trigger:"blur"}]}),t},Object.defineProperties(ae.prototype,se),Object.defineProperties(ae,ce);var ue,le=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t]},de=((oe={})["heliosrx/INIT_VALUE"]=function(e,t){var r=t.path,n=t.data;return le("[HELIOSRX_INIT_VALUE]",{path:r,data:n}),O(e,r,n)},oe["heliosrx/UNSET_VALUE"]=function(e,t){var r=t.path;return le("[HELIOSRX_UNSET_VALUE]",{path:r}),O(e,r,{".value":null})},oe["heliosrx/ARRAY_ADD"]=function(e,t){var r=t.target,n=t.newId,i=t.data;le("[HELIOSRX_ARRAY_ADD]",{target:r,newId:n,data:i}),f.set(r,n,i)},oe["heliosrx/ARRAY_REMOVE"]=function(e,t){var r=t.target,n=t.oldId;le("[HELIOSRX_ARRAY_REMOVE]",{target:r,oldId:n}),f.delete(r,n)},oe["heliosrx/ARRAY_SET"]=function(e,t){var r=t.target,n=t.currentId,i=t.data,o=t.performMerge;void 0===o&&(o=!1),r[n]?A(r[n],i,!o):r[n]=i},oe["heliosrx/SET"]=function(e,t){var r=t.target,n=t.data,i=t.performMerge;void 0===i&&(i=!1),le("[HELIOSRX_SET]",{target:r,data:n,performMerge:i}),A(r,n,!i)},oe),fe={strict:!0,state:{initialized:!1,res:{},sync:{},ready:{}},getters:{get_registry_entry:function(e){return function(t){return e.sync[t]}},is_ready:function(e){return function(t){return e.ready[t]||!1}}},mutations:Object.assign({},de,{INIT_REGISTRY:function(e){e.initialized=!0},RESET_REGISTRY:function(e){f.set(e,"sync",{}),f.set(e,"res",{}),f.set(e,"ready",{}),e.initialized=!1},ADD_ENTRY:function(e,t){var r=t.name,n=t.data;e.sync[r]&&e.sync[r]===n||f.set(e.sync,r,n)},SET_ENTRY_STATUS:function(e,t){var r=t.name,n=t.value;e.sync[r][status]&&e.sync[r][status]===n||f.set(e.sync[r],"status",n)},SET_GLOBAL_READY_STATE:function(e,t){var r=t.name,n=t.value;e.ready[r]&&e.ready[r]===!!n||f.set(e.ready,r,!!n)},REM_GLOBAL_READY_STATE:function(e,t){var r=t.name;f.delete(e.ready,r)}})};function he(e){return fe.name=e,fe.namespaced=!0,fe}var _e={registerStore:function(){},removeStore:function(){},getAllStores:function(){},resetAllStores:function(){}};var me=function(){};return me.install=function(){},me.version="0.2.1",me.install=function e(t,r){if(!e.installed||ue!==t){if(e.installed=!0,console.log("[GENS] Installing Generic API plugin"),!r)throw new Error('heliosRX: Missing configuration. Did you supply config with Vue.use("heliosRx", {...})?');if(!r.db)throw new Error('heliosRX: Missing configuration "db".');if(!r.models)throw new Error('heliosRX: Missing configuration "models".');ue=t,m({Vue:t,models:r.models,db:r.db});var n,i=r.db;if(function(e){var t=e.Vue,r=e.firebase;ie=(W=t).observable(ie),p.configure({GenericModel:$,GenericList:P}),ne=r}({Vue:t,firebase:r.firebase||r.db.app.firebase_}),!i.app||!i.app.database)throw"object"==typeof i?new Error("heliosRX: Multi-DB configuration not implemented yet."):new Error("heliosRX: Invalid configuration for db.");if(ae.setDefaultDB(r.db),r.useExistingStore){var o=r.useExistingStore;throw o.registerModule("heliosrx",he("heliosRX")),m({Vuex:h,registry:o}),new Error("heliosRX: Custom state management not fully implemented.")}(t._installedPlugins||[]).forEach(function(e){e.Store&&e.mapActions&&console.warn("Existing Vuex detected. Consider using 'useExistingStore'. See heliosRX documentation.")}),t.use(h),n=new h.Store(he("heliosRX")),m({Vuex:h,registry:n}),n.commit("INIT_REGISTRY"),Object.defineProperty(t.prototype,"$models",{get:function(){return r.models}});var a={};r.userApi&&(a=r.userApi),Object.defineProperty(t.prototype,"$api",{get:function(){return a}});var s="false"===process.env.VUE_APP_PRODUCTION&&process.browser;(!0===r.devMode||void 0===r.devMode&&s)&&(window.$models=r.models,window.$db=r.db,window.$api=a,window.$registry=n)}},me.getRegistry=function(){return d},me.registryModule=he,me.moment=i,me.GenericStore=ae,me.UIDMethod=s,me.DeleteMode=c,me.setDefaultDB=function(e){ae.setDefaultDB(e)},me.setDefaultUser=function(e){if(null!==ae.defaultUserId)throw new Error("Call resetGenericStores before setting the default user id");ae.defaultUserId=e},me.resetGenericStores=function(e){void 0===e&&(e=!0),ae.resetState();var t=_e.getAllStores(),r=function(r){var n=t[r],i=n.subscriptions;n.reset(),e&&i&&Object.keys(i).forEach(function(e){var t=i[e];console.log("Calling unsubscribe for",r,":",e),t()})};for(var n in t)r(n)},me});